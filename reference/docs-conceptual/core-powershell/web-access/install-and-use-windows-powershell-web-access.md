---
ms.date: 2017-08-23
keywords: powershell,cmdlet
title: "安裝和使用 Windows PowerShell Web 存取"
ms.openlocfilehash: d30bacea8f0edb62e6bb42c118e54010d5401467
ms.sourcegitcommit: 4102ecc35d473211f50a453f6ae3fbea31cb3428
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/31/2017
---
# <a name="install-and-use-windows-powershell-web-access"></a><span data-ttu-id="5dee4-103">安裝和使用 Windows PowerShell Web 存取</span><span class="sxs-lookup"><span data-stu-id="5dee4-103">Install and Use Windows PowerShell Web Access</span></span>

<span data-ttu-id="5dee4-104">更新日期︰2013 年 11 月 5 日 (編輯日期：2017 年 8 月 23 日)</span><span class="sxs-lookup"><span data-stu-id="5dee4-104">Updated: November 5, 2013 (Edited: August 23, 2017)</span></span>

<span data-ttu-id="5dee4-105">適用目標︰Windows Server 2012 R2、Windows Server 2012</span><span class="sxs-lookup"><span data-stu-id="5dee4-105">Applies To: Windows Server 2012 R2, Windows Server 2012</span></span>

## <a name="introduction"></a><span data-ttu-id="5dee4-106">簡介</span><span class="sxs-lookup"><span data-stu-id="5dee4-106">Introduction</span></span>

<span data-ttu-id="5dee4-107">Windows PowerShell Web 存取於 Windows Server 2012 中首度引進，作為 Windows PowerShell 閘道，提供一個以遠端電腦為目標的網頁型 Windows PowerShell 主控台。</span><span class="sxs-lookup"><span data-stu-id="5dee4-107">Windows PowerShell Web Access, first introduced in Windows Server 2012, acts as a Windows PowerShell gateway, providing a web-based Windows PowerShell console that is targeted at a remote computer.</span></span> <span data-ttu-id="5dee4-108">它可讓 IT 專業人員在網頁瀏覽器中，從 Windows PowerShell 主控台執行 Windows PowerShell 命令和指令碼，而不需要 Windows PowerShell、遠端管理軟體，或者在用戶端裝置上安裝瀏覽器外掛程式。</span><span class="sxs-lookup"><span data-stu-id="5dee4-108">It enables IT Pros to run Windows PowerShell commands and scripts from a Windows PowerShell console in a web browser, with no Windows PowerShell, remote management software, or browser plug-in installation necessary on the client device.</span></span> <span data-ttu-id="5dee4-109">執行網頁型 Windows PowerShell 主控台只需要正確設定的 Windows PowerShell Web 存取閘道，以及支援 JavaScriptÂ® 且接受 Cookie 的用戶端裝置瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="5dee4-109">All that is required to run the web-based Windows PowerShell console is a properly-configured Windows PowerShell Web Access gateway, and a client device browser that supports JavaScriptÂ® and accepts cookies.</span></span>

<span data-ttu-id="5dee4-110">用戶端裝置的範例包含膝上型電腦、非工作用個人電腦、租借電腦、平板電腦、網路工作站、執行非 Windows 作業系統的電腦以及行動電話瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="5dee4-110">Examples of client devices include laptops, non-work personal computers, borrowed computers, tablet computers, web kiosks, computers that are not running a Windows-based operating system, and cell phone browsers.</span></span> <span data-ttu-id="5dee4-111">IT 專業人員能夠從可以存取網際網路連線的裝置及網頁瀏覽器，執行遠端 Windows 伺服器的重要管理工作。</span><span class="sxs-lookup"><span data-stu-id="5dee4-111">IT Pros can perform critical management tasks on remote Windows-based servers from devices that have access to an Internet connection and a web browser.</span></span>

<span data-ttu-id="5dee4-112">成功安裝和設定閘道之後，使用者就可以使用網頁瀏覽器來存取 Windows PowerShell 主控台。</span><span class="sxs-lookup"><span data-stu-id="5dee4-112">After successful gateway setup and configuration, users can access a Windows PowerShell console by using a web browser.</span></span> <span data-ttu-id="5dee4-113">當使用者開啟受保護的 Windows PowerShell Web 存取網站時，就可以在成功驗證之後執行網頁型 Windows PowerShell 主控台。</span><span class="sxs-lookup"><span data-stu-id="5dee4-113">When users open the secured Windows PowerShell Web Access website, they can run a web-based Windows PowerShell console after successful authentication.</span></span>

<span data-ttu-id="5dee4-114">安裝和設定 Windows PowerShell Web 存取時需要執行三個步驟：</span><span class="sxs-lookup"><span data-stu-id="5dee4-114">Windows PowerShell Web Access setup and configuration is a three-step process:</span></span>

1. [<span data-ttu-id="5dee4-115">安裝 Windows PowerShell Web 存取</span><span class="sxs-lookup"><span data-stu-id="5dee4-115">install windows powershell web access</span></span>]()
2. [<span data-ttu-id="5dee4-116">設定閘道</span><span class="sxs-lookup"><span data-stu-id="5dee4-116">configure the gateway</span></span>]()
3. [<span data-ttu-id="5dee4-117">設定授權規則</span><span class="sxs-lookup"><span data-stu-id="5dee4-117">configure authorization rules</span></span>]()

<span data-ttu-id="5dee4-118">安裝和設定 Windows PowerShell Web 存取之前，建議您完整閱讀本指南，其中包含如何安裝、保護和解除安裝 Windows PowerShell Web 存取的相關指示。</span><span class="sxs-lookup"><span data-stu-id="5dee4-118">Before you install and configure Windows PowerShell Web Access, we recommend that you read this entire guide, which includes instructions about how to install, secure, and uninstall Windows PowerShell Web Access.</span></span>
<span data-ttu-id="5dee4-119">[使用網頁型 Windows PowerShell 主控台](https://technet.microsoft.com/en-us/library/hh831417(v=ws.11).aspx)主題說明使用者如何登入網頁型主控台，並涵蓋了網頁型 Windows PowerShell 主控台和 **powershell.exe** 主控台之間的限制及差異。</span><span class="sxs-lookup"><span data-stu-id="5dee4-119">The [Use the Web-based Windows PowerShell Console](https://technet.microsoft.com/en-us/library/hh831417(v=ws.11).aspx) topic describes how users sign in to the web-based console, and covers limitations and differences between the web-based Windows PowerShell console and the **powershell.exe** console.</span></span> <span data-ttu-id="5dee4-120">網頁型主控台的終端使用者應該閱讀[使用網頁型 Windows PowerShell 主控台](use-the-web-based-windows-powershell-console.md)，但不需要閱讀本指南的其他章節。</span><span class="sxs-lookup"><span data-stu-id="5dee4-120">End users of the web-based console should read [Use the Web based Windows PowerShell Console](use-the-web-based-windows-powershell-console.md), but do not need to read the rest of this guide.</span></span>

<span data-ttu-id="5dee4-121">本主題不提供深入的 IIS 網頁伺服器操作指導方針；只會說明設定 Windows PowerShell Web 存取閘道所需的步驟。</span><span class="sxs-lookup"><span data-stu-id="5dee4-121">This topic does not provide in-depth IIS Web Server operations guidance; only those steps required to configure the Windows PowerShell Web Access gateway are described in this topic.</span></span> <span data-ttu-id="5dee4-122">如需設定和保護 IIS 網站安全的詳細資訊，請參閱＜另請參閱＞一節中的 IIS 文件資源。</span><span class="sxs-lookup"><span data-stu-id="5dee4-122">For more information about configuring and securing websites in IIS, see the IIS documentation resources in the See Also section.</span></span>

<span data-ttu-id="5dee4-123">下圖顯示 Windows PowerShell Web 存取的運作方式。</span><span class="sxs-lookup"><span data-stu-id="5dee4-123">The following diagram shows how Windows PowerShell Web Access works.</span></span>

![Windows PowerShell Web 存取圖](images/Windows-PowerShell-Web-Access-diagram.jpg)

## <a name="requirements-for-running-windows-powershell-web-access"></a><span data-ttu-id="5dee4-125">執行 Windows PowerShell Web 存取的需求</span><span class="sxs-lookup"><span data-stu-id="5dee4-125">Requirements for running Windows PowerShell Web Access</span></span>

<span data-ttu-id="5dee4-126">Windows PowerShell Web 存取需要網頁伺服器 (IIS)、.NET Framework 4.5，以及 Windows PowerShell 3.0 或 Windows PowerShell 4.0，才能在您要執行閘道的伺服器上執行。</span><span class="sxs-lookup"><span data-stu-id="5dee4-126">Windows PowerShell Web Access requires Web Server (IIS), .NET Framework 4.5, and Windows PowerShell 3.0 or Windows PowerShell 4.0 to be running on the server on which you want to run the gateway.</span></span> <span data-ttu-id="5dee4-127">您可以使用伺服器管理員中的 [新增角色及功能精靈] 或伺服器管理員的 Windows PowerShell 部署 Cmdlet，在執行 Windows Server 2012 R2 或 Windows Server 2012 的伺服器上安裝 Windows PowerShell Web 存取。</span><span class="sxs-lookup"><span data-stu-id="5dee4-127">You can install Windows PowerShell Web Access on a server that is running Windows Server 2012 R2 or Windows Server 2012 by using either the Add Roles and Features Wizard in Server Manager, or Windows PowerShell deployment cmdlets for Server Manager.</span></span> <span data-ttu-id="5dee4-128">使用伺服器管理員或其部署 Cmdlet 安裝 Windows PowerShell Web 存取時，會在安裝處理程序期間自動新增必要的角色和功能。</span><span class="sxs-lookup"><span data-stu-id="5dee4-128">When you install Windows PowerShell Web Access by using Server Manager or its deployment cmdlets, required roles and features are automatically added as part of the installation process.</span></span>

<span data-ttu-id="5dee4-129">Windows PowerShell Web 存取允許遠端使用者，在網頁瀏覽器中使用 Windows PowerShell 來存取組織中的電腦。</span><span class="sxs-lookup"><span data-stu-id="5dee4-129">Windows PowerShell Web Access allows remote users to access computers in your organization by using Windows PowerShell in a web browser.</span></span> <span data-ttu-id="5dee4-130">雖然 Windows PowerShell Web 存取是一個方便且功能強大的管理工具，但網頁型存取有安全性風險，應該儘可能安全地設定。</span><span class="sxs-lookup"><span data-stu-id="5dee4-130">Although Windows PowerShell Web Access is a convenient and powerful management tool, the web-based access poses security risks, and should be configured as securely as possible.</span></span> <span data-ttu-id="5dee4-131">建議設定 Windows PowerShell Web 存取閘道的系統管理員使用可用的安全性階層，包含 Windows PowerShell Web 存取隨附之以 Cmdlet為基礎的授權規則，以及網頁伺服器 (IIS) 與協力廠商應用程式中可用的安全性階層。</span><span class="sxs-lookup"><span data-stu-id="5dee4-131">We recommend that administrators who configure the Windows PowerShell Web Access gateway use available security layers, both the cmdlet-based authorization rules included with Windows PowerShell Web Access, and security layers that are available in Web Server (IIS) and third-party applications.</span></span> <span data-ttu-id="5dee4-132">這份文件含有只建議用於測試環境的不安全範例，以及建議用於安全部署的範例。</span><span class="sxs-lookup"><span data-stu-id="5dee4-132">This documentation includes both unsecure examples that are only recommended for test environments, as well as examples that are recommended for secure deployments.</span></span>

## <a name="browser-and-client-device-support"></a><span data-ttu-id="5dee4-133">瀏覽器及用戶端裝置支援</span><span class="sxs-lookup"><span data-stu-id="5dee4-133">Browser and client device support</span></span>

<span data-ttu-id="5dee4-134">Windows PowerShell Web 存取支援下列網際網路瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="5dee4-134">Windows PowerShell Web Access supports the following Internet browsers.</span></span>
<span data-ttu-id="5dee4-135">雖然並未正式支援行動瀏覽器，但很多行動瀏覽器應該都可以執行網頁型 Windows PowerShell 主控台。</span><span class="sxs-lookup"><span data-stu-id="5dee4-135">Although mobile browsers are not officially supported, many may be able to run the web-based Windows PowerShell console.</span></span> <span data-ttu-id="5dee4-136">其他接受 Cookie、執行 JavaScript 以及執行 HTTPS 網站的瀏覽器預期也可以運作，但尚未經過正式測試。</span><span class="sxs-lookup"><span data-stu-id="5dee4-136">Other browsers that accept cookies, run JavaScript, and run HTTPS websites are expected to work, but are not officially tested.</span></span>

### <a name="supported-desktop-computer-browsers"></a><span data-ttu-id="5dee4-137">支援的桌上型電腦瀏覽器</span><span class="sxs-lookup"><span data-stu-id="5dee4-137">Supported desktop computer browsers</span></span>

- <span data-ttu-id="5dee4-138">適用於 Microsoft Windows 8.0、9.0、10.0 和 11.0 的 Windows Internet Explorer</span><span class="sxs-lookup"><span data-stu-id="5dee4-138">Windows Internet Explorer for Microsoft Windows 8.0, 9.0, 10.0, and 11.0</span></span>
- <span data-ttu-id="5dee4-139">Mozilla Firefox 10.0.2</span><span class="sxs-lookup"><span data-stu-id="5dee4-139">Mozilla Firefox 10.0.2</span></span>
- <span data-ttu-id="5dee4-140">適用於 Windows 的 Google Chromeâ 17.0.963.56m</span><span class="sxs-lookup"><span data-stu-id="5dee4-140">Google Chromeâ 17.0.963.56m for Windows</span></span>
- <span data-ttu-id="5dee4-141">適用於 Windows 的 Apple Safari 5.1.2</span><span class="sxs-lookup"><span data-stu-id="5dee4-141">Apple Safari 5.1.2 for Windows</span></span>
- <span data-ttu-id="5dee4-142">適用於 Mac OS 的 Apple Safari 5.1.2</span><span class="sxs-lookup"><span data-stu-id="5dee4-142">Apple Safari 5.1.2 for Mac OS</span></span>

### <a name="minimally-tested-mobile-devices-or-browsers"></a><span data-ttu-id="5dee4-143">通過基本測試的行動裝置或瀏覽器</span><span class="sxs-lookup"><span data-stu-id="5dee4-143">Minimally-tested mobile devices or browsers</span></span>

- <span data-ttu-id="5dee4-144">WindowsÂ Phone 7 和 7.5</span><span class="sxs-lookup"><span data-stu-id="5dee4-144">WindowsÂ Phone 7 and 7.5</span></span>
- <span data-ttu-id="5dee4-145">Google Android WebKit 3.1 BrowserÂ Android 2.2.1 (Kernel 2.6)</span><span class="sxs-lookup"><span data-stu-id="5dee4-145">Google Android WebKit 3.1 BrowserÂ Android 2.2.1 (Kernel 2.6)</span></span>
- <span data-ttu-id="5dee4-146">適用於 iPhone 作業系統 5.0.1 的 Apple Safari</span><span class="sxs-lookup"><span data-stu-id="5dee4-146">Apple Safari for iPhone operating system 5.0.1</span></span>
- <span data-ttu-id="5dee4-147">適用於 iPad 2Â 作業系統 5.0.1 的 Apple Safari</span><span class="sxs-lookup"><span data-stu-id="5dee4-147">Apple Safari for iPad 2Â operating system 5.0.1</span></span>

### <a name="browser-requirements"></a><span data-ttu-id="5dee4-148">瀏覽器需求</span><span class="sxs-lookup"><span data-stu-id="5dee4-148">Browser requirements</span></span>

<span data-ttu-id="5dee4-149">若要使用 Windows PowerShell Web 存取網頁型主控台，瀏覽器必須執行下列作業。</span><span class="sxs-lookup"><span data-stu-id="5dee4-149">To use the Windows PowerShell Web Access web-based console, browsers must do the following.</span></span>

- <span data-ttu-id="5dee4-150">允許來自 Windows PowerShell Web 存取閘道網站的 Cookie。</span><span class="sxs-lookup"><span data-stu-id="5dee4-150">Allow cookies from the Windows PowerShell Web Access gateway website.</span></span>
- <span data-ttu-id="5dee4-151">可以開啟和讀取 HTTPS 頁面。</span><span class="sxs-lookup"><span data-stu-id="5dee4-151">Be able to open and read HTTPS pages.</span></span>
- <span data-ttu-id="5dee4-152">開啟和執行使用 JavaScript 的網站。</span><span class="sxs-lookup"><span data-stu-id="5dee4-152">Open and run websites that use JavaScript.</span></span>

## <a name="recommended-quick-deployment"></a><span data-ttu-id="5dee4-153">建議的快速部署</span><span class="sxs-lookup"><span data-stu-id="5dee4-153">Recommended quick deployment</span></span>

<span data-ttu-id="5dee4-154">您可以使用 Windows PowerShell 部署 Cmdlet 或從伺服器管理員中開啟的 [新增角色及功能精靈]，在執行 Windows Server 2012 R2 或 Windows Server 2012 的伺服器上安裝 Windows PowerShell Web 存取閘道。</span><span class="sxs-lookup"><span data-stu-id="5dee4-154">You can install the Windows PowerShell Web Access gateway on a server that is running Windows Server 2012 R2 or Windows Server 2012 by using either Windows PowerShell cmdlets, or by using the Add Roles and Features Wizard that is opened from within Server Manager.</span></span> <span data-ttu-id="5dee4-155">若要快速安裝和設定，請使用 Windows PowerShell Cmdlet，如本節所述。</span><span class="sxs-lookup"><span data-stu-id="5dee4-155">For quick installation and configuration, use Windows PowerShell cmdlets, as described in this section.</span></span>

1. [<span data-ttu-id="5dee4-156">安裝 Windows PowerShell Web 存取</span><span class="sxs-lookup"><span data-stu-id="5dee4-156">Install Windows PowerShell Web Access</span></span>](#install-Windows-powershell-web-access)
1. [<span data-ttu-id="5dee4-157">設定閘道</span><span class="sxs-lookup"><span data-stu-id="5dee4-157">Configure the Gateway</span></span>](#configure-the-gateway)
1. [<span data-ttu-id="5dee4-158">設定限制性授權規則</span><span class="sxs-lookup"><span data-stu-id="5dee4-158">Configure a restrictive authorization rule</span></span>](#configure-a-restrictive-authorization-rule)

### <a name="install-windows-powershell-web-access"></a><span data-ttu-id="5dee4-159">安裝 Windows PowerShell Web 存取</span><span class="sxs-lookup"><span data-stu-id="5dee4-159">Install Windows PowerShell Web Access</span></span>

#### <a name="to-install-windows-powershell-web-access-by-using-windows-powershell-cmdlets"></a><span data-ttu-id="5dee4-160">使用 Windows PowerShell Cmdlet 安裝 Windows PowerShell Web 存取</span><span class="sxs-lookup"><span data-stu-id="5dee4-160">To install Windows PowerShell Web Access by using Windows PowerShell cmdlets</span></span>

1. <span data-ttu-id="5dee4-161">執行下列其中一個動作，使用提高的使用者權限開啟 Windows PowerShell 工作階段。</span><span class="sxs-lookup"><span data-stu-id="5dee4-161">Do one of the following to open a Windows PowerShell session with elevated user rights.</span></span>
    - <span data-ttu-id="5dee4-162">在 Windows 桌面上，以滑鼠右鍵按一下工作列上的 **[Windows PowerShell]**，然後按一下 **[以系統管理員身分執行]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-162">On the Windows desktop, right-click **Windows PowerShell** on the taskbar, and then click **Run as Administrator**.</span></span>
    - <span data-ttu-id="5dee4-163">在 Windows **[開始]** 畫面上，以滑鼠右鍵按一下 **[Windows PowerShell]**，然後按一下 **[以系統管理員身分執行]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-163">On the Windows **Start** screen, right-click **Windows PowerShell**, and then click **Run as Administrator**.</span></span>

    ><span data-ttu-id="5dee4-164">**![注意](images/note.jpeg) 注意**：在 Windows PowerShell 3.0 和 4.0 中，執行屬於模組的 Cmdlet 之前，不需要將伺服器管理員 Cmdlet 模組匯入 Windows PowerShell 工作階段。</span><span class="sxs-lookup"><span data-stu-id="5dee4-164">**![Note](images/note.jpeg) Note** In Windows PowerShell 3.0 and 4.0, there is no need to import the Server Manager cmdlet module into the Windows PowerShell session before running cmdlets that are part of the module.</span></span> <span data-ttu-id="5dee4-165">當您首次執行屬於模組的 Cmdlet 時，會自動匯入模組。</span><span class="sxs-lookup"><span data-stu-id="5dee4-165">A module is automatically imported the first time you run a cmdlet that is part of the module.</span></span> <span data-ttu-id="5dee4-166">此外，Windows PowerShell Cmdlet 不會區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="5dee4-166">Also, Windows PowerShell cmdlets are not case-sensitive.</span></span>

1. <span data-ttu-id="5dee4-167">輸入下列內容，然後按 **Enter**，其中 *computer_name* 代表要安裝 Windows PowerShell Web 存取的遠端電腦 (如果適用)。</span><span class="sxs-lookup"><span data-stu-id="5dee4-167">Type the following, and then press **Enter**, where *computer_name* represents a remote computer on which you want to install Windows PowerShell Web Access, if applicable.</span></span> <span data-ttu-id="5dee4-168">如有需要，`-Restart` 參數會自動重新啟動目的地伺服器。</span><span class="sxs-lookup"><span data-stu-id="5dee4-168">The `-Restart` parameter automatically restarts destination servers if required.</span></span>

   `Install-WindowsFeature -Name WindowsPowerShellWebAccess -ComputerName <computer_name> -IncludeManagementTools -Restart`

   ><span data-ttu-id="5dee4-169">**![注意](images/note.jpeg) 注意**</span><span class="sxs-lookup"><span data-stu-id="5dee4-169">**![Note](images/note.jpeg) Note**</span></span>
   >
   ><span data-ttu-id="5dee4-170">使用 Windows PowerShell Cmdlet 安裝 Windows PowerShell Web 存取，預設不會新增網頁伺服器 (IIS) 管理工具。</span><span class="sxs-lookup"><span data-stu-id="5dee4-170">Installing Windows PowerShell Web Access by using Windows PowerShell cmdlets does not add Web Server (IIS) management tools by default.</span></span> <span data-ttu-id="5dee4-171">如果您想要在與 Windows PowerShell Web 存取閘道相同的伺服器上安裝管理工具，可將 `-IncludeManagementTools` 參數新增至安裝命令 (如本步驟所提供)。</span><span class="sxs-lookup"><span data-stu-id="5dee4-171">If you want to install the management tools on the same server as the Windows PowerShell Web Access gateway, add the `-IncludeManagementTools` parameter to the installation command (as provided in this step).</span></span> <span data-ttu-id="5dee4-172">如果您從遠端電腦管理 Windows PowerShell Web 存取網站，在您要用來管理閘道的電腦上，透過安裝 [Windows 8.1 的遠端伺服器管理工具](http://go.microsoft.com/fwlink/?LinkID=304145)或 [Windows 8 的遠端伺服器管理工具](http://go.microsoft.com/fwlink/p/?LinkID=238560)來安裝 [IIS 管理員] 嵌入式管理單元。</span><span class="sxs-lookup"><span data-stu-id="5dee4-172">If you are managing the Windows PowerShell Web Access website from a remote computer, install the IIS Manager snap-in by installing [Remote Server Administration Toolsfor Windows 8.1](http://go.microsoft.com/fwlink/?LinkID=304145) or [Remote Server Administration Tools for Windows 8](http://go.microsoft.com/fwlink/p/?LinkID=238560) on the computer from which you want to manage the gateway.</span></span>
   
   <span data-ttu-id="5dee4-173">若要在離線 VHD 安裝角色及功能，您必須新增 `-ComputerName` 參數及 `-VHD` 參數。</span><span class="sxs-lookup"><span data-stu-id="5dee4-173">To install roles and features on an offline VHD, you must add both the `-ComputerName` parameter and the `-VHD` parameter.</span></span> <span data-ttu-id="5dee4-174">`-ComputerName` 參數包含要掛接 VHD 的伺服器名稱，`-VHD` 參數則包含指定伺服器上的 VHD 檔案路徑。</span><span class="sxs-lookup"><span data-stu-id="5dee4-174">The `-ComputerName` parameter contains the name of the server on which to mount the VHD, and the `-VHD` parameter contains the path to the VHD file on the specified server.</span></span>

   `Install-WindowsFeature -Name WindowsPowerShellWebAccess -VHD <path> -ComputerName <computer_name> -IncludeManagementTools -Restart`

1. <span data-ttu-id="5dee4-175">完成安裝後，在使用提高的使用者權限開啟的 Windows PowerShell 主控台中，藉由在目的地伺服器上執行 **Get-WindowsFeature** Cmdlet，來確認 Windows PowerShell Web 存取已安裝於目的地伺服器上。</span><span class="sxs-lookup"><span data-stu-id="5dee4-175">When installation is complete, verify that Windows PowerShell Web Access was installed on destination servers by running the **Get-WindowsFeature** cmdlet on a destination server, in a Windows PowerShell console that has been opened with elevated user rights.</span></span> <span data-ttu-id="5dee4-176">您也可以在 [所有伺服器] 頁面上選取目的地伺服器，然後檢視所選伺服器的 [角色和功能] 磚，藉以確認 Windows PowerShell Web 存取已安裝於伺服器管理員主控台中。</span><span class="sxs-lookup"><span data-stu-id="5dee4-176">You can also verify that Windows PowerShell Web Access was installed in the Server Manager console, by selecting a destination server on the **All Servers** page, and then viewing the **Roles and Features** tile for the selected server.</span></span> <span data-ttu-id="5dee4-177">您也可以檢視 Windows PowerShell Web 存取的讀我檔案。</span><span class="sxs-lookup"><span data-stu-id="5dee4-177">You can also view the readme file for Windows PowerShell Web Access.</span></span>

1. <span data-ttu-id="5dee4-178">安裝 Windows PowerShell Web 存取之後，系統會提示您檢閱讀我檔案，其中包含適用於閘道的必要且基本的安裝指示。</span><span class="sxs-lookup"><span data-stu-id="5dee4-178">After Windows PowerShell Web Access is installed, you are prompted to review the readme file, which contains basic, required setup instructions for the gateway.</span></span> <span data-ttu-id="5dee4-179">下一節[設定閘道](#configure-the-gateway)中也會有這些安裝指示。</span><span class="sxs-lookup"><span data-stu-id="5dee4-179">These setup instructions are also in the following section, [Configure the Gateway](#configure-the-gateway).</span></span> <span data-ttu-id="5dee4-180">讀我檔案的路徑是 **C:\\Windows\\Web\\PowerShellWebAccess\\wwwroot\\README.txt**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-180">The path to the readme file is **C:\\Windows\\Web\\PowerShellWebAccess\\wwwroot\\README.txt**.</span></span>

### <a name="configure-the-gateway"></a><span data-ttu-id="5dee4-181">設定閘道</span><span class="sxs-lookup"><span data-stu-id="5dee4-181">Configure the Gateway</span></span>

<span data-ttu-id="5dee4-182">**Install-PswaWebApplication** Cmdlet 是快速設定 Windows PowerShell Web 存取的方法。</span><span class="sxs-lookup"><span data-stu-id="5dee4-182">The **Install-PswaWebApplication** cmdlet is a quick way to get Windows PowerShell Web Access configured.</span></span> <span data-ttu-id="5dee4-183">雖然您可以新增 `UseTestCertificate` 參數到 `Install-PswaWebApplication` Cmdlet 來安裝自我簽署的 SSL 憑證進行測試，但這並不安全；若要安全的生產環境，一定要使用由憑證授權單位 (CA) 簽署的有效 SSL 憑證。</span><span class="sxs-lookup"><span data-stu-id="5dee4-183">Although you can add the `UseTestCertificate` parameter to the `Install-PswaWebApplication` cmdlet to install a self-signed SSL certificate for test purposes, this is not secure; for a secure production environment, always use a valid SSL certificate that has been signed by a certification authority (CA).</span></span>
<span data-ttu-id="5dee4-184">系統管理員可以使用 IIS 管理員主控台以選擇的簽署憑證來取代測試憑證。</span><span class="sxs-lookup"><span data-stu-id="5dee4-184">Administrators can replace the test certificate with a signed certificate of their choice by using the IIS Manager console.</span></span>

<span data-ttu-id="5dee4-185">您可以執行 `Install-PswaWebApplication` Cmdlet 或在 IIS 管理員中執行 GUI 設定步驟，來完成 Windows PowerShell Web 存取 Web 應用程式設定。</span><span class="sxs-lookup"><span data-stu-id="5dee4-185">You can complete Windows PowerShell Web Access web application configuration either by running the `Install-PswaWebApplication` cmdlet or by performing GUI-based configuration steps in IIS Manager.</span></span> <span data-ttu-id="5dee4-186">根據預設，Cmdlet 會在 [IIS 管理員] 上顯示的 [預設的網站] 容器中，安裝 Web 應用程式 **pswa** (以及應用程式集區 **pswa_pool**)；如有需要，可以指示 Cmdlet 變更 Web 應用程式的預設網站容器。</span><span class="sxs-lookup"><span data-stu-id="5dee4-186">By default, the cmdlet installs the web application, **pswa** (and an application pool for it, **pswa_pool**), in the **Default Web Site** container, as shown in IIS Manager; if desired, you can instruct the cmdlet to change the default site container of the web application.</span></span> <span data-ttu-id="5dee4-187">IIS 管理員提供 Web 應用程式可用的設定選項，例如變更連接埠號碼或安全通訊端層 (SSL) 憑證。</span><span class="sxs-lookup"><span data-stu-id="5dee4-187">IIS Manager offers configuration options that are available for web applications, such as changing the port number or the Secure Sockets Layer (SSL) certificate.</span></span>

><span data-ttu-id="5dee4-188">**![安全性提示](images/securitynote.jpeg) 安全性提示**</span><span class="sxs-lookup"><span data-stu-id="5dee4-188">**![Security Note](images/securitynote.jpeg) Security Note**</span></span>
> 
><span data-ttu-id="5dee4-189">強烈建議系統管理員將閘道設定為使用 CA 簽署的有效憑證。</span><span class="sxs-lookup"><span data-stu-id="5dee4-189">We strongly recommend that administrators configure the gateway to use a valid certificate that has been signed by a CA.</span></span> 

#### <a name="to-configure-the-windows-powershell-web-access-gateway-with-a-test-certificate-by-using-install-pswawebapplication"></a><span data-ttu-id="5dee4-190">使用 Install-PswaWebApplication 以測試憑證設定 Windows PowerShell Web 存取閘道</span><span class="sxs-lookup"><span data-stu-id="5dee4-190">To configure the Windows PowerShell Web Access gateway with a test certificate by using Install-PswaWebApplication</span></span>

1. <span data-ttu-id="5dee4-191">執行下列其中一個動作來開啟 Windows PowerShell 工作階段。</span><span class="sxs-lookup"><span data-stu-id="5dee4-191">Do one of the following to open a Windows PowerShell session.</span></span>

    - <span data-ttu-id="5dee4-192">在 Windows 桌面上，以滑鼠右鍵按一下工作列上的 [Windows PowerShell]。</span><span class="sxs-lookup"><span data-stu-id="5dee4-192">On the Windows desktop, right-click **Windows PowerShell** on the taskbar.</span></span>

    - <span data-ttu-id="5dee4-193">在 Windows **[開始]** 畫面上，按一下 **[Windows PowerShell]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-193">On the Windows **Start** screen, click **Windows PowerShell**.</span></span>

2.  <span data-ttu-id="5dee4-194">輸入下列程式碼，然後按 **Enter**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-194">Type the following, and then press **Enter**.</span></span>

    <span data-ttu-id="5dee4-195">**Install-PswaWebApplication -UseTestCertificate**</span><span class="sxs-lookup"><span data-stu-id="5dee4-195">**Install-PswaWebApplication -UseTestCertificate**</span></span>

  ><span data-ttu-id="5dee4-196">**![安全性提示](images/securitynote.jpeg) 安全性提示**</span><span class="sxs-lookup"><span data-stu-id="5dee4-196">**![Security Note](images/securitynote.jpeg) Security Note**</span></span>
  >
  ><span data-ttu-id="5dee4-197">
            `UseTestCertificate` 參數只能用在私人測試環境中。</span><span class="sxs-lookup"><span data-stu-id="5dee4-197">The `UseTestCertificate` parameter should only be used in a private test environment.</span></span> <span data-ttu-id="5dee4-198">若要安全的生產環境，建議使用 CA 簽署的有效憑證。</span><span class="sxs-lookup"><span data-stu-id="5dee4-198">For a secure production environment, we recommend using a valid certificate that has been signed by a CA.</span></span>

<span data-ttu-id="5dee4-199">執行這個 Cmdlet 會在 IIS [預設的網站] 容器中安裝 Windows PowerShell Web 存取 Web 應用程式。</span><span class="sxs-lookup"><span data-stu-id="5dee4-199">Running the cmdlet installs the Windows PowerShell Web Access web application within the IIS Default Web Site container.</span></span> <span data-ttu-id="5dee4-200">這個 Cmdlet 會建立在預設網站 `https://<server_name>/pswa` 上執行 Windows PowerShell Web 存取所需的基礎結構。</span><span class="sxs-lookup"><span data-stu-id="5dee4-200">The cmdlet creates the infrastructure required to run Windows PowerShell Web Access on the default website, `https://<server_name>/pswa`.</span></span> <span data-ttu-id="5dee4-201">若要在不同網站安裝 Web 應用程式，請新增 `WebSiteName` 參數以提供網站名稱。</span><span class="sxs-lookup"><span data-stu-id="5dee4-201">To install the web application in a different website, provide the website name by adding the `WebSiteName` parameter.</span></span> <span data-ttu-id="5dee4-202">若要變更 Web 應用程式的名稱 (預設是 `pswa`)，請新增 `WebApplicationName` 參數。</span><span class="sxs-lookup"><span data-stu-id="5dee4-202">To change the name of the web application (the default is `pswa`), add the `WebApplicationName` parameter.</span></span>

<span data-ttu-id="5dee4-203">執行 Cmdlet 可以設定下列設定。</span><span class="sxs-lookup"><span data-stu-id="5dee4-203">The following settings are configured by running the cmdlet.</span></span> <span data-ttu-id="5dee4-204">如有需要，可以在 IIS 管理員主控台手動變更這些設定。</span><span class="sxs-lookup"><span data-stu-id="5dee4-204">You can change these manually in the IIS Manager console, if desired.</span></span>

- <span data-ttu-id="5dee4-205">Path：/pswa</span><span class="sxs-lookup"><span data-stu-id="5dee4-205">Path: /pswa</span></span>
- <span data-ttu-id="5dee4-206">ApplicationPool：pswa_pool</span><span class="sxs-lookup"><span data-stu-id="5dee4-206">ApplicationPool: pswa_pool</span></span>
- <span data-ttu-id="5dee4-207">EnabledProtocols：http</span><span class="sxs-lookup"><span data-stu-id="5dee4-207">EnabledProtocols: http</span></span>
- <span data-ttu-id="5dee4-208">PhysicalPath：%*windir*%/Web/PowerShellWebAccess/wwwroot</span><span class="sxs-lookup"><span data-stu-id="5dee4-208">PhysicalPath: %*windir*%/Web/PowerShellWebAccess/wwwroot</span></span>

<span data-ttu-id="5dee4-209">**範例**：`Install-PswaWebApplication -webApplicationName myWebApp -useTestCertificate`</span><span class="sxs-lookup"><span data-stu-id="5dee4-209">**Example**: `Install-PswaWebApplication -webApplicationName myWebApp -useTestCertificate`</span></span>

<span data-ttu-id="5dee4-210">在這個範例中，針對 Windows PowerShell Web 存取產生的網站是 https://\<伺服器名稱\>/myWebApp。</span><span class="sxs-lookup"><span data-stu-id="5dee4-210">In this example, the resulting website for Windows PowerShell Web Access is https://\<*server_name*\>/myWebApp.</span></span>

><span data-ttu-id="5dee4-211">**![注意](images/note.jpeg) 注意**</span><span class="sxs-lookup"><span data-stu-id="5dee4-211">**![Note](images/note.jpeg) Note**</span></span> 
> 
><span data-ttu-id="5dee4-212">必須透過新增授權規則，讓使用者獲得網站存取權，才能進行登入。</span><span class="sxs-lookup"><span data-stu-id="5dee4-212">You cannot sign in until users have been granted access to the website by adding authorization rules.</span></span> <span data-ttu-id="5dee4-213">如需詳細資訊，請參閱[設定限制性授權規則](#configure-a-restrictive-authorization-rule)和 [Windows PowerShell Web 存取的授權規則與安全性功能](authorization-rules-and-security-features-of-windows-powershell-web-access.md)。</span><span class="sxs-lookup"><span data-stu-id="5dee4-213">For more information, see [configure a restrictive authorization rule](#configure-a-restrictive-authorization-rule) and [Authorization Rules and Security Features of Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md).</span></span>

#### <a name="to-configure-the-windows-powershell-web-access-gateway-with-a-genuine-certificate-by-using-install-pswawebapplication-and-iis-manager"></a><span data-ttu-id="5dee4-214">使用 Install-PswaWebApplication 和 IIS 管理員以正版憑證設定 Windows PowerShell Web 存取閘道</span><span class="sxs-lookup"><span data-stu-id="5dee4-214">To configure the Windows PowerShell Web Access gateway with a genuine certificate by using Install-PswaWebApplication and IIS Manager</span></span>

1. <span data-ttu-id="5dee4-215">執行下列其中一個動作來開啟 Windows PowerShell 工作階段。</span><span class="sxs-lookup"><span data-stu-id="5dee4-215">Do one of the following to open a Windows PowerShell session.</span></span>

    - <span data-ttu-id="5dee4-216">在 Windows 桌面上，以滑鼠右鍵按一下工作列上的 [Windows PowerShell]。</span><span class="sxs-lookup"><span data-stu-id="5dee4-216">On the Windows desktop, right-click **Windows PowerShell** on the taskbar.</span></span>

    - <span data-ttu-id="5dee4-217">在 Windows **[開始]** 畫面上，按一下 **[Windows PowerShell]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-217">On the Windows **Start** screen, click **Windows PowerShell**.</span></span>

2. <span data-ttu-id="5dee4-218">輸入下列程式碼，然後按 **Enter**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-218">Type the following, and then press **Enter**.</span></span>

    <span data-ttu-id="5dee4-219">**Install-PswaWebApplication**</span><span class="sxs-lookup"><span data-stu-id="5dee4-219">**Install-PswaWebApplication**</span></span>

    <span data-ttu-id="5dee4-220">執行 Cmdlet 可以設定下列閘道設定。</span><span class="sxs-lookup"><span data-stu-id="5dee4-220">The following gateway settings are configured by running the cmdlet.</span></span>
    <span data-ttu-id="5dee4-221">如有需要，可以在 IIS 管理員主控台手動變更這些設定。</span><span class="sxs-lookup"><span data-stu-id="5dee4-221">You can change these manually in the IIS Manager console, if desired.</span></span>
    <span data-ttu-id="5dee4-222">您也可以指定 `WebsiteName` Cmdlet 的 `WebApplicationName` 及 `Install-PswaWebApplication` 參數值。</span><span class="sxs-lookup"><span data-stu-id="5dee4-222">You can also specify values for the `WebsiteName` and `WebApplicationName` parameters of the `Install-PswaWebApplication` cmdlet.</span></span>

    - <span data-ttu-id="5dee4-223">Path：/pswa</span><span class="sxs-lookup"><span data-stu-id="5dee4-223">Path: /pswa</span></span>

    - <span data-ttu-id="5dee4-224">ApplicationPool：pswa_pool</span><span class="sxs-lookup"><span data-stu-id="5dee4-224">ApplicationPool: pswa_pool</span></span>

    - <span data-ttu-id="5dee4-225">EnabledProtocols：http</span><span class="sxs-lookup"><span data-stu-id="5dee4-225">EnabledProtocols: http</span></span>

    - <span data-ttu-id="5dee4-226">PhysicalPath：%*windir*%/Web/PowerShellWebAccess/wwwroot</span><span class="sxs-lookup"><span data-stu-id="5dee4-226">PhysicalPath: %*windir*%/Web/PowerShellWebAccess/wwwroot</span></span>

3. <span data-ttu-id="5dee4-227">執行下列其中一項動作以開啟 IIS 管理員主控台。</span><span class="sxs-lookup"><span data-stu-id="5dee4-227">Open the IIS Manager console by doing one of the following.</span></span>

    - <span data-ttu-id="5dee4-228">在 Windows 桌面上，按一下 Windows 工作列中的 [伺服器管理員] 來啟動 [伺服器管理員]。</span><span class="sxs-lookup"><span data-stu-id="5dee4-228">On the Windows desktop, start Server Manager by clicking **Server Manager** in the Windows taskbar.</span></span> <span data-ttu-id="5dee4-229">在 [伺服器管理員] 的 **[工具]** 功能表上，按一下 **[Internet Information Services (IIS) 管理員]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-229">On the **Tools** menu in Server Manager, click **Internet Information Services (IIS) Manager**.</span></span>

    - <span data-ttu-id="5dee4-230">在 Windows **[開始]** 畫面上，按一下 **[伺服器管理員]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-230">On the Windows **Start** screen, click **Server Manager**.</span></span>

4. <span data-ttu-id="5dee4-231">在 [IIS 管理員] 樹狀目錄窗格中，展開安裝 Windows PowerShell Web 存取的伺服器節點，直到可以看到 [站台] 資料夾為止。</span><span class="sxs-lookup"><span data-stu-id="5dee4-231">In the IIS Manager tree pane, expand the node for the server on which Windows PowerShell Web Access is installed until the **Sites** folder is visible.</span></span> <span data-ttu-id="5dee4-232">展開 [站台] 資料夾。</span><span class="sxs-lookup"><span data-stu-id="5dee4-232">Expand the **Sites** folder.</span></span>

5. <span data-ttu-id="5dee4-233">選取您已安裝 Windows PowerShell Web 存取 Web 應用程式的網站。</span><span class="sxs-lookup"><span data-stu-id="5dee4-233">Select the website in which you have installed the Windows PowerShell Web Access web application.</span></span> <span data-ttu-id="5dee4-234">在 **[動作]** 窗格中，按一下 **[繫結]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-234">In the **Actions** pane, click **Bindings**.</span></span>

6.  <span data-ttu-id="5dee4-235">在 **[站台繫結]** 對話方塊中，按一下 **[新增]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-235">In the **Site Binding** dialog box, click **Add**.</span></span>

7.  <span data-ttu-id="5dee4-236">在 **[新增站台繫結]** 對話方塊的 **[類型]** 欄位中選取 **[https]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-236">In the **Add Site Binding** dialog box, in the **Type** field, select **https**.</span></span>

8. <span data-ttu-id="5dee4-237">在 [SSL 憑證] 欄位中，從下拉式功能表中選取您已簽署的憑證。</span><span class="sxs-lookup"><span data-stu-id="5dee4-237">In the **SSL certificate** field, select your signed certificate from the drop-down menu.</span></span> <span data-ttu-id="5dee4-238">按一下 **[確定]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-238">Click **OK**.</span></span> <span data-ttu-id="5dee4-239">如需如何取得憑證的詳細資訊，請參閱本主題中的[在 IIS 管理員設定 SSL 憑證](#to-configure-an-ssl-certificate-in-iis-Manager)。</span><span class="sxs-lookup"><span data-stu-id="5dee4-239">See [To configure an SSL certificate in IIS Manager](#to-configure-an-ssl-certificate-in-iis-Manager) in this topic for more information about how to obtain a certificate.</span></span>

    <span data-ttu-id="5dee4-240">現在 Windows PowerShell Web 存取 Web 應用程式已設定為使用您已簽署的 SSL 憑證。</span><span class="sxs-lookup"><span data-stu-id="5dee4-240">The Windows PowerShell Web Access web application is now configured to  use your signed SSL certificate.</span></span>

    <span data-ttu-id="5dee4-241">您可以在瀏覽器視窗中開啟 **https://\<伺服器名稱\>/pswa**，來存取 Windows PowerShell Web 存取。</span><span class="sxs-lookup"><span data-stu-id="5dee4-241">You can access Windows PowerShell Web Access by opening  **https://\<server_name\>/pswa** in a browser window.</span></span>

><span data-ttu-id="5dee4-242">**![注意](images/note.jpeg) 注意**</span><span class="sxs-lookup"><span data-stu-id="5dee4-242">**![Note](images/note.jpeg) Note**</span></span> 
> 
><span data-ttu-id="5dee4-243">必須透過新增授權規則，讓使用者獲得網站存取權，才能進行登入。</span><span class="sxs-lookup"><span data-stu-id="5dee4-243">You cannot sign in until users have been granted access to the website by adding authorization rules.</span></span> 
><span data-ttu-id="5dee4-244">如需詳細資訊，請參閱本主題中的[設定限制性授權規則](#configure-a-restrictive-authorization-rule)，以及 [Windows PowerShell Web 存取的授權規則與安全性功能](authorization-rules-and-security-features-of-windows-powershell-web-access.md)。</span><span class="sxs-lookup"><span data-stu-id="5dee4-244">For more information, see [Configure a restrictive authorization rule](#configure-a-restrictive-authorization-rule), in this topic, and [Authorization Rules and Security Features of Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md).</span></span>

### <a name="configure-a-restrictive-authorization-rule"></a><span data-ttu-id="5dee4-245">設定限制性授權規則</span><span class="sxs-lookup"><span data-stu-id="5dee4-245">Configure a restrictive authorization rule</span></span>

<span data-ttu-id="5dee4-246">安裝 Windows PowerShell Web 存取並設定閘道之後，使用者就可以在瀏覽器中開啟登入頁面，但是必須等到 Windows PowerShell Web 存取系統管理員明確授與使用者存取權之後，才能登入。</span><span class="sxs-lookup"><span data-stu-id="5dee4-246">After Windows PowerShell Web Access is installed and the gateway is configured, users can open the sign-in page in a browser, but they cannot sign in until the Windows PowerShell Web Access administrator grants users access explicitly.</span></span> <span data-ttu-id="5dee4-247">您可以使用下表所述的 Windows PowerShell Cmdlet，來管理 Windows PowerShell Web 存取存取控制。</span><span class="sxs-lookup"><span data-stu-id="5dee4-247">Windows PowerShell Web Access access control is managed by using the set of Windows PowerShell cmdlets described in the following table.</span></span> <span data-ttu-id="5dee4-248">沒有適用於新增或管理授權規則的 GUI。</span><span class="sxs-lookup"><span data-stu-id="5dee4-248">There is no comparable GUI for adding or managing authorization rules.</span></span> <span data-ttu-id="5dee4-249">如需 Windows PowerShell Web 存取 Cmdlet 的詳細資訊，請參閱 Cmdlet 參考主題：[Windows PowerShell Web Access Cmdlets](cmdlets/web-access-cmdlets.md) (Windows PowerShell Web 存取 Cmdlet)。</span><span class="sxs-lookup"><span data-stu-id="5dee4-249">For more detailed information about Windows PowerShell Web Access cmdlets, see the cmdlet reference topics, [Windows PowerShell Web Access Cmdlets](cmdlets/web-access-cmdlets.md).</span></span>

<span data-ttu-id="5dee4-250">如需 Windows PowerShell Web 存取授權規則和安全性的詳細資訊，請參閱 [Windows PowerShell Web 存取的授權規則與安全性功能](authorization-rules-and-security-features-of-windows-powershell-web-access.md)。</span><span class="sxs-lookup"><span data-stu-id="5dee4-250">For more detail about Windows PowerShell Web Access authorization rules and security, see [Authorization Rules and Security Features of Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md).</span></span>

#### <a name="to-add-a-restrictive-authorization-rule"></a><span data-ttu-id="5dee4-251">新增限制性授權規則</span><span class="sxs-lookup"><span data-stu-id="5dee4-251">To add a restrictive authorization rule</span></span>

1. <span data-ttu-id="5dee4-252">執行下列其中一個動作，使用提高的使用者權限開啟 Windows PowerShell 工作階段。</span><span class="sxs-lookup"><span data-stu-id="5dee4-252">Do one of the following to open a Windows PowerShell session with elevated user rights.</span></span>

    - <span data-ttu-id="5dee4-253">在 Windows 桌面上，以滑鼠右鍵按一下工作列上的 **[Windows PowerShell]**，然後按一下 **[以系統管理員身分執行]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-253">On the Windows desktop, right-click **Windows PowerShell** on the taskbar, and then click **Run as Administrator**.</span></span>

    - <span data-ttu-id="5dee4-254">在 Windows **[開始]** 畫面上，以滑鼠右鍵按一下 **[Windows PowerShell]**，然後按一下 **[以系統管理員身分執行]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-254">On the Windows **Start** screen, right-click **Windows PowerShell**, and then click **Run as Administrator**.</span></span>

2. <span data-ttu-id="5dee4-255">使用工作階段設定來限制使用者存取的選擇性步驟：確認您要在規則中使用的工作階段設定已經存在。</span><span class="sxs-lookup"><span data-stu-id="5dee4-255">Optional step for restricting user access by using session configurations: Verify that session configurations that you want to use in your rules already exist.</span></span> <span data-ttu-id="5dee4-256">如果尚未建立這些設定，請使用 [about_Session_Configuration_Files](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_session_configurations) 中建立工作階段設定的指示。</span><span class="sxs-lookup"><span data-stu-id="5dee4-256">If they have not yet been created, use instructions for creating session configurations in [about_Session_Configuration_Files](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_session_configurations).</span></span>

3. <span data-ttu-id="5dee4-257">輸入下列程式碼，然後按 **Enter**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-257">Type the following, and then press **Enter**.</span></span>

   `Add-PswaAuthorizationRule -UserName <domain\user | computer\user> -ComputerName <computer_name> -ConfigurationName <session_configuration_name>`

   <span data-ttu-id="5dee4-258">這個授權規則允許特定使用者存取網路上他們通常有權存取的一部電腦，以及該使用者在一般編寫指令碼及 Cmdlet 範圍內的特定工作階段設定存取權。</span><span class="sxs-lookup"><span data-stu-id="5dee4-258">This authorization rule allows a specific user access to one computer on the network to which they typically have access, with access to a specific session configuration that is scoped to the user's typical scripting and cmdlet needs.</span></span>
   
   <span data-ttu-id="5dee4-259">在下列範例中，`JSmith` 網域中的使用者 `Contoso` 被授與管理電腦 `Contoso_214` 的存取權，並使用名為 `NewAdminsOnly` 的工作階段設定。</span><span class="sxs-lookup"><span data-stu-id="5dee4-259">In the following example, a user named `JSmith` in the `Contoso` domain is granted access to manage the computer `Contoso_214`, and use a session configuration named `NewAdminsOnly`.</span></span>

   `Add-PswaAuthorizationRule -UserName Contoso\JSmith -ComputerName Contoso_214 -ConfigurationName NewAdminsOnly`

4. <span data-ttu-id="5dee4-260">執行 `Get-PswaAuthorizationRule` Cmdlet 或 `Test-PswaAuthorizationRule -UserName <domain\user> -ComputerName <computer-name>` 確認已建立規則</span><span class="sxs-lookup"><span data-stu-id="5dee4-260">Verify that the rule has been created by running either the `Get-PswaAuthorizationRule` cmdlet, or `Test-PswaAuthorizationRule -UserName <domain\user> -ComputerName <computer-name>`</span></span>

5. <span data-ttu-id="5dee4-261">例如，`Test-PswaAuthorizationRule -UserName 'Contoso\JSmith' -ComputerName Contoso_214`。</span><span class="sxs-lookup"><span data-stu-id="5dee4-261">For example, `Test-PswaAuthorizationRule -UserName 'Contoso\JSmith' -ComputerName Contoso_214`.</span></span>

<span data-ttu-id="5dee4-262">設定授權規則之後，授權使用者就可以開始登入網頁型主控台，並開始使用 Windows PowerShell Web 存取。</span><span class="sxs-lookup"><span data-stu-id="5dee4-262">After you have configured an authorization rule, you are ready for authorized users to sign in to the web-based console and begin using Windows PowerShell Web Access.</span></span>

## <a name="custom-deployment"></a><span data-ttu-id="5dee4-263">自訂部署</span><span class="sxs-lookup"><span data-stu-id="5dee4-263">Custom deployment</span></span>

<span data-ttu-id="5dee4-264">您可以使用伺服器管理員中的 [新增角色及功能精靈]，在執行 Windows Server 2012 R2 或 Windows Server 2012 的伺服器上安裝 Windows PowerShell Web 存取閘道。</span><span class="sxs-lookup"><span data-stu-id="5dee4-264">You can install the Windows PowerShell Web Access gateway on a server that is running Windows Server 2012 R2 or Windows Server 2012 by using the Add Roles and Features Wizard in Server Manager.</span></span> <span data-ttu-id="5dee4-265">安裝 Windows PowerShell Web 存取之後，您可以在 IIS 管理員中自訂閘道的設定。</span><span class="sxs-lookup"><span data-stu-id="5dee4-265">After Windows PowerShell Web Access is installed, you can customize the configuration of the gateway in IIS Manager.</span></span>

### <a name="install-windows-powershell-web-access"></a><span data-ttu-id="5dee4-266">安裝 Windows PowerShell Web 存取</span><span class="sxs-lookup"><span data-stu-id="5dee4-266">Install Windows PowerShell Web Access</span></span>

#### <a name="to-install-windows-powershell-web-access-by-using-the-add-roles-and-features-wizard"></a><span data-ttu-id="5dee4-267">使用新增角色及功能精靈安裝 Windows PowerShell Web 存取</span><span class="sxs-lookup"><span data-stu-id="5dee4-267">To install Windows PowerShell Web Access by using the Add Roles and Features Wizard</span></span>

1.  <span data-ttu-id="5dee4-268">如果已經開啟伺服器管理員，請移至下一個步驟。</span><span class="sxs-lookup"><span data-stu-id="5dee4-268">If Server Manager is already open, go on to the next step.</span></span> <span data-ttu-id="5dee4-269">如果尚未開啟伺服器管理員，請執行下列其中一項動作來將它開啟。</span><span class="sxs-lookup"><span data-stu-id="5dee4-269">If Server Manager is not already open, open it by doing one of the following.</span></span>

    - <span data-ttu-id="5dee4-270">在 Windows 桌面上，按一下 Windows 工作列中的 [伺服器管理員] 來啟動 [伺服器管理員]。</span><span class="sxs-lookup"><span data-stu-id="5dee4-270">On the Windows desktop, start Server Manager by clicking **Server Manager** in the Windows taskbar.</span></span>

    - <span data-ttu-id="5dee4-271">在 Windows **[開始]** 畫面上，按一下 **[伺服器管理員]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-271">On the Windows **Start** screen, click **Server Manager**.</span></span>

2.  <span data-ttu-id="5dee4-272">在 **[管理]** 功能表上，按一下 **[新增角色及功能]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-272">On the **Manage** menu, click **Add Roles and Features**.</span></span>

3.  <span data-ttu-id="5dee4-273">在 [選取安裝類型] 頁面上，選取 [角色型或功能型安裝]。</span><span class="sxs-lookup"><span data-stu-id="5dee4-273">On the **Select installation type** page, select **Role-based or feature-based installation**.</span></span> <span data-ttu-id="5dee4-274">按 **[下一步]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-274">Click **Next**.</span></span>

4.  <span data-ttu-id="5dee4-275">在 [選取目的地伺服器] 頁面上，從伺服器集區選取伺服器，或選取離線 VHD。</span><span class="sxs-lookup"><span data-stu-id="5dee4-275">On the **Select destination server** page, select a server from the server pool, or select an offline VHD.</span></span> <span data-ttu-id="5dee4-276">若要選取離線 VHD 做為目的地伺服器，請先選取要掛接 VHD 的伺服器，然後選取 VHD 檔案。</span><span class="sxs-lookup"><span data-stu-id="5dee4-276">To select an offline VHD as your destination server, first select the server on which to mount the VHD, and then select the VHD file.</span></span> <span data-ttu-id="5dee4-277">如需如何將伺服器新增到伺服器集區的相關資訊，請參閱伺服器管理員說明。</span><span class="sxs-lookup"><span data-stu-id="5dee4-277">For information about how to add servers to your server pool, see the Server Manager Help.</span></span> <span data-ttu-id="5dee4-278">選取目的地伺服器之後，按一下 **[下一步]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-278">After you have selected the destination server, click **Next**.</span></span>

5.  <span data-ttu-id="5dee4-279">在精靈的 **[選取功能]** 頁面上，展開 **[Windows PowerShell]**，然後選取 **[Windows PowerShell Web 存取]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-279">On the **Select features** page of the wizard, expand **Windows PowerShell**, and then select **Windows PowerShell Web Access**.</span></span>

6.  <span data-ttu-id="5dee4-280">請注意，系統會提示您新增必要的功能，例如 .NET Framework 4.5 以及網頁伺服器 (IIS) 的角色服務。</span><span class="sxs-lookup"><span data-stu-id="5dee4-280">Note that you are prompted to add required features, such as .NET Framework 4.5, and role services of Web Server (IIS).</span></span> <span data-ttu-id="5dee4-281">新增必要的功能，然後繼續。</span><span class="sxs-lookup"><span data-stu-id="5dee4-281">Add required features and continue.</span></span>

    ><span data-ttu-id="5dee4-282">**![注意](images/note.jpeg) 注意**</span><span class="sxs-lookup"><span data-stu-id="5dee4-282">**![Note](images/note.jpeg) Note**</span></span> 
    >
    ><span data-ttu-id="5dee4-283">使用 [新增角色及功能精靈] 安裝 Windows PowerShell Web 存取，也會安裝網頁伺服器 (IIS)，包括 [IIS 管理員] 嵌入式管理單元。</span><span class="sxs-lookup"><span data-stu-id="5dee4-283">Installing Windows PowerShell Web Access by using the Add Roles and Features Wizard also installs Web Server (IIS), including the IIS Manager snap-in.</span></span> <span data-ttu-id="5dee4-284">如果您使用 [新增角色及功能精靈]，預設會安裝嵌入式管理單元及其他 IIS 管理工具。</span><span class="sxs-lookup"><span data-stu-id="5dee4-284">The snap-in and other IIS management tools are installed by default if you use Add Roles and Features Wizard.</span></span> <span data-ttu-id="5dee4-285">如果您依下列程序中所述方式使用 Windows PowerShell Cmdlet 安裝 Windows PowerShell Web 存取，預設不會新增管理工具。</span><span class="sxs-lookup"><span data-stu-id="5dee4-285">If you install Windows PowerShell Web Access by using Windows PowerShell cmdlets as described in the following procedure, management tools are not added by default.</span></span>

7. <span data-ttu-id="5dee4-286">如果 Windows PowerShell Web 存取的功能檔案未儲存於您在步驟 4 選取的目的地伺服器上，可在 [確認安裝選項] 頁面上按一下 [指定替代來源路徑]，然後提供功能檔案的路徑。</span><span class="sxs-lookup"><span data-stu-id="5dee4-286">On the **Confirm installation selections** page, if the feature files for Windows PowerShell Web Access are not stored on the destination server that you selected in step 4, click **Specify an alternate source path**, and provide the path to the feature files.</span></span> <span data-ttu-id="5dee4-287">否則，按一下 **[安裝]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-287">Otherwise, click **Install**.</span></span>

8. <span data-ttu-id="5dee4-288">按一下 [安裝] 之後，[安裝進度] 頁面就會顯示安裝進度、結果及訊息，例如警告、失敗或 Windows PowerShell Web 存取所需的後續安裝設定步驟。</span><span class="sxs-lookup"><span data-stu-id="5dee4-288">After you click **Install**, the **Installation progress** page displays installation progress, results, and messages such as warnings, failures, or post-installation configuration steps that are required for Windows PowerShell Web Access.</span></span> <span data-ttu-id="5dee4-289">安裝 Windows PowerShell Web 存取之後，系統會提示您檢閱讀我檔案，其中包含適用於閘道的必要且基本的安裝指示。</span><span class="sxs-lookup"><span data-stu-id="5dee4-289">After Windows PowerShell Web Access is installed, you are prompted to review the readme file, which contains basic, required setup instructions for the gateway.</span></span> <span data-ttu-id="5dee4-290">本主題中也包含這些指示。</span><span class="sxs-lookup"><span data-stu-id="5dee4-290">These instructions are also included in this topic.</span></span> <span data-ttu-id="5dee4-291">讀我檔案的路徑是 `C:\Windows\Web\PowerShellWebAccess\wwwroot\README.txt`。</span><span class="sxs-lookup"><span data-stu-id="5dee4-291">The path to the readme file is `C:\Windows\Web\PowerShellWebAccess\wwwroot\README.txt`.</span></span>

### <a name="configure-the-gateway"></a><span data-ttu-id="5dee4-292">設定閘道</span><span class="sxs-lookup"><span data-stu-id="5dee4-292">Configure the gateway</span></span>

<span data-ttu-id="5dee4-293">本節的指示適用於在網站的子目錄 (不是根目錄) 中安裝 Windows PowerShell Web 存取 Web 應用程式。</span><span class="sxs-lookup"><span data-stu-id="5dee4-293">Instructions in this section are for installing the Windows PowerShell Web Access web application in a subdirectory and not in the root directory of your website.</span></span> <span data-ttu-id="5dee4-294">這個程序是等同於 `Install-PswaWebApplication` Cmdlet 所執行之動作的 GUI 動作。</span><span class="sxs-lookup"><span data-stu-id="5dee4-294">This procedure is the GUI-based equivalent of the actions performed by the `Install-PswaWebApplication` cmdlet.</span></span> <span data-ttu-id="5dee4-295">本節還包含如何使用 IIS 管理員，將 Windows PowerShell Web 存取閘道設定為根網站的指示。</span><span class="sxs-lookup"><span data-stu-id="5dee4-295">This section also includes instructions for how to use IIS Manager to configure the Windows PowerShell Web Access gateway as a root website.</span></span>

#### <a name="to-use-iis-manager-to-configure-the-gateway-in-an-existing-website"></a><span data-ttu-id="5dee4-296">使用 IIS 管理員在現有的網站中設定閘道</span><span class="sxs-lookup"><span data-stu-id="5dee4-296">To use IIS Manager to configure the gateway in an existing website</span></span>

1.  <span data-ttu-id="5dee4-297">執行下列其中一項動作以開啟 IIS 管理員主控台。</span><span class="sxs-lookup"><span data-stu-id="5dee4-297">Open the IIS Manager console by doing one of the following.</span></span>

    - <span data-ttu-id="5dee4-298">在 Windows 桌面上，按一下 Windows 工作列中的 [伺服器管理員] 來啟動 [伺服器管理員]。</span><span class="sxs-lookup"><span data-stu-id="5dee4-298">On the Windows desktop, start Server Manager by clicking **Server Manager** in the Windows taskbar.</span></span> <span data-ttu-id="5dee4-299">在 [伺服器管理員] 的 **[工具]** 功能表上，按一下 **[Internet Information Services (IIS) 管理員]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-299">On the **Tools** menu in Server Manager, click **Internet Information Services (IIS) Manager**.</span></span>

    - <span data-ttu-id="5dee4-300">在 Windows [開始] 畫面中，輸入 **Internet Information Services (IIS) 管理員**名稱的任何部分。</span><span class="sxs-lookup"><span data-stu-id="5dee4-300">On the Windows **Start** screen, type any part of the name **Internet Information Services (IIS) Manager**.</span></span> <span data-ttu-id="5dee4-301">當捷徑出現在 [應用程式] 結果時，按一下該捷徑。</span><span class="sxs-lookup"><span data-stu-id="5dee4-301">Click the shortcut when it is displayed in the **Apps** results.</span></span>

2.  <span data-ttu-id="5dee4-302">為 Windows PowerShell Web 存取建立新的應用程式集區。</span><span class="sxs-lookup"><span data-stu-id="5dee4-302">Create a new application pool for Windows PowerShell Web Access.</span></span> <span data-ttu-id="5dee4-303">在 [IIS 管理員] 樹狀目錄窗格中展開閘道伺服器的節點，選取 [應用程式集區]，然後在 [動作] 窗格中按一下 [新增應用程式集區]。</span><span class="sxs-lookup"><span data-stu-id="5dee4-303">Expand the node of the gateway server in the IIS Manager tree pane, select **Application Pools**, and click **Add Application Pool** in the **Actions** pane.</span></span>

3.  <span data-ttu-id="5dee4-304">新增名為 **pswa_pool** (或提供另一個名稱) 的新應用程式集區。</span><span class="sxs-lookup"><span data-stu-id="5dee4-304">Add a new application pool with the name **pswa_pool**, or provide another name.</span></span> <span data-ttu-id="5dee4-305">按一下 **[確定]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-305">Click **OK**.</span></span>

4.  <span data-ttu-id="5dee4-306">在 [IIS 管理員] 樹狀目錄窗格中，展開安裝 Windows PowerShell Web 存取的伺服器節點，直到可以看到 [站台] 資料夾為止。</span><span class="sxs-lookup"><span data-stu-id="5dee4-306">In the IIS Manager tree pane, expand the node for the server on which Windows PowerShell Web Access is installed until the **Sites** folder is visible.</span></span> <span data-ttu-id="5dee4-307">選取 [站台] 資料夾。</span><span class="sxs-lookup"><span data-stu-id="5dee4-307">Select the **Sites** folder.</span></span>

5.  <span data-ttu-id="5dee4-308">以滑鼠右鍵按一下您想要新增 Windows PowerShell Web 存取網站的網站 (例如 **[預設的網站]**)，然後按一下 **[新增應用程式]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-308">Right-click the website (for example, **Default Web Site**) to which you would like to add the Windows PowerShell Web Access website, and then click **Add Application**.</span></span>

6.  <span data-ttu-id="5dee4-309">在 [別名] 欄位中輸入 pswa，或者提供另一個別名。</span><span class="sxs-lookup"><span data-stu-id="5dee4-309">In the **Alias** field, type pswa, or provide another alias.</span></span> <span data-ttu-id="5dee4-310">別名會成為虛擬目錄名稱。</span><span class="sxs-lookup"><span data-stu-id="5dee4-310">The alias becomes the virtual directory name.</span></span> <span data-ttu-id="5dee4-311">例如，下列 URL 中的 **pswa** 代表在這個步驟中指定的別名：**https://\<伺服器名稱\>/pswa**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-311">For example, **pswa** in the following URL represents the alias specified in this step: **https://\<server-name\>/pswa**.</span></span>

7.  <span data-ttu-id="5dee4-312">在 [應用程式集區] 欄位中，選取您在步驟 3 建立的應用程式集區。</span><span class="sxs-lookup"><span data-stu-id="5dee4-312">In the **Application pool** field, select the application pool that you created in step 3.</span></span>

8.  <span data-ttu-id="5dee4-313">在 [實體路徑] 欄位中，瀏覽應用程式的位置。</span><span class="sxs-lookup"><span data-stu-id="5dee4-313">In the **Physical path** field, browse for the location of the application.</span></span> <span data-ttu-id="5dee4-314">您可以使用預設位置 %windir%/Web/PowerShellWebAccess/wwwroot。</span><span class="sxs-lookup"><span data-stu-id="5dee4-314">You can use the default location, %windir%/Web/PowerShellWebAccess/wwwroot.</span></span> <span data-ttu-id="5dee4-315">按一下 **[確定]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-315">Click **OK**.</span></span>

9.  <span data-ttu-id="5dee4-316">依照本主題的＜在 IIS 管理員中設定 SSL 憑證＞(#to-configure-an-ssl-certificate-in-iis-Manager) 程序中的步驟進行。</span><span class="sxs-lookup"><span data-stu-id="5dee4-316">Follow the steps in the procedure To configure an SSL certificate in IIS manager](#to-configure-an-ssl-certificate-in-iis-Manager) in this topic.</span></span>

10. <span data-ttu-id="5dee4-317">![](images/SecurityNote.jpeg) 選擇性的安全性步驟：</span><span class="sxs-lookup"><span data-stu-id="5dee4-317">![](images/SecurityNote.jpeg) Optional security step:</span></span>

    <span data-ttu-id="5dee4-318">在樹狀目錄窗格中選取網站後，按兩下 [內容] 窗格中的 [SSL 設定]。</span><span class="sxs-lookup"><span data-stu-id="5dee4-318">With the website selected in the tree pane, double-click **SSL Settings** in the content pane.</span></span> <span data-ttu-id="5dee4-319">選取 [需要 SSL]，然後在 [動作] 窗格中，按一下 [套用]。</span><span class="sxs-lookup"><span data-stu-id="5dee4-319">Select **Require SSL**, and then in the **Actions** pane, click **Apply**.</span></span> <span data-ttu-id="5dee4-320">您也可以選擇性地在 [SSL 設定] 窗格中，要求連線到 Windows PowerShell Web 存取網站的使用者必須擁有用戶端憑證。</span><span class="sxs-lookup"><span data-stu-id="5dee4-320">Optionally, in the **SSL Settings** pane, you can require that users connecting to the Windows PowerShell Web Access website have client certificates.</span></span> <span data-ttu-id="5dee4-321">用戶端憑證可協助確認用戶端裝置使用者的身份。</span><span class="sxs-lookup"><span data-stu-id="5dee4-321">Client certificates help to verify the identity of a client device user.</span></span> <span data-ttu-id="5dee4-322">如需要求用戶端憑證如何增加 Windows PowerShell Web 存取安全性的詳細資訊，請參閱本指南中的 [Windows PowerShell Web 存取的授權規則與安全性功能](authorization-rules-and-security-features-of-windows-powershell-web-access.md)。</span><span class="sxs-lookup"><span data-stu-id="5dee4-322">For more information about how requiring client certificates can increase the security of Windows PowerShell Web Access, see [Authorization Rules and Security Features of Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md) in this guide.</span></span>

11. <span data-ttu-id="5dee4-323">開啟用戶端裝置的瀏覽器工作階段。</span><span class="sxs-lookup"><span data-stu-id="5dee4-323">Open a browser session on a client device.</span></span> <span data-ttu-id="5dee4-324">如需支援的瀏覽器及裝置的詳細資訊，請參閱本主題的[瀏覽器及用戶端裝置支援](#browser-and-client-device-support)。</span><span class="sxs-lookup"><span data-stu-id="5dee4-324">For more information about supported browsers and devices, see [Browser and client device support](#browser-and-client-device-support) in this topic.</span></span>

12. <span data-ttu-id="5dee4-325">開啟新的 Windows PowerShell Web 存取網站 **https://\<匣道伺服器名稱**\>/pswa**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-325">Open the new Windows PowerShell Web Access website, **https://\<*gateway-server-name*\>/pswa**.</span></span>

    <span data-ttu-id="5dee4-326">瀏覽器應該會顯示 Windows PowerShell Web 存取主控台登入頁面。</span><span class="sxs-lookup"><span data-stu-id="5dee4-326">The browser should display the Windows PowerShell Web Access console sign-in page.</span></span>

    ><span data-ttu-id="5dee4-327">**![注意](images/note.jpeg) 注意**</span><span class="sxs-lookup"><span data-stu-id="5dee4-327">**![Note](images/note.jpeg) Note**</span></span> 
    > 
    ><span data-ttu-id="5dee4-328">必須透過新增授權規則，讓使用者獲得網站存取權，才能進行登入。</span><span class="sxs-lookup"><span data-stu-id="5dee4-328">You cannot sign in until users have been granted access to the website by adding authorization rules.</span></span> 
    ><span data-ttu-id="5dee4-329">如需詳細資訊，請參閱本主題中的[設定限制性授權規則](#configure-a-restrictive-authorization-rule)，以及 [Windows PowerShell Web 存取的授權規則與安全性功能](authorization-rules-and-security-features-of-windows-powershell-web-access.md)。</span><span class="sxs-lookup"><span data-stu-id="5dee4-329">For more information, see [Configure a restrictive authorization rule](#configure-a-restrictive-authorization-rule), in this topic, and [Authorization Rules and Security Features of Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md).</span></span>

13. <span data-ttu-id="5dee4-330">在使用提高的使用者權限 (以系統管理員身分執行) 開啟的 Windows PowerShell 工作階段中，執行下列指令碼，其中 *application_pool_name* 代表您在步驟 3 建立的應用程式集區名稱，以便授與該應用程式集區授權檔案的存取權。</span><span class="sxs-lookup"><span data-stu-id="5dee4-330">In a Windows PowerShell session that has been opened with elevated user rights (Run as Administrator), run the following script, in which *application_pool_name* represents the name of the application pool that you created in step 3, to give the application pool access rights to the authorization file.</span></span>

        $applicationPoolName = "<application_pool_name>"
        $authorizationFile = "C:\windows\web\powershellwebaccess\data\AuthorizationRules.xml"
        c:\windows\system32\icacls.exe $authorizationFile /grant ('"' + "IIS AppPool\$applicationPoolName" + '":R') > $null

    <span data-ttu-id="5dee4-331">若要檢視授權檔案的現有存取權，請執行下列命令：</span><span class="sxs-lookup"><span data-stu-id="5dee4-331">To view existing access rights on the authorization file, run the following command:</span></span>

        c:\windows\system32\icacls.exe $authorizationFile

#### <a name="to-use-iis-manager-to-configure-the-gateway-as-a-root-website-with-a-test-certificate"></a><span data-ttu-id="5dee4-332">使用 IIS 管理員以測試憑證將閘道設定為根網站</span><span class="sxs-lookup"><span data-stu-id="5dee4-332">To use IIS Manager to configure the gateway as a root website with a test certificate</span></span>

1.  <span data-ttu-id="5dee4-333">執行下列其中一項動作以開啟 IIS 管理員主控台。</span><span class="sxs-lookup"><span data-stu-id="5dee4-333">Open the IIS Manager console by doing one of the following.</span></span>

    - <span data-ttu-id="5dee4-334">在 Windows 桌面上，按一下 Windows 工作列中的 [伺服器管理員] 來啟動 [伺服器管理員]。</span><span class="sxs-lookup"><span data-stu-id="5dee4-334">On the Windows desktop, start Server Manager by clicking **Server Manager** in the Windows taskbar.</span></span> <span data-ttu-id="5dee4-335">在 [伺服器管理員] 的 **[工具]** 功能表上，按一下 **[Internet Information Services (IIS) 管理員]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-335">On the **Tools** menu in Server Manager, click **Internet Information Services (IIS) Manager**.</span></span>

    - <span data-ttu-id="5dee4-336">在 Windows [開始] 畫面中，輸入 **Internet Information Services (IIS) 管理員**名稱的任何部分。</span><span class="sxs-lookup"><span data-stu-id="5dee4-336">On the Windows **Start** screen, type any part of the name **Internet Information Services (IIS) Manager**.</span></span> <span data-ttu-id="5dee4-337">當捷徑出現在 [應用程式] 結果時，按一下該捷徑。</span><span class="sxs-lookup"><span data-stu-id="5dee4-337">Click the shortcut when it is displayed in the **Apps** results.</span></span>

2.  <span data-ttu-id="5dee4-338">在 [IIS 管理員] 樹狀目錄窗格中，展開安裝 Windows PowerShell Web 存取的伺服器節點，直到可以看到 [站台] 資料夾為止。</span><span class="sxs-lookup"><span data-stu-id="5dee4-338">In the IIS Manager tree pane, expand the node for the server on which Windows PowerShell Web Access is installed until the **Sites** folder is visible.</span></span> <span data-ttu-id="5dee4-339">選取 [站台] 資料夾。</span><span class="sxs-lookup"><span data-stu-id="5dee4-339">Select the **Sites** folder.</span></span>

3.  <span data-ttu-id="5dee4-340">在 **[動作]** 窗格中，按一下 **[Add Website] \(新增網站)**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-340">In the **Actions** pane, click **Add Website**.</span></span>

4.  <span data-ttu-id="5dee4-341">輸入網站的名稱，例如 **Windows PowerShell Web Access**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-341">Type a name for the website, such as **Windows PowerShell Web Access**.</span></span>

5.  <span data-ttu-id="5dee4-342">此時會自動為新網站建立應用程式集區。</span><span class="sxs-lookup"><span data-stu-id="5dee4-342">An application pool is automatically created for the new website.</span></span> <span data-ttu-id="5dee4-343">若要使用不同的應用程式集區，按一下 [選取]，以選取要與新網站相關聯的應用程式集區。</span><span class="sxs-lookup"><span data-stu-id="5dee4-343">To use a different application pool, click **Select** to select an application pool to associate with the new website.</span></span> <span data-ttu-id="5dee4-344">在 **[選取應用程式集區]** 對話方塊中選取替代的應用程式集區，然後按一下 **[確定]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-344">Select the alternate application pool in the **Select Application Pool** dialog box, and then click **OK**.</span></span>

6.  <span data-ttu-id="5dee4-345">在 [實體路徑] 文字方塊中，瀏覽到 %*windir*%/Web/PowerShellWebAccess/wwwroot。</span><span class="sxs-lookup"><span data-stu-id="5dee4-345">In the **Physical path** text box, navigate to %*windir*%/Web/PowerShellWebAccess/wwwroot.</span></span>

7.  <span data-ttu-id="5dee4-346">在 **[繫結]** 區域的 **[類型]** 欄位中，選取 **[https]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-346">In the **Type** field of the **Binding** area, select **https**.</span></span>

8.  <span data-ttu-id="5dee4-347">為其他站台或應用程式尚未使用的網站指派連接埠號碼。</span><span class="sxs-lookup"><span data-stu-id="5dee4-347">Assign a port number to the website that is not already in use by another site or application.</span></span> <span data-ttu-id="5dee4-348">若要尋找開放的連接埠，可以在命令提示字元視窗中執行 **netstat** 命令。</span><span class="sxs-lookup"><span data-stu-id="5dee4-348">To locate open ports, you can run the **netstat** command in a Command Prompt window.</span></span> <span data-ttu-id="5dee4-349">預設連接埠號碼為 443。</span><span class="sxs-lookup"><span data-stu-id="5dee4-349">The default port number is 443.</span></span>

    <span data-ttu-id="5dee4-350">如果另一個網站已經使用 443，或者有其他需要變更連接埠號碼的安全性原因，請變更預設連接埠。</span><span class="sxs-lookup"><span data-stu-id="5dee4-350">Change the default port if another website is already using 443, or if you have other security reasons for changing the port number.</span></span> <span data-ttu-id="5dee4-351">如果在閘道伺服器上執行的另一個網站正在使用您選取的連接埠，當您在 [新增網站] 對話方塊中按一下 [確定] 時，就會顯示警告。</span><span class="sxs-lookup"><span data-stu-id="5dee4-351">If another website that is running on your gateway server is using your selected port, a warning is displayed when you click **OK** in the **Add Website** dialog box.</span></span> <span data-ttu-id="5dee4-352">您必須使用未使用的連接埠來執行 Windows PowerShell Web 存取。</span><span class="sxs-lookup"><span data-stu-id="5dee4-352">You must use an unused port to run Windows PowerShell Web Access.</span></span>

9.  <span data-ttu-id="5dee4-353">或者，如果組織有需要，可以指定對組織及使用者有意義的主機名稱，例如 **www.contoso.com**。按一下 **[確定]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-353">Optionally, if needed for your organization, specify a host name that makes sense to your organization and users, such as **www.contoso.com**. Click **OK**.</span></span>

10. <span data-ttu-id="5dee4-354">如需更安全的生產環境，強烈建議您提供 CA 簽署的有效憑證。</span><span class="sxs-lookup"><span data-stu-id="5dee4-354">For a more secure production environment, we strongly recommend providing a valid certificate that has been signed by a CA.</span></span> <span data-ttu-id="5dee4-355">您必須提供 SSL 憑證，因為使用者只能透過 HTTPS 網站連線到 Windows PowerShell Web 存取。</span><span class="sxs-lookup"><span data-stu-id="5dee4-355">You must provide an SSL certificate, because users can only connect to Windows PowerShell Web Access through an HTTPS website.</span></span> <span data-ttu-id="5dee4-356">如需如何取得憑證的詳細資訊，請參閱本主題中的[在 IIS 管理員中設定 SSL 憑證](#to-configure-an-ssl-certificate-in-iis-Manager)。</span><span class="sxs-lookup"><span data-stu-id="5dee4-356">See [To configure an SSL certificate in IIS manager](#to-configure-an-ssl-certificate-in-iis-Manager) in this topic for more information about how to obtain a certificate.</span></span>

11. <span data-ttu-id="5dee4-357">按一下 [確定]，以關閉 [新增網站] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="5dee4-357">Click **OK** to close the **Add Website** dialog box.</span></span>

12. <span data-ttu-id="5dee4-358">在使用提高的使用者權限 (以系統管理員身分執行) 開啟的 Windows PowerShell 工作階段中，執行下列指令碼，其中 *application_pool_name* 代表您在步驟 4 建立的應用程式集區名稱，以便授與該應用程式集區授權檔案的存取權。</span><span class="sxs-lookup"><span data-stu-id="5dee4-358">In a Windows PowerShell session that has been opened with elevated user rights (Run as Administrator), run the following script, in which *application_pool_name* represents the name of the application pool that you created in step 4, to give the application pool access rights to the authorization file.</span></span>

        $applicationPoolName = "<application_pool_name>"
        $authorizationFile = "C:\windows\web\powershellwebaccess\data\AuthorizationRules.xml"
        c:\windows\system32\icacls.exe $authorizationFile /grant ('"' + "IIS AppPool\$applicationPoolName" + '":R') > $null

    <span data-ttu-id="5dee4-359">若要檢視授權檔案的現有存取權，請執行下列命令：</span><span class="sxs-lookup"><span data-stu-id="5dee4-359">To view existing access rights on the authorization file, run the following command:</span></span>

        c:\windows\system32\icacls.exe $authorizationFile

13. <span data-ttu-id="5dee4-360">在 [IIS 管理員] 樹狀目錄窗格中選取新網站後，在 [動作]  窗格中按一下 [啟動]  以啟動網站。</span><span class="sxs-lookup"><span data-stu-id="5dee4-360">With the new website selected in the IIS Manager tree pane, click **Start** in the **Actions** pane to start the website.</span></span>

14. <span data-ttu-id="5dee4-361">開啟用戶端裝置的瀏覽器工作階段。</span><span class="sxs-lookup"><span data-stu-id="5dee4-361">Open a browser session on a client device.</span></span> <span data-ttu-id="5dee4-362">如需支援的瀏覽器及裝置的詳細資訊，請參閱本文件的[瀏覽器及用戶端裝置支援](#browser-and-client-device-support)。</span><span class="sxs-lookup"><span data-stu-id="5dee4-362">For more information about supported browsers and devices, see [Browser and client device support](#browser-and-client-device-support) in this document.</span></span>

15. <span data-ttu-id="5dee4-363">開啟新的 Windows PowerShell Web 存取網站。</span><span class="sxs-lookup"><span data-stu-id="5dee4-363">Open the new Windows PowerShell Web Access website.</span></span>

    <span data-ttu-id="5dee4-364">由於根網站會指向 Windows PowerShell Web 存取資料夾，因此，當您開啟 **https://\<匣道伺服器名稱**\>** 時，瀏覽器應該會顯示 Windows PowerShell Web 存取登入頁面。</span><span class="sxs-lookup"><span data-stu-id="5dee4-364">Because the root website points to the Windows PowerShell Web Access folder, the browser should display the Windows PowerShell Web Access sign-in page when you open **https://\<*gateway_server_name*\>**.</span></span> <span data-ttu-id="5dee4-365">您應該不需要在 URL 中新增 **/pswa**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-365">You should not need to add **/pswa** to the URL.</span></span>

    ><span data-ttu-id="5dee4-366">**![注意](images/note.jpeg) 注意**</span><span class="sxs-lookup"><span data-stu-id="5dee4-366">**![Note](images/note.jpeg) Note**</span></span> 
    > 
    ><span data-ttu-id="5dee4-367">必須透過新增授權規則，讓使用者獲得網站存取權，才能進行登入。</span><span class="sxs-lookup"><span data-stu-id="5dee4-367">You cannot sign in until users have been granted access to the website by adding authorization rules.</span></span> 
    ><span data-ttu-id="5dee4-368">如需詳細資訊，請參閱本主題中的[設定限制性授權規則](#configure-a-restrictive-authorization-rule)，以及 [Windows PowerShell Web 存取的授權規則與安全性功能](authorization-rules-and-security-features-of-windows-powershell-web-access.md)。</span><span class="sxs-lookup"><span data-stu-id="5dee4-368">For more information, see [Configure a restrictive authorization rule](#configure-a-restrictive-authorization-rule), in this topic, and [Authorization Rules and Security Features of Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md).</span></span>

### <a name="configure-a-restrictive-authorization-rule"></a><span data-ttu-id="5dee4-369">設定限制性授權規則</span><span class="sxs-lookup"><span data-stu-id="5dee4-369">Configure a restrictive authorization rule</span></span>

<span data-ttu-id="5dee4-370">安裝 Windows PowerShell Web 存取並設定閘道之後，使用者就可以在瀏覽器中開啟登入頁面，但是必須等到 Windows PowerShell Web 存取系統管理員明確授與使用者存取權之後，才能登入。</span><span class="sxs-lookup"><span data-stu-id="5dee4-370">After Windows PowerShell Web Access is installed and the gateway is configured, users can open the sign-in page in a browser, but they cannot sign in until the Windows PowerShell Web Access administrator grants users access explicitly.</span></span> <span data-ttu-id="5dee4-371">您可以使用下表所述的 Windows PowerShell Cmdlet，來管理 Windows PowerShell Web 存取存取控制。</span><span class="sxs-lookup"><span data-stu-id="5dee4-371">Windows PowerShell Web Access access control is managed by using the set of Windows PowerShell cmdlets described in the following table.</span></span> <span data-ttu-id="5dee4-372">沒有適用於新增或管理授權規則的 GUI。</span><span class="sxs-lookup"><span data-stu-id="5dee4-372">There is no comparable GUI for adding or managing authorization rules.</span></span> <span data-ttu-id="5dee4-373">如需 Windows PowerShell Web 存取 Cmdlet 的詳細資訊，請參閱 Cmdlet 參考主題：[Windows PowerShell Web Access Cmdlets](cmdlets/web-access-cmdlets.md) (Windows PowerShell Web 存取 Cmdlet)。</span><span class="sxs-lookup"><span data-stu-id="5dee4-373">For more detailed information about Windows PowerShell Web Access cmdlets, see the cmdlet reference topics, [Windows PowerShell Web Access Cmdlets](cmdlets/web-access-cmdlets.md).</span></span>

<span data-ttu-id="5dee4-374">如需 Windows PowerShell Web 存取授權規則和安全性的詳細資訊，請參閱 [Windows PowerShell Web 存取的授權規則與安全性功能](authorization-rules-and-security-features-of-windows-powershell-web-access.md)。</span><span class="sxs-lookup"><span data-stu-id="5dee4-374">For more detail about Windows PowerShell Web Access authorization rules and security, see [Authorization Rules and Security Features of Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md).</span></span>

#### <a name="to-add-a-restrictive-authorization-rule"></a><span data-ttu-id="5dee4-375">新增限制性授權規則</span><span class="sxs-lookup"><span data-stu-id="5dee4-375">To add a restrictive authorization rule</span></span>

1.  <span data-ttu-id="5dee4-376">執行下列其中一個動作，使用提高的使用者權限開啟 Windows PowerShell 工作階段。</span><span class="sxs-lookup"><span data-stu-id="5dee4-376">Do one of the following to open a Windows PowerShell session with elevated user rights.</span></span>

    - <span data-ttu-id="5dee4-377">在 Windows 桌面上，以滑鼠右鍵按一下工作列上的 **[Windows PowerShell]**，然後按一下 **[以系統管理員身分執行]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-377">On the Windows desktop, right-click **Windows PowerShell** on the taskbar, and then click **Run as Administrator**.</span></span>

    - <span data-ttu-id="5dee4-378">在 Windows **[開始]** 畫面上，以滑鼠右鍵按一下 **[Windows PowerShell]**，然後按一下 **[以系統管理員身分執行]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-378">On the Windows **Start** screen, right-click **Windows PowerShell**, and then click **Run as Administrator**.</span></span>

2.  ![安全性注意事項](images/SecurityNote.jpeg) <span data-ttu-id="5dee4-380">使用工作階段設定限制使用者存取的選擇性步驟：</span><span class="sxs-lookup"><span data-stu-id="5dee4-380">Optional step for restricting user access by using session configurations:</span></span>

    <span data-ttu-id="5dee4-381">確定您要在規則中使用的工作階段設定已經存在。</span><span class="sxs-lookup"><span data-stu-id="5dee4-381">Verify that session configurations that you want to use in your rules already exist.</span></span> <span data-ttu-id="5dee4-382">如果尚未建立這些設定，請使用 [about_Session_Configuration_Files](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_session_configurations) 中建立工作階段設定的指示。</span><span class="sxs-lookup"><span data-stu-id="5dee4-382">If they have not yet been created, use instructions for creating session configurations in [about_Session_Configuration_Files](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_session_configurations).</span></span>

3.  <span data-ttu-id="5dee4-383">輸入下列程式碼，然後按 **Enter**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-383">Type the following, and then press **Enter**.</span></span>

        Add-PswaAuthorizationRule -UserName <domain\user | computer\user> -ComputerName <computer_name> -ConfigurationName <session_configuration_name>

    <span data-ttu-id="5dee4-384">這個授權規則允許特定使用者存取網路上他們通常有權存取的一部電腦，以及該使用者在一般編寫指令碼及 Cmdlet 範圍內的特定工作階段設定存取權。</span><span class="sxs-lookup"><span data-stu-id="5dee4-384">This authorization rule allows a specific user access to one computer on the network to which they typically have access, with access to a specific session configuration that is scoped to the userâ€™s typical scripting and cmdlet needs.</span></span> 
    
    <span data-ttu-id="5dee4-385">在下列範例中，`JSmith` 網域中的使用者 `Contoso` 被授與管理電腦 `Contoso_214` 的存取權，並使用名為 `NewAdminsOnly` 的工作階段設定。</span><span class="sxs-lookup"><span data-stu-id="5dee4-385">In the following example, a user named `JSmith` in the `Contoso` domain is granted access to manage the computer `Contoso_214`, and use a session configuration named `NewAdminsOnly`.</span></span>

        Add-PswaAuthorizationRule -UserName 'Contoso\JSmith' -ComputerName Contoso_214 -ConfigurationName NewAdminsOnly

4.  <span data-ttu-id="5dee4-386">執行 `Get-PswaAuthorizationRule` Cmdlet 或 `Test-PswaAuthorizationRule -UserName '<domain\user>' -ComputerName <computer-name>` 確認已建立規則。</span><span class="sxs-lookup"><span data-stu-id="5dee4-386">Verify that the rule has been created by running either the `Get-PswaAuthorizationRule` cmdlet, or `Test-PswaAuthorizationRule -UserName '<domain\user>' -ComputerName <computer-name>`.</span></span> 

    <span data-ttu-id="5dee4-387">例如，`Test-PswaAuthorizationRule -UserName 'Contoso\JSmith' -ComputerName Contoso_214`。</span><span class="sxs-lookup"><span data-stu-id="5dee4-387">For example, `Test-PswaAuthorizationRule -UserName 'Contoso\JSmith' -ComputerName Contoso_214`.</span></span>

<span data-ttu-id="5dee4-388">設定授權規則之後，授權使用者就可以開始登入網頁型主控台，並開始使用 Windows PowerShell Web 存取。</span><span class="sxs-lookup"><span data-stu-id="5dee4-388">After you have configured an authorization rule, you are ready for authorized users to sign in to the web-based console and begin using Windows PowerShell Web Access.</span></span>

## <a name="configure-a-genuine-certificate"></a><span data-ttu-id="5dee4-389">設定正版憑證</span><span class="sxs-lookup"><span data-stu-id="5dee4-389">Configure a genuine certificate</span></span>

<span data-ttu-id="5dee4-390">若要安全的生產環境，請一律使用由憑證授權單位 (CA) 簽署的有效 SSL 憑證。</span><span class="sxs-lookup"><span data-stu-id="5dee4-390">For a secure production environment, always use a valid SSL certificate that has been signed by a certification authority (CA).</span></span> <span data-ttu-id="5dee4-391">本節中的程序說明如何從 CA 取得有效的 SSL 憑證並加以套用。</span><span class="sxs-lookup"><span data-stu-id="5dee4-391">The procedure in this section describes how to obtain and apply a valid SSL certificate from a CA.</span></span>

### <a name="to-configure-an-ssl-certificate-in-iis-manager"></a><span data-ttu-id="5dee4-392">在 IIS 管理員中設定 SSL 憑證</span><span class="sxs-lookup"><span data-stu-id="5dee4-392">To configure an SSL certificate in IIS Manager</span></span>

1.  <span data-ttu-id="5dee4-393">在 [IIS 管理員] 樹狀目錄窗格中，選取安裝 Windows PowerShell Web 存取的伺服器。</span><span class="sxs-lookup"><span data-stu-id="5dee4-393">In the IIS Manager tree pane, select the server on which Windows PowerShell Web Access is installed.</span></span>

2.  <span data-ttu-id="5dee4-394">在內容窗格中，按兩下 **[伺服器憑證]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-394">In the content pane, double click **Server Certificates**.</span></span>

3.  <span data-ttu-id="5dee4-395">在 [動作] 窗格中，執行下列其中一項。</span><span class="sxs-lookup"><span data-stu-id="5dee4-395">In the **Actions** pane, do one of the following.</span></span> <span data-ttu-id="5dee4-396">如需在 IIS 中設定伺服器憑證的詳細資訊，請參閱[在 IIS 7 中設定伺服器憑證](https://technet.microsoft.com/library/cc732230.aspx)。</span><span class="sxs-lookup"><span data-stu-id="5dee4-396">For more information about configuring server certificates in IIS, see [Configuring Server Certificates in IIS 7](https://technet.microsoft.com/library/cc732230.aspx).</span></span>

    - <span data-ttu-id="5dee4-397">按一下 [匯入]，從網路上的位置匯入現有的有效憑證。</span><span class="sxs-lookup"><span data-stu-id="5dee4-397">Click **Import** to import an existing, valid certificate from a location on your network.</span></span>

    - <span data-ttu-id="5dee4-398">按一下 [建立憑證要求]，向 CA (例如 [VeriSign](http://www.verisign.com/)、[Thawte](https://www.thawte.com/) 或 [GeoTrust](https://www.geotrust.com/)) 要求憑證。</span><span class="sxs-lookup"><span data-stu-id="5dee4-398">Click **Create Certificate Request** to request a certificate from a CA such as [VeriSign](http://www.verisign.com/), [Thawte](https://www.thawte.com/), or [GeoTrust](https://www.geotrust.com/).</span></span> <span data-ttu-id="5dee4-399">憑證的一般名稱必須符合要求中的主機標頭。</span><span class="sxs-lookup"><span data-stu-id="5dee4-399">The certificate's common name must match the host header in the request.</span></span>

      <span data-ttu-id="5dee4-400">例如，如果用戶端瀏覽器要求 http://www.contoso.com/，則一般名稱也必須為 http://www.contoso.com/。</span><span class="sxs-lookup"><span data-stu-id="5dee4-400">For example, if the client browser requests http://www.contoso.com/, then the common name must also be http://www.contoso.com/.</span></span> <span data-ttu-id="5dee4-401">這是提供憑證給 Windows PowerShell Web 存取閘道最安全且最建議的選項。</span><span class="sxs-lookup"><span data-stu-id="5dee4-401">This is the most secure and recommended option for providing the Windows PowerShell Web Access gateway with a certificate.</span></span>

    - <span data-ttu-id="5dee4-402">按一下 [建立自我簽署憑證]，建立您可以立即使用的憑證，稍後視需要交由 CA 簽署。</span><span class="sxs-lookup"><span data-stu-id="5dee4-402">Click **Create a Self-Signed Certificate** to create a certificate that you can use immediately, and have signed later by a CA if desired.</span></span> <span data-ttu-id="5dee4-403">為自我簽署的憑證指定易記名稱，例如 **Windows PowerShell Web 存取**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-403">Specify a friendly name for the self-signed certificate, such as **Windows PowerShell Web Access**.</span></span> <span data-ttu-id="5dee4-404">這個選項並不安全，建議只用於私人測試環境。</span><span class="sxs-lookup"><span data-stu-id="5dee4-404">This option is not considered secure, and is recommended only for a private test environment.</span></span>

4.  <span data-ttu-id="5dee4-405">建立或取得憑證之後，在 [IIS 管理員] 樹狀目錄窗格中選取要套用此憑證的網站 (例如 [預設的網站])，然後在 [動作] 窗格中按一下 [繫結]。</span><span class="sxs-lookup"><span data-stu-id="5dee4-405">After creating or obtaining a certificate, select the website to which the certificate is applied (for example, **Default Web Site**) in the IIS Manager tree pane, and then click **Bindings** in the **Actions** pane.</span></span>

5.  <span data-ttu-id="5dee4-406">如果尚未顯示繫結，請在 [新增站台繫結] 對話方塊中，新增站台的 [https] 繫結。</span><span class="sxs-lookup"><span data-stu-id="5dee4-406">In the **Add Site Binding** dialog box, add an **https** binding for the site, if one is not already displayed.</span></span> <span data-ttu-id="5dee4-407">如果您不是使用自我簽署的憑證，請指定這個程序步驟 3 所指定的主機名稱。</span><span class="sxs-lookup"><span data-stu-id="5dee4-407">If you are not using a self-signed certificate, specify the host name from step 3 of this procedure.</span></span> <span data-ttu-id="5dee4-408">如果您使用的是自我簽署的憑證，就不需要這個步驟。</span><span class="sxs-lookup"><span data-stu-id="5dee4-408">If you are using a self-signed certificate, this step is not required.</span></span>

6.  <span data-ttu-id="5dee4-409">選取您在這個程序的步驟 3 取得或建立的憑證，然後按一下 **[確定]**。</span><span class="sxs-lookup"><span data-stu-id="5dee4-409">Select the certificate that you obtained or created in step 3 of this procedure, and then click **OK**.</span></span>

## <a name="using-the-web-based-windows-powershell-console"></a><span data-ttu-id="5dee4-410">使用網頁型 Windows PowerShell 主控台</span><span class="sxs-lookup"><span data-stu-id="5dee4-410">Using the web-based Windows PowerShell console</span></span>

<span data-ttu-id="5dee4-411">依本主題所述方式安裝 Windows PowerShell Web 存取並完成閘道設定之後，就可以使用 Windows PowerShell 網頁型主控台。</span><span class="sxs-lookup"><span data-stu-id="5dee4-411">After Windows PowerShell Web Access is installed and the gateway configuration is finished as described in this topic, the Windows PowerShell web-based console is ready to use.</span></span> <span data-ttu-id="5dee4-412">如需開始使用網頁型主控台的詳細資訊，請參閱[使用網頁型 Windows PowerShell 主控台](use-the-web-based-windows-powershell-console.md)。</span><span class="sxs-lookup"><span data-stu-id="5dee4-412">For more information about getting started in the web-based console, see [Use the Web-based Windows PowerShell Console](use-the-web-based-windows-powershell-console.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="5dee4-413">另請參閱</span><span class="sxs-lookup"><span data-stu-id="5dee4-413">See Also</span></span>

- [<span data-ttu-id="5dee4-414">Internet Information Services (IIS) 7.0 文件</span><span class="sxs-lookup"><span data-stu-id="5dee4-414">Internet Information Services (IIS) 7.0 Documentation</span></span>](https://technet.microsoft.com/library/cc753433.aspx)
- [<span data-ttu-id="5dee4-415">IIS 管理員 7.0 說明</span><span class="sxs-lookup"><span data-stu-id="5dee4-415">IIS Manager 7.0 Help</span></span>](https://technet.microsoft.com/library/cc732664.aspx)
- [<span data-ttu-id="5dee4-416">設定網頁伺服器安全性 (IIS 7)</span><span class="sxs-lookup"><span data-stu-id="5dee4-416">Configure Web Server Security (IIS 7)</span></span>](https://technet.microsoft.com/library/cc731278.aspx)
- [<span data-ttu-id="5dee4-417">IPsec 部署資源</span><span class="sxs-lookup"><span data-stu-id="5dee4-417">IPsec Deployment Resources</span></span>](https://technet.microsoft.com/network/bb531150)
