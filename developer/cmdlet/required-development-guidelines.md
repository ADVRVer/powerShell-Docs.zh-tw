---
title: 必要的開發指導方針 |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 41d2b308-a36a-496f-8542-666b6a21eedc
caps.latest.revision: 19
ms.openlocfilehash: 3f6bcd2e4ef4d9c404b3a5deeaa9f25d3fa42ec1
ms.sourcegitcommit: e7445ba8203da304286c591ff513900ad1c244a4
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/23/2019
ms.locfileid: "62067462"
---
# <a name="required-development-guidelines"></a><span data-ttu-id="998f8-102">必要的開發指導方針</span><span class="sxs-lookup"><span data-stu-id="998f8-102">Required Development Guidelines</span></span>

<span data-ttu-id="998f8-103">當您撰寫您的 cmdlet 時，必須遵循下列指導方針。</span><span class="sxs-lookup"><span data-stu-id="998f8-103">The following guidelines must be followed when you write your cmdlets.</span></span> <span data-ttu-id="998f8-104">分成設計的 cmdlet 和撰寫程式的指令程式碼的指導方針的指導方針。</span><span class="sxs-lookup"><span data-stu-id="998f8-104">They are separated into guidelines for designing cmdlets and guidelines for writing your cmdlet code.</span></span> <span data-ttu-id="998f8-105">如果您未遵循這些指導方針，cmdlet 可能會失敗，並在使用您的 cmdlet 時，您的使用者可能有不佳的體驗。</span><span class="sxs-lookup"><span data-stu-id="998f8-105">If you do not follow these guidelines, your cmdlets could fail, and your users might have a poor experience when they use your cmdlets.</span></span>

## <a name="in-this-topic"></a><span data-ttu-id="998f8-106">本主題中</span><span class="sxs-lookup"><span data-stu-id="998f8-106">In this Topic</span></span>

### <a name="design-guidelines"></a><span data-ttu-id="998f8-107">設計指導方針</span><span class="sxs-lookup"><span data-stu-id="998f8-107">Design Guidelines</span></span>

- [<span data-ttu-id="998f8-108">只使用核准的動詞命令 (RD01)</span><span class="sxs-lookup"><span data-stu-id="998f8-108">Use Only Approved Verbs (RD01)</span></span>](./required-development-guidelines.md#use-only-approved-verbs-rd01)

- [<span data-ttu-id="998f8-109">Cmdlet 名稱：無法使用的字元 (RD02)</span><span class="sxs-lookup"><span data-stu-id="998f8-109">Cmdlet Names: Characters that cannot be Used (RD02)</span></span>](./required-development-guidelines.md#cmdlet-names-characters-that-cannot-be-used-rd02)

- [<span data-ttu-id="998f8-110">無法使用的參數名稱 (RD03)</span><span class="sxs-lookup"><span data-stu-id="998f8-110">Parameters Names that cannot be Used (RD03)</span></span>](./required-development-guidelines.md#parameters-names-that-cannot-be-used-rd03)

- [<span data-ttu-id="998f8-111">支援確認要求 (RD04)</span><span class="sxs-lookup"><span data-stu-id="998f8-111">Support Confirmation Requests (RD04)</span></span>](./required-development-guidelines.md#support-confirmation-requests-rd04)

- [<span data-ttu-id="998f8-112">針對互動式工作階段 (RD05) 支援 Force 參數</span><span class="sxs-lookup"><span data-stu-id="998f8-112">Support Force Parameter for Interactive Sessions (RD05)</span></span>](./required-development-guidelines.md#support-force-parameter-for-interactive-sessions-rd05)

- [<span data-ttu-id="998f8-113">文件輸出物件 (RD06)</span><span class="sxs-lookup"><span data-stu-id="998f8-113">Document Output Objects (RD06)</span></span>](./required-development-guidelines.md#document-output-objects-rd06)

### <a name="code-guidelines"></a><span data-ttu-id="998f8-114">程式碼的指導方針</span><span class="sxs-lookup"><span data-stu-id="998f8-114">Code Guidelines</span></span>

- [<span data-ttu-id="998f8-115">衍生自的 Cmdlet 或 PSCmdlet 類別 (RC01)</span><span class="sxs-lookup"><span data-stu-id="998f8-115">Derive from the Cmdlet or PSCmdlet Classes (RC01)</span></span>](./required-development-guidelines.md#derive-from-the-cmdlet-or-pscmdlet-classes-rc01)

- [<span data-ttu-id="998f8-116">指定 Cmdlet 屬性 (RC02)</span><span class="sxs-lookup"><span data-stu-id="998f8-116">Specify the Cmdlet Attribute (RC02)</span></span>](./required-development-guidelines.md#specify-the-cmdlet-attribute-rc02)

- [<span data-ttu-id="998f8-117">覆寫輸入處理方法 (RC03)</span><span class="sxs-lookup"><span data-stu-id="998f8-117">Override an Input Processing Method (RC03)</span></span>](./required-development-guidelines.md#override-an-input-processing-method-rc03)

- [<span data-ttu-id="998f8-118">指定 OutputType 屬性 (RC04)</span><span class="sxs-lookup"><span data-stu-id="998f8-118">Specify the OutputType Attribute (RC04)</span></span>](./required-development-guidelines.md#specify-the-outputtype-attribute-rc04)

- [<span data-ttu-id="998f8-119">不會保留輸出物件 (RC05) 的控制代碼</span><span class="sxs-lookup"><span data-stu-id="998f8-119">Do Not Retain Handles to Output Objects (RC05)</span></span>](./required-development-guidelines.md#do-not-retain-handles-to-output-objects-rc05)

- [<span data-ttu-id="998f8-120">穩固處理錯誤 (RC06)</span><span class="sxs-lookup"><span data-stu-id="998f8-120">Handle Errors Robustly (RC06)</span></span>](./required-development-guidelines.md#handle-errors-robustly-rc06)

- [<span data-ttu-id="998f8-121">使用 Windows PowerShell 模組來部署您的 Cmdlet (RC07)</span><span class="sxs-lookup"><span data-stu-id="998f8-121">Use a Windows PowerShell Module to Deploy your Cmdlets (RC07)</span></span>](./required-development-guidelines.md#use-a-windows-powershell-module-to-deploy-your-cmdlets-rc07)

## <a name="design-guidelines"></a><span data-ttu-id="998f8-122">設計指導方針</span><span class="sxs-lookup"><span data-stu-id="998f8-122">Design Guidelines</span></span>

<span data-ttu-id="998f8-123">設計以確保一致的使用者經驗之間使用您的 cmdlet 和其他 cmdlet 的 cmdlet 時，必須遵循下列指導方針。</span><span class="sxs-lookup"><span data-stu-id="998f8-123">The following guidelines must be followed when designing cmdlets to ensure a consistent user experience between using your cmdlets and other cmdlets.</span></span> <span data-ttu-id="998f8-124">當您找到適用於您情況的設計指導方針時，請務必查看類似的指導方針中的程式碼的方針。</span><span class="sxs-lookup"><span data-stu-id="998f8-124">When you find a Design guideline that applies to your situation, be sure to look at the Code guidelines for similar guidelines.</span></span>

### <a name="use-only-approved-verbs-rd01"></a><span data-ttu-id="998f8-125">只使用核准的動詞命令 (RD01)</span><span class="sxs-lookup"><span data-stu-id="998f8-125">Use Only Approved Verbs (RD01)</span></span>

<span data-ttu-id="998f8-126">Cmdlet 屬性中指定的動詞命令必須來自可辨識的 Windows PowerShell 所提供的動詞命令集合。</span><span class="sxs-lookup"><span data-stu-id="998f8-126">The verb specified in the Cmdlet attribute must come from the recognized set of verbs provided by Windows PowerShell.</span></span> <span data-ttu-id="998f8-127">它不能其中一個禁止的同義字。</span><span class="sxs-lookup"><span data-stu-id="998f8-127">It must not be one of the prohibited synonyms.</span></span> <span data-ttu-id="998f8-128">使用下列列舉來指定 cmdlet 動詞命令所定義的常數字串：</span><span class="sxs-lookup"><span data-stu-id="998f8-128">Use the constant strings that are defined by the following enumerations to specify cmdlet verbs:</span></span>

- [<span data-ttu-id="998f8-129">System.Management.Automation.VerbsCommon</span><span class="sxs-lookup"><span data-stu-id="998f8-129">System.Management.Automation.VerbsCommon</span></span>](/dotnet/api/System.Management.Automation.VerbsCommon)

- [<span data-ttu-id="998f8-130">System.Management.Automation.VerbsCommunications</span><span class="sxs-lookup"><span data-stu-id="998f8-130">System.Management.Automation.VerbsCommunications</span></span>](/dotnet/api/System.Management.Automation.VerbsCommunications)

- [<span data-ttu-id="998f8-131">System.Management.Automation.VerbsData</span><span class="sxs-lookup"><span data-stu-id="998f8-131">System.Management.Automation.VerbsData</span></span>](/dotnet/api/System.Management.Automation.VerbsData)

- [<span data-ttu-id="998f8-132">System.Management.Automation.VerbsDiagnostic</span><span class="sxs-lookup"><span data-stu-id="998f8-132">System.Management.Automation.VerbsDiagnostic</span></span>](/dotnet/api/System.Management.Automation.VerbsDiagnostic)

- [<span data-ttu-id="998f8-133">System.Management.Automation.VerbsLifeCycle</span><span class="sxs-lookup"><span data-stu-id="998f8-133">System.Management.Automation.VerbsLifeCycle</span></span>](/dotnet/api/System.Management.Automation.VerbsLifeCycle)

- [<span data-ttu-id="998f8-134">System.Management.Automation.VerbsSecurity</span><span class="sxs-lookup"><span data-stu-id="998f8-134">System.Management.Automation.VerbsSecurity</span></span>](/dotnet/api/System.Management.Automation.VerbsSecurity)

- [<span data-ttu-id="998f8-135">System.Management.Automation.VerbsOther</span><span class="sxs-lookup"><span data-stu-id="998f8-135">System.Management.Automation.VerbsOther</span></span>](/dotnet/api/System.Management.Automation.VerbsOther)

<span data-ttu-id="998f8-136">如需已核准的動詞名稱的詳細資訊，請參閱[Cmdlet 動詞](./approved-verbs-for-windows-powershell-commands.md)。</span><span class="sxs-lookup"><span data-stu-id="998f8-136">For more information about the approved verb names, see [Cmdlet Verbs](./approved-verbs-for-windows-powershell-commands.md).</span></span>

<span data-ttu-id="998f8-137">使用者需要一組可探索和預期的 cmdlet 名稱。</span><span class="sxs-lookup"><span data-stu-id="998f8-137">Users need a set of discoverable and expected cmdlet names.</span></span> <span data-ttu-id="998f8-138">讓使用者可以快速評估 cmdlet 的用途，並輕鬆地找出系統的功能，請使用適當的動詞命令。</span><span class="sxs-lookup"><span data-stu-id="998f8-138">Use the appropriate verb so that the user can make a quick assessment of what a cmdlet does and to easily discover the capabilities of the system.</span></span> <span data-ttu-id="998f8-139">例如，下列的命令列命令取得名稱開頭為"start"系統上的所有命令的清單： `get-command start-*`。</span><span class="sxs-lookup"><span data-stu-id="998f8-139">For example, the following command-line command gets a list of all the commands on the system whose names begin with "start": `get-command start-*`.</span></span> <span data-ttu-id="998f8-140">使用在您的 cmdlet 名詞來區分您的 cmdlet 與其他 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="998f8-140">Use the nouns in your cmdlets to differentiate your cmdlets from other cmdlets.</span></span> <span data-ttu-id="998f8-141">名詞指出要在作業執行所在的資源。</span><span class="sxs-lookup"><span data-stu-id="998f8-141">The noun indicates the resource on which the operation will be performed.</span></span> <span data-ttu-id="998f8-142">作業本身被以動詞命令。</span><span class="sxs-lookup"><span data-stu-id="998f8-142">The operation itself is represented by the verb.</span></span>

### <a name="cmdlet-names-characters-that-cannot-be-used-rd02"></a><span data-ttu-id="998f8-143">Cmdlet 名稱：無法使用的字元 (RD02)</span><span class="sxs-lookup"><span data-stu-id="998f8-143">Cmdlet Names: Characters that cannot be Used (RD02)</span></span>

<span data-ttu-id="998f8-144">當您命名 cmdlet 時，請勿使用任何下列特殊字元。</span><span class="sxs-lookup"><span data-stu-id="998f8-144">When you name cmdlets, do not use any of the following special characters.</span></span>

|<span data-ttu-id="998f8-145">字元</span><span class="sxs-lookup"><span data-stu-id="998f8-145">Character</span></span>|<span data-ttu-id="998f8-146">名稱</span><span class="sxs-lookup"><span data-stu-id="998f8-146">Name</span></span>|
|---------------|----------|
|#|<span data-ttu-id="998f8-147">數字符號</span><span class="sxs-lookup"><span data-stu-id="998f8-147">number sign</span></span>|
|<span data-ttu-id="998f8-148">、</span><span class="sxs-lookup"><span data-stu-id="998f8-148">,</span></span>|<span data-ttu-id="998f8-149">逗號</span><span class="sxs-lookup"><span data-stu-id="998f8-149">comma</span></span>|
|<span data-ttu-id="998f8-150">()</span><span class="sxs-lookup"><span data-stu-id="998f8-150">()</span></span>|<span data-ttu-id="998f8-151">括號</span><span class="sxs-lookup"><span data-stu-id="998f8-151">parentheses</span></span>|
|{}|<span data-ttu-id="998f8-152">大括號</span><span class="sxs-lookup"><span data-stu-id="998f8-152">braces</span></span>|
|<span data-ttu-id="998f8-153">[]</span><span class="sxs-lookup"><span data-stu-id="998f8-153">[]</span></span>|<span data-ttu-id="998f8-154">方括號</span><span class="sxs-lookup"><span data-stu-id="998f8-154">brackets</span></span>|
|&|<span data-ttu-id="998f8-155">連字號</span><span class="sxs-lookup"><span data-stu-id="998f8-155">ampersand</span></span>|
|-|<span data-ttu-id="998f8-156">連字號**附註：** 連字號可以用來分隔從名詞動詞，但無法使用的動詞或名詞中。</span><span class="sxs-lookup"><span data-stu-id="998f8-156">hyphen **Note:**  The hyphen can be used to separate the verb from the noun, but it cannot be used within the noun or within the verb.</span></span>|
|/|<span data-ttu-id="998f8-157">斜線符號</span><span class="sxs-lookup"><span data-stu-id="998f8-157">slash mark</span></span>|
|<span data-ttu-id="998f8-158">\|反斜線</span><span class="sxs-lookup"><span data-stu-id="998f8-158">\|backslash</span></span>|
|$|<span data-ttu-id="998f8-159">貨幣符號</span><span class="sxs-lookup"><span data-stu-id="998f8-159">dollar sign</span></span>|
|^|<span data-ttu-id="998f8-160">插入號</span><span class="sxs-lookup"><span data-stu-id="998f8-160">caret</span></span>|
|<span data-ttu-id="998f8-161">;</span><span class="sxs-lookup"><span data-stu-id="998f8-161">;</span></span>|<span data-ttu-id="998f8-162">分號</span><span class="sxs-lookup"><span data-stu-id="998f8-162">semicolon</span></span>|
|<span data-ttu-id="998f8-163">：</span><span class="sxs-lookup"><span data-stu-id="998f8-163">:</span></span>|<span data-ttu-id="998f8-164">冒號</span><span class="sxs-lookup"><span data-stu-id="998f8-164">colon</span></span>|
|<span data-ttu-id="998f8-165">"</span><span class="sxs-lookup"><span data-stu-id="998f8-165">"</span></span>|<span data-ttu-id="998f8-166">雙引號</span><span class="sxs-lookup"><span data-stu-id="998f8-166">double quotation mark</span></span>|
|<span data-ttu-id="998f8-167">'</span><span class="sxs-lookup"><span data-stu-id="998f8-167">'</span></span>|<span data-ttu-id="998f8-168">單引號</span><span class="sxs-lookup"><span data-stu-id="998f8-168">single quotation mark</span></span>|
|<>|<span data-ttu-id="998f8-169">角括弧</span><span class="sxs-lookup"><span data-stu-id="998f8-169">angle brackets</span></span>|
|<span data-ttu-id="998f8-170">&#124;</span><span class="sxs-lookup"><span data-stu-id="998f8-170">&#124;</span></span>|<span data-ttu-id="998f8-171">直槓</span><span class="sxs-lookup"><span data-stu-id="998f8-171">vertical bar</span></span>|
|<span data-ttu-id="998f8-172">?</span><span class="sxs-lookup"><span data-stu-id="998f8-172">?</span></span>|<span data-ttu-id="998f8-173">問號</span><span class="sxs-lookup"><span data-stu-id="998f8-173">question mark</span></span>|
|@|<span data-ttu-id="998f8-174">@ 記號</span><span class="sxs-lookup"><span data-stu-id="998f8-174">at sign</span></span>|
|<span data-ttu-id="998f8-175">' | 回刻度 （抑音符號）</span><span class="sxs-lookup"><span data-stu-id="998f8-175">\`|back tick (grave accent)</span></span>|
|*|<span data-ttu-id="998f8-176">星號</span><span class="sxs-lookup"><span data-stu-id="998f8-176">asterisk</span></span>|
|%|<span data-ttu-id="998f8-177">百分比符號</span><span class="sxs-lookup"><span data-stu-id="998f8-177">percent sign</span></span>|
|+|<span data-ttu-id="998f8-178">加號</span><span class="sxs-lookup"><span data-stu-id="998f8-178">plus sign</span></span>|
|=|<span data-ttu-id="998f8-179">等號</span><span class="sxs-lookup"><span data-stu-id="998f8-179">equals sign</span></span>|
|~|<span data-ttu-id="998f8-180">波狀符號</span><span class="sxs-lookup"><span data-stu-id="998f8-180">tilde</span></span>|

### <a name="parameters-names-that-cannot-be-used-rd03"></a><span data-ttu-id="998f8-181">無法使用的參數名稱 (RD03)</span><span class="sxs-lookup"><span data-stu-id="998f8-181">Parameters Names that cannot be Used (RD03)</span></span>

<span data-ttu-id="998f8-182">為所有的 cmdlet 參數加上額外的參數會加入在特定情況下，Windows PowerShell 會提供一組通用。</span><span class="sxs-lookup"><span data-stu-id="998f8-182">Windows PowerShell provides a common set a parameters to all cmdlets plus additional parameters that are added in specific situations.</span></span> <span data-ttu-id="998f8-183">設計您自己的 cmdlet 時，您無法使用下列名稱：確認、 Debug、 ErrorAction、 ErrorVariable、 OutBuffer OutVariable、 WarningAction、 WarningVariable、 WhatIf、 UseTransaction，和詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="998f8-183">When designing your own cmdlets you cannot use the following names: Confirm, Debug, ErrorAction, ErrorVariable, OutBuffer, OutVariable, WarningAction, WarningVariable, WhatIf, UseTransaction, and Verbose.</span></span> <span data-ttu-id="998f8-184">如需有關這些參數的詳細資訊，請參閱 <<c0> [ 常見的參數名稱](./common-parameter-names.md)。</span><span class="sxs-lookup"><span data-stu-id="998f8-184">For more information about these parameters, see [Common Parameter Names](./common-parameter-names.md).</span></span>

### <a name="support-confirmation-requests-rd04"></a><span data-ttu-id="998f8-185">支援確認要求 (RD04)</span><span class="sxs-lookup"><span data-stu-id="998f8-185">Support Confirmation Requests (RD04)</span></span>

<span data-ttu-id="998f8-186">針對執行的作業，修改系統的 cmdlet，應該呼叫[System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)方法來要求確認，並在特殊情況下呼叫[System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)方法。</span><span class="sxs-lookup"><span data-stu-id="998f8-186">For cmdlets that perform an operation that modifies the system, they should call the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method to request confirmation, and in special cases call the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method.</span></span> <span data-ttu-id="998f8-187">( [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)後，才應該呼叫方法[System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)呼叫方法。)</span><span class="sxs-lookup"><span data-stu-id="998f8-187">(The [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method should be called only after the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method is called.)</span></span>

<span data-ttu-id="998f8-188">若要進行這些呼叫必須指定此 cmdlet，它支援確認要求，方法是設定`SupportsShouldProcess`Cmdlet 屬性的關鍵字。</span><span class="sxs-lookup"><span data-stu-id="998f8-188">To make these calls the cmdlet must specify that it supports confirmation requests by setting the `SupportsShouldProcess` keyword of the Cmdlet attribute.</span></span> <span data-ttu-id="998f8-189">如需有關設定此屬性的詳細資訊，請參閱 < [Cmdlet 屬性宣告](./cmdlet-attribute-declaration.md)。</span><span class="sxs-lookup"><span data-stu-id="998f8-189">For more information about setting this attribute, see [Cmdlet Attribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

> [!NOTE]
> <span data-ttu-id="998f8-190">如果在 cmdlet 類別的 Cmdlet 屬性指出此 cmdlet 支援呼叫[System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)方法，而此 cmdlet 也無法進行的呼叫[System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)方法，使用者可能意外地修改系統。</span><span class="sxs-lookup"><span data-stu-id="998f8-190">If the Cmdlet attribute of the cmdlet class indicates that the cmdlet supports calls to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method, and the cmdlet fails to make the call to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method, the user could modify the system unexpectedly.</span></span>

<span data-ttu-id="998f8-191">使用[System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)修改任何系統的方法。</span><span class="sxs-lookup"><span data-stu-id="998f8-191">Use the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method for any system modification.</span></span> <span data-ttu-id="998f8-192">使用者喜好設定並`WhatIf`參數控制[System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)方法。</span><span class="sxs-lookup"><span data-stu-id="998f8-192">A user preference and the `WhatIf` parameter control the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method.</span></span> <span data-ttu-id="998f8-193">相反地， [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)呼叫有潛在危險的修改執行額外的檢查。</span><span class="sxs-lookup"><span data-stu-id="998f8-193">In contrast, the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) call performs an additional check for potentially dangerous modifications.</span></span> <span data-ttu-id="998f8-194">這個方法不受任何使用者喜好設定或`WhatIf`參數。</span><span class="sxs-lookup"><span data-stu-id="998f8-194">This method is not controlled by any user preference or the `WhatIf` parameter.</span></span> <span data-ttu-id="998f8-195">如果您的指令程式會呼叫[System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)方法，它應該有`Force`參數略過這兩種方法的呼叫，並可繼續進行作業。</span><span class="sxs-lookup"><span data-stu-id="998f8-195">If your cmdlet calls the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method, it should have a `Force` parameter that bypasses the calls to these two methods and that proceeds with the operation.</span></span> <span data-ttu-id="998f8-196">這很重要，因為它可讓您使用非互動式指令碼和主機中的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="998f8-196">This is important because it allows your cmdlet to be used in non-interactive scripts and hosts.</span></span>

<span data-ttu-id="998f8-197">如果您的 cmdlet 會支援這些呼叫，使用者可以判斷是否應實際執行動作。</span><span class="sxs-lookup"><span data-stu-id="998f8-197">If your cmdlets support these calls, the user can determine whether the action should actually be performed.</span></span> <span data-ttu-id="998f8-198">例如， [Stop-process](/powershell/module/microsoft.powershell.management/stop-process) cmdlet 會呼叫[System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)方法之前停止的重要處理序，包括系統，而 Winlogon，一組和Spoolsv 程序。</span><span class="sxs-lookup"><span data-stu-id="998f8-198">For example, the [Stop-Process](/powershell/module/microsoft.powershell.management/stop-process) cmdlet calls the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method before it stops a set of critical processes, including the System, Winlogon, and Spoolsv processes.</span></span>

<span data-ttu-id="998f8-199">如需有關如何支援這些方法的詳細資訊，請參閱 <<c0> [ 要求確認](./requesting-confirmation-from-cmdlets.md)。</span><span class="sxs-lookup"><span data-stu-id="998f8-199">For more information about supporting these methods, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

### <a name="support-force-parameter-for-interactive-sessions-rd05"></a><span data-ttu-id="998f8-200">針對互動式工作階段 (RD05) 支援 Force 參數</span><span class="sxs-lookup"><span data-stu-id="998f8-200">Support Force Parameter for Interactive Sessions (RD05)</span></span>

<span data-ttu-id="998f8-201">如果以互動方式使用您的 cmdlet，則一律提供 Force 參數，來覆寫的互動式的動作，例如提示或讀取行的輸入）。</span><span class="sxs-lookup"><span data-stu-id="998f8-201">If your cmdlet is used interactively, always provide a Force parameter to override the interactive actions, such as prompts or reading lines of input).</span></span> <span data-ttu-id="998f8-202">這很重要，因為它可讓您使用非互動式指令碼和主機中的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="998f8-202">This is important because it allows your cmdlet to be used in non-interactive scripts and hosts.</span></span> <span data-ttu-id="998f8-203">互動式的主機，可以實作下列方法。</span><span class="sxs-lookup"><span data-stu-id="998f8-203">The following methods can be implemented by an interactive host.</span></span>

- [<span data-ttu-id="998f8-204">System.Management.Automation.Host.PSHostUserInterface.Prompt\*</span><span class="sxs-lookup"><span data-stu-id="998f8-204">System.Management.Automation.Host.PSHostUserInterface.Prompt\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.Prompt)

- [<span data-ttu-id="998f8-205">System.Management.Automation.Host.Pshostuserinterface.PromptForChoice</span><span class="sxs-lookup"><span data-stu-id="998f8-205">System.Management.Automation.Host.Pshostuserinterface.PromptForChoice</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.PromptForChoice)

- [<span data-ttu-id="998f8-206">System.Management.Automation.Host.Ihostuisupportsmultiplechoiceselection.PromptForChoice</span><span class="sxs-lookup"><span data-stu-id="998f8-206">System.Management.Automation.Host.Ihostuisupportsmultiplechoiceselection.PromptForChoice</span></span>](/dotnet/api/System.Management.Automation.Host.IHostUISupportsMultipleChoiceSelection.PromptForChoice)

- [<span data-ttu-id="998f8-207">System.Management.Automation.Host.Pshostuserinterface.PromptForCredential\*</span><span class="sxs-lookup"><span data-stu-id="998f8-207">System.Management.Automation.Host.Pshostuserinterface.PromptForCredential\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.PromptForCredential)

- [<span data-ttu-id="998f8-208">System.Management.Automation.Host.Pshostuserinterface.ReadLine\*</span><span class="sxs-lookup"><span data-stu-id="998f8-208">System.Management.Automation.Host.Pshostuserinterface.ReadLine\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.ReadLine)

- [<span data-ttu-id="998f8-209">System.Management.Automation.Host.Pshostuserinterface.ReadLineAsSecureString\*</span><span class="sxs-lookup"><span data-stu-id="998f8-209">System.Management.Automation.Host.Pshostuserinterface.ReadLineAsSecureString\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.ReadLineAsSecureString)

### <a name="document-output-objects-rd06"></a><span data-ttu-id="998f8-210">文件輸出物件 (RD06)</span><span class="sxs-lookup"><span data-stu-id="998f8-210">Document Output Objects (RD06)</span></span>

<span data-ttu-id="998f8-211">Windows PowerShell 會使用寫入到管線的物件。</span><span class="sxs-lookup"><span data-stu-id="998f8-211">Windows PowerShell uses the objects that are written to the pipeline.</span></span> <span data-ttu-id="998f8-212">為了讓使用者充分利用每個 cmdlet 所傳回的物件，您必須文件所傳回的物件和這些傳回的物件成員的用途為何，您必須記錄。</span><span class="sxs-lookup"><span data-stu-id="998f8-212">In order for users to take advantage of the objects that are returned by each cmdlet, you must document the objects that are returned, and you must document what the members of those returned objects are used for.</span></span>

## <a name="code-guidelines"></a><span data-ttu-id="998f8-213">程式碼的指導方針</span><span class="sxs-lookup"><span data-stu-id="998f8-213">Code Guidelines</span></span>

<span data-ttu-id="998f8-214">撰寫 cmdlet 程式碼時，必須遵循下列指導方針。</span><span class="sxs-lookup"><span data-stu-id="998f8-214">The following guidelines must be followed when writing cmdlet code.</span></span> <span data-ttu-id="998f8-215">當您找到適用於您情況的程式碼指導方針時，請務必查看類似的指導方針的設計方針。</span><span class="sxs-lookup"><span data-stu-id="998f8-215">When you find a Code guideline that applies to your situation, be sure to look at the Design guidelines for similar guidelines.</span></span>

### <a name="derive-from-the-cmdlet-or-pscmdlet-classes-rc01"></a><span data-ttu-id="998f8-216">衍生自的 Cmdlet 或 PSCmdlet 類別 (RC01)</span><span class="sxs-lookup"><span data-stu-id="998f8-216">Derive from the Cmdlet or PSCmdlet Classes (RC01)</span></span>

<span data-ttu-id="998f8-217">Cmdlet 必須衍生自[System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet)或是[System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet)基底類別。</span><span class="sxs-lookup"><span data-stu-id="998f8-217">A cmdlet must derive from either the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) or [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) base class.</span></span> <span data-ttu-id="998f8-218">從衍生的 Cmdlet [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet)類別不會依賴 Windows PowerShell 執行階段。</span><span class="sxs-lookup"><span data-stu-id="998f8-218">Cmdlets that derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class do not depend on the Windows PowerShell runtime.</span></span> <span data-ttu-id="998f8-219">它們可以直接從任何 Microsoft.NET Framework 語言呼叫。</span><span class="sxs-lookup"><span data-stu-id="998f8-219">They can be called directly from any Microsoft .NET Framework language.</span></span> <span data-ttu-id="998f8-220">從衍生的 Cmdlet [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet)類別取決於 Windows PowerShell 執行階段。</span><span class="sxs-lookup"><span data-stu-id="998f8-220">Cmdlets that derive from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class depend on the Windows PowerShell runtime.</span></span> <span data-ttu-id="998f8-221">因此，它們的 runspace 內執行。</span><span class="sxs-lookup"><span data-stu-id="998f8-221">Therefore, they execute within a runspace.</span></span>

<span data-ttu-id="998f8-222">您實作的所有 cmdlet 類別必須都是公用類別。</span><span class="sxs-lookup"><span data-stu-id="998f8-222">All cmdlet classes that you implement must be public classes.</span></span> <span data-ttu-id="998f8-223">如需有關這些 cmdlet 類別的詳細資訊，請參閱 <<c0> [ 指令程式概觀](./cmdlet-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="998f8-223">For more information about these cmdlet classes, see [Cmdlet Overview](./cmdlet-overview.md).</span></span>

### <a name="specify-the-cmdlet-attribute-rc02"></a><span data-ttu-id="998f8-224">指定 Cmdlet 屬性 (RC02)</span><span class="sxs-lookup"><span data-stu-id="998f8-224">Specify the Cmdlet Attribute (RC02)</span></span>

<span data-ttu-id="998f8-225">可辨識的 Windows PowerShell 的 cmdlet，為其.NET Framework 類別必須使用 Cmdlet 屬性裝飾。</span><span class="sxs-lookup"><span data-stu-id="998f8-225">For a cmdlet to be recognized by Windows PowerShell, its .NET Framework class must be decorated with the Cmdlet attribute.</span></span> <span data-ttu-id="998f8-226">這個屬性會指定此 cmdlet 的下列功能。</span><span class="sxs-lookup"><span data-stu-id="998f8-226">This attribute specifies the following features of the cmdlet.</span></span>

- <span data-ttu-id="998f8-227">識別 cmdlet 動詞和名詞 」 組。</span><span class="sxs-lookup"><span data-stu-id="998f8-227">The verb-and-noun pair that identifies the cmdlet.</span></span>

- <span data-ttu-id="998f8-228">指定多個參數集時，會使用預設參數集。</span><span class="sxs-lookup"><span data-stu-id="998f8-228">The default parameter set that is used when multiple parameter sets are specified.</span></span> <span data-ttu-id="998f8-229">Windows PowerShell 沒有足夠的資訊，以判斷哪一個參數設定為使用時，會使用預設參數集。</span><span class="sxs-lookup"><span data-stu-id="998f8-229">The default parameter set is used when Windows PowerShell does not have enough information to determine which parameter set to use.</span></span>

- <span data-ttu-id="998f8-230">指出此 cmdlet 是否支援對[System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)方法。</span><span class="sxs-lookup"><span data-stu-id="998f8-230">Indicates if the cmdlet supports calls to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method.</span></span> <span data-ttu-id="998f8-231">此 cmdlet 會在系統中進行變更之前，此方法會顯示確認訊息給使用者。</span><span class="sxs-lookup"><span data-stu-id="998f8-231">This method displays a confirmation message to the user before the cmdlet makes a change to the system.</span></span> <span data-ttu-id="998f8-232">如需有關如何進行確認要求的詳細資訊，請參閱 <<c0> [ 要求確認](./requesting-confirmation-from-cmdlets.md)。</span><span class="sxs-lookup"><span data-stu-id="998f8-232">For more information about how confirmation requests are made, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

- <span data-ttu-id="998f8-233">表示影響層級 （或嚴重性），並確認訊息相關聯的動作。</span><span class="sxs-lookup"><span data-stu-id="998f8-233">Indicate the impact level (or severity) of the action associated with the confirmation message.</span></span> <span data-ttu-id="998f8-234">在大部分情況下，應該使用中的預設值。</span><span class="sxs-lookup"><span data-stu-id="998f8-234">In most cases, the default value of Medium should be used.</span></span> <span data-ttu-id="998f8-235">如需有關如何影響層級會影響顯示給使用者確認要求的詳細資訊，請參閱[要求確認](./requesting-confirmation-from-cmdlets.md)。</span><span class="sxs-lookup"><span data-stu-id="998f8-235">For more information about how the impact level affects the confirmation requests that are displayed to the user, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

<span data-ttu-id="998f8-236">如需如何宣告 cmdlet 屬性的詳細資訊，請參閱[CmdletAttribute 宣告](./cmdlet-attribute-declaration.md)。</span><span class="sxs-lookup"><span data-stu-id="998f8-236">For more information about how to declare the cmdlet attribute, see [CmdletAttribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

### <a name="override-an-input-processing-method-rc03"></a><span data-ttu-id="998f8-237">覆寫輸入處理方法 (RC03)</span><span class="sxs-lookup"><span data-stu-id="998f8-237">Override an Input Processing Method (RC03)</span></span>

<span data-ttu-id="998f8-238">針對在 Windows PowerShell 環境中參與 cmdlet，必須覆寫至少下列其中之一*輸入處理方法*。</span><span class="sxs-lookup"><span data-stu-id="998f8-238">For the cmdlet to participate in the Windows PowerShell environment, it must override at least one of the following *input processing methods*.</span></span>

<span data-ttu-id="998f8-239">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing)這個方法會呼叫一次，並用來提供前置處理的功能。</span><span class="sxs-lookup"><span data-stu-id="998f8-239">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) This method is called one time, and it is used to provide pre-processing functionality.</span></span>

<span data-ttu-id="998f8-240">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord)多次，會呼叫這個方法，它用來提供記錄的記錄功能。</span><span class="sxs-lookup"><span data-stu-id="998f8-240">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) This method is called multiple times, and it is used to provide record-by-record functionality.</span></span>

<span data-ttu-id="998f8-241">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing)這個方法會呼叫一次，並用來提供後置處理的功能。</span><span class="sxs-lookup"><span data-stu-id="998f8-241">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) This method is called one time, and it is used to provide post-processing functionality.</span></span>

### <a name="specify-the-outputtype-attribute-rc04"></a><span data-ttu-id="998f8-242">指定 OutputType 屬性 (RC04)</span><span class="sxs-lookup"><span data-stu-id="998f8-242">Specify the OutputType Attribute (RC04)</span></span>

<span data-ttu-id="998f8-243">（在 Windows PowerShell 2.0 引進） 的 OutputType 屬性會指定您的 cmdlet 會傳回管線的.NET Framework 類型。</span><span class="sxs-lookup"><span data-stu-id="998f8-243">The OutputType attribute (introduced in Windows PowerShell 2.0) specifies the .NET Framework type that your cmdlet returns to the pipeline.</span></span> <span data-ttu-id="998f8-244">藉由指定 cmdlet 的輸出型別，您會使 cmdlet 所傳回您更容易找到其他指令程式的物件。</span><span class="sxs-lookup"><span data-stu-id="998f8-244">By specifying the output type of your cmdlets you make the objects returned by your cmdlet more discoverable by other cmdlets.</span></span> <span data-ttu-id="998f8-245">如需裝飾具有此屬性在 cmdlet 類別的詳細資訊，請參閱[OutputType 屬性宣告](./outputtype-attribute-declaration.md)。</span><span class="sxs-lookup"><span data-stu-id="998f8-245">For more information about decorating the cmdlet class with this attribute, see [OutputType Attribute Declaration](./outputtype-attribute-declaration.md).</span></span>

### <a name="do-not-retain-handles-to-output-objects-rc05"></a><span data-ttu-id="998f8-246">不會保留輸出物件 (RC05) 的控制代碼</span><span class="sxs-lookup"><span data-stu-id="998f8-246">Do Not Retain Handles to Output Objects (RC05)</span></span>

<span data-ttu-id="998f8-247">您的 cmdlet 應該不會保留任何傳遞給物件的控制代碼[System.Management.Automation.Cmdlet.WriteObject\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject)方法。</span><span class="sxs-lookup"><span data-stu-id="998f8-247">Your cmdlet should not retain any handles to the objects that are passed to the [System.Management.Automation.Cmdlet.WriteObject\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method.</span></span> <span data-ttu-id="998f8-248">這些物件會傳遞至管線中下一個 cmdlet 或指令碼使用它們。</span><span class="sxs-lookup"><span data-stu-id="998f8-248">These objects are passed to the next cmdlet in the pipeline, or they are used by a script.</span></span> <span data-ttu-id="998f8-249">如果您保留物件的控制代碼，兩個實體會擁有每個物件，即會發生錯誤。</span><span class="sxs-lookup"><span data-stu-id="998f8-249">If you retain the handles to the objects, two entities will own each object, which causes errors.</span></span>

### <a name="handle-errors-robustly-rc06"></a><span data-ttu-id="998f8-250">穩固處理錯誤 (RC06)</span><span class="sxs-lookup"><span data-stu-id="998f8-250">Handle Errors Robustly (RC06)</span></span>

<span data-ttu-id="998f8-251">管理環境原本就會偵測，並對您管理系統的重要變更。</span><span class="sxs-lookup"><span data-stu-id="998f8-251">An administration environment inherently detects and makes important changes to the system that you are administering.</span></span> <span data-ttu-id="998f8-252">因此，務必指令程式會正確地處理錯誤。</span><span class="sxs-lookup"><span data-stu-id="998f8-252">Therefore, it is vital that cmdlets handle errors correctly.</span></span> <span data-ttu-id="998f8-253">如需詳細的錯誤記錄的詳細資訊，請參閱[Windows PowerShell 錯誤報告](./error-reporting-concepts.md)。</span><span class="sxs-lookup"><span data-stu-id="998f8-253">For more information about error records, see [Windows PowerShell Error Reporting](./error-reporting-concepts.md).</span></span>

- <span data-ttu-id="998f8-254">錯誤會導致無法繼續處理任何多筆記錄的 cmdlet，時，終止錯誤。</span><span class="sxs-lookup"><span data-stu-id="998f8-254">When an error prevents a cmdlet from continuing to process any more records, it is a terminating error.</span></span> <span data-ttu-id="998f8-255">此指令程式必須呼叫[System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)所參考方法[System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)物件。</span><span class="sxs-lookup"><span data-stu-id="998f8-255">The cmdlet must call the [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) method that references an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="998f8-256">如果不 cmdlet 所攔截到例外狀況，Windows PowerShell 執行階段本身會擲回終止錯誤，其中包含較少的資訊。</span><span class="sxs-lookup"><span data-stu-id="998f8-256">If an exception is not caught by the cmdlet, the Windows PowerShell runtime itself throws a terminating error that contains less information.</span></span>

- <span data-ttu-id="998f8-257">不會停止在下一次作業的非終止錯誤來自管線 （例如，a 記錄不同的程序所產生的），此指令程式的記錄必須呼叫[System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)所參考方法[System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)物件。</span><span class="sxs-lookup"><span data-stu-id="998f8-257">For a non-terminating error that does not stop operation on the next record that is coming from the pipeline (for example, a record produced by a different process), the cmdlet must call the [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method that references an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="998f8-258">非終止錯誤的範例是特定的處理程序無法停止時，就會發生此錯誤。</span><span class="sxs-lookup"><span data-stu-id="998f8-258">An example of a non-terminating error is the error that occurs if a particular process fails to stop.</span></span> <span data-ttu-id="998f8-259">呼叫[System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)方法可讓使用者以一致的方式執行要求的動作，並保留失敗的特定動作的資訊。</span><span class="sxs-lookup"><span data-stu-id="998f8-259">Calling the [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method allows the user to consistently perform the actions requested and to retain the information for particular actions that fail.</span></span> <span data-ttu-id="998f8-260">您的 cmdlet 應該盡可能獨立處理每一筆記錄。</span><span class="sxs-lookup"><span data-stu-id="998f8-260">Your cmdlet should handle each record as independently as possible.</span></span>

- <span data-ttu-id="998f8-261">[System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)所參考的物件[System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)和[System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)方法需要在本質上發生例外狀況。</span><span class="sxs-lookup"><span data-stu-id="998f8-261">The [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object that is referenced by the [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) and [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) methods requires an exception at its core.</span></span> <span data-ttu-id="998f8-262">當您決定要使用的例外狀況時，請遵循.NET Framework 設計方針。</span><span class="sxs-lookup"><span data-stu-id="998f8-262">Follow the .NET Framework design guidelines when you determine the exception to use.</span></span> <span data-ttu-id="998f8-263">如果錯誤在語意上是相同的現有的例外狀況，會使用該例外狀況，或衍生自該例外狀況。</span><span class="sxs-lookup"><span data-stu-id="998f8-263">If the error is semantically the same as an existing exception, use that exception or derive from that exception.</span></span> <span data-ttu-id="998f8-264">否則，衍生新的例外狀況或例外狀況階層架構，直接從[System.Exception](/dotnet/api/System.Exception)型別。</span><span class="sxs-lookup"><span data-stu-id="998f8-264">Otherwise, derive a new exception or exception hierarchy directly from the [System.Exception](/dotnet/api/System.Exception) type.</span></span>

<span data-ttu-id="998f8-265">[System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)物件也會要求群組的使用者錯誤的錯誤分類。</span><span class="sxs-lookup"><span data-stu-id="998f8-265">An [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object also requires an error category that groups errors for the user.</span></span> <span data-ttu-id="998f8-266">使用者可以檢視所設定的值根據分類錯誤`$ErrorView`CategoryView 到殼層變數。</span><span class="sxs-lookup"><span data-stu-id="998f8-266">The user can view errors based on the category by setting the value of the `$ErrorView` shell variable to CategoryView.</span></span> <span data-ttu-id="998f8-267">可能的類別由[System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory)列舉型別。</span><span class="sxs-lookup"><span data-stu-id="998f8-267">The possible categories are defined by the [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory) enumeration.</span></span>

- <span data-ttu-id="998f8-268">如果 cmdlet 會建立新的執行緒，而且在該執行緒中執行的程式碼會擲回未處理的例外狀況，Windows PowerShell 不會攔截錯誤，並將會終止處理序。</span><span class="sxs-lookup"><span data-stu-id="998f8-268">If a cmdlet creates a new thread, and if the code that is running in that thread throws an unhandled exception, Windows PowerShell will not catch the error and will terminate the process.</span></span>

- <span data-ttu-id="998f8-269">如果物件有其解構函式會造成未處理的例外狀況的程式碼，Windows PowerShell 不會攔截錯誤，並將會終止處理序。</span><span class="sxs-lookup"><span data-stu-id="998f8-269">If an object has code in its destructor that causes an unhandled exception, Windows PowerShell will not catch the error and will terminate the process.</span></span> <span data-ttu-id="998f8-270">如果物件呼叫 Dispose 方法，會造成未處理的例外狀況，這也會發生。</span><span class="sxs-lookup"><span data-stu-id="998f8-270">This also occurs if an object calls Dispose methods that cause an unhandled exception.</span></span>

### <a name="use-a-windows-powershell-module-to-deploy-your-cmdlets-rc07"></a><span data-ttu-id="998f8-271">使用 Windows PowerShell 模組來部署您的 Cmdlet (RC07)</span><span class="sxs-lookup"><span data-stu-id="998f8-271">Use a Windows PowerShell Module to Deploy your Cmdlets (RC07)</span></span>

<span data-ttu-id="998f8-272">建立 Windows PowerShell 模組來封裝及部署您的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="998f8-272">Create a Windows PowerShell module to package and deploy your cmdlets.</span></span> <span data-ttu-id="998f8-273">模組的支援是在 Windows PowerShell 2.0 引進。</span><span class="sxs-lookup"><span data-stu-id="998f8-273">Support for modules is introduced in Windows PowerShell 2.0.</span></span> <span data-ttu-id="998f8-274">您可以使用直接二進位模組檔案 （這是很有幫助測試您的 cmdlet 時），以包含 cmdlet 類別的組件，或者您可以建立模組資訊清單所參考的指令程式組件。</span><span class="sxs-lookup"><span data-stu-id="998f8-274">You can use the assemblies that contain your cmdlet classes directly as binary module files (this is very useful when testing your cmdlets), or you can create a module manifest that references the cmdlet assemblies.</span></span> <span data-ttu-id="998f8-275">（您也可以新增現有的嵌入式管理單元組件時使用的模組。）如需有關模組的詳細資訊，請參閱 <<c0> [ 撰寫 Windows PowerShell 模組](../module/writing-a-windows-powershell-module.md)。</span><span class="sxs-lookup"><span data-stu-id="998f8-275">(You can also add existing snap-in assemblies when using modules.) For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="998f8-276">另請參閱</span><span class="sxs-lookup"><span data-stu-id="998f8-276">See Also</span></span>

[<span data-ttu-id="998f8-277">極力建議您的開發指導方針</span><span class="sxs-lookup"><span data-stu-id="998f8-277">Strongly Encouraged Development Guidelines</span></span>](./strongly-encouraged-development-guidelines.md)

[<span data-ttu-id="998f8-278">諮詢開發指導方針</span><span class="sxs-lookup"><span data-stu-id="998f8-278">Advisory Development Guidelines</span></span>](./advisory-development-guidelines.md)

[<span data-ttu-id="998f8-279">撰寫 Windows PowerShell Cmdlet</span><span class="sxs-lookup"><span data-stu-id="998f8-279">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)
