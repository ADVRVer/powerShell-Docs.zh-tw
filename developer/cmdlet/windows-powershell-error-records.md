---
title: Windows PowerShell 錯誤會記錄 |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- error category [PowerShell SDK]
- error identifier [PowerShell SDK]
- error records [PowerShell SDK]
- error category string [PowerShell SDK]
ms.assetid: bdd66fea-eb63-4bb6-9cbe-9a799e5e0db5
caps.latest.revision: 9
ms.openlocfilehash: 5412d88b690a1f5f1ef387416e3bf9da3a32c95d
ms.sourcegitcommit: 46bebe692689ebedfe65ff2c828fe666b443198d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/10/2019
ms.locfileid: "67735071"
---
# <a name="windows-powershell-error-records"></a><span data-ttu-id="03ccd-102">Windows PowerShell 錯誤記錄</span><span class="sxs-lookup"><span data-stu-id="03ccd-102">Windows PowerShell Error Records</span></span>

<span data-ttu-id="03ccd-103">指令程式必須通過[System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)可識別終止和非終止錯誤的錯誤條件物件。</span><span class="sxs-lookup"><span data-stu-id="03ccd-103">Cmdlets must pass an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object that identifies the error condition for terminating and non-terminating errors.</span></span>

<span data-ttu-id="03ccd-104">[System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)物件包含下列資訊：</span><span class="sxs-lookup"><span data-stu-id="03ccd-104">The [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object contains the following information:</span></span>

- <span data-ttu-id="03ccd-105">描述錯誤的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="03ccd-105">The exception that describes the error.</span></span> <span data-ttu-id="03ccd-106">通常，這是此 cmdlet 會攔截到並轉換成錯誤記錄的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="03ccd-106">Often, this is an exception that the cmdlet caught and converted into an error record.</span></span> <span data-ttu-id="03ccd-107">每個錯誤記錄必須包含例外狀況。</span><span class="sxs-lookup"><span data-stu-id="03ccd-107">Every error record must contain an exception.</span></span>

<span data-ttu-id="03ccd-108">如果此 cmdlet 未攔截例外狀況，它必須建立新的例外狀況，並選擇最符合錯誤狀況的例外狀況類別。</span><span class="sxs-lookup"><span data-stu-id="03ccd-108">If the cmdlet did not catch an exception, it must create a new exception and choose the exception class that best describes the error condition.</span></span> <span data-ttu-id="03ccd-109">不過，您不需要擲回例外狀況，因為它可以透過存取[System.Management.Automation.ErrorRecord.Exception](/dotnet/api/System.Management.Automation.ErrorRecord.Exception)屬性[System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)物件。</span><span class="sxs-lookup"><span data-stu-id="03ccd-109">However, you do not need to throw the exception because it can be accessed through the [System.Management.Automation.ErrorRecord.Exception](/dotnet/api/System.Management.Automation.ErrorRecord.Exception) property of the [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span>

- <span data-ttu-id="03ccd-110">提供可用來進行診斷及 Windows PowerShell 指令碼以處理特定錯誤條件，以特定的錯誤處理常式的目標指示項的錯誤識別碼。</span><span class="sxs-lookup"><span data-stu-id="03ccd-110">An error identifier that provides a targeted designator that can be used for diagnostic purposes and by Windows PowerShell scripts to handle specific error conditions with specific error handlers.</span></span> <span data-ttu-id="03ccd-111">每個錯誤記錄必須包含錯誤識別項 （請參閱錯誤識別項）。</span><span class="sxs-lookup"><span data-stu-id="03ccd-111">Every error record must contain an error identifier (see Error Identifier).</span></span>

- <span data-ttu-id="03ccd-112">提供可用於診斷用途的一般指示項的錯誤分類。</span><span class="sxs-lookup"><span data-stu-id="03ccd-112">An error category that provides a general designator that can be used for diagnostic purposes.</span></span> <span data-ttu-id="03ccd-113">每個錯誤記錄必須指定的錯誤分類 （請參閱錯誤類別目錄）。</span><span class="sxs-lookup"><span data-stu-id="03ccd-113">Every error record must specify an error category (see Error Category).</span></span>

- <span data-ttu-id="03ccd-114">選擇性取代錯誤訊息和建議的動作 （請參閱補充錯誤訊息）。</span><span class="sxs-lookup"><span data-stu-id="03ccd-114">An optional replacement error message and a recommended action (see Replacement Error Message).</span></span>

- <span data-ttu-id="03ccd-115">選擇性的引動過程會擲回錯誤 cmdlet 資訊。</span><span class="sxs-lookup"><span data-stu-id="03ccd-115">Optional invocation information about the cmdlet that threw the error.</span></span> <span data-ttu-id="03ccd-116">這項資訊由 Windows PowerShell （請參閱叫用訊息）。</span><span class="sxs-lookup"><span data-stu-id="03ccd-116">This information is specified by Windows PowerShell (see Invocation Message).</span></span>

- <span data-ttu-id="03ccd-117">發生錯誤時正在處理的目標物件。</span><span class="sxs-lookup"><span data-stu-id="03ccd-117">The target object that was being processed when the error occurred.</span></span> <span data-ttu-id="03ccd-118">這可能是輸入的物件，或可能是您的 cmdlet 所處理的另一個物件。</span><span class="sxs-lookup"><span data-stu-id="03ccd-118">This might be the input object, or it might be another object that your cmdlet was processing.</span></span> <span data-ttu-id="03ccd-119">例如，對於命令`remove-item -recurse c:\somedirectory`，錯誤可能是"c:\somedirectory\lockedfile 」 的 FileInfo 物件的執行個體。</span><span class="sxs-lookup"><span data-stu-id="03ccd-119">For example, for the command `remove-item -recurse c:\somedirectory`, the error might be an instance of a FileInfo object for "c:\somedirectory\lockedfile".</span></span> <span data-ttu-id="03ccd-120">目標物件的資訊是選擇性的。</span><span class="sxs-lookup"><span data-stu-id="03ccd-120">The target object information is optional.</span></span>

## <a name="error-identifier"></a><span data-ttu-id="03ccd-121">錯誤識別碼</span><span class="sxs-lookup"><span data-stu-id="03ccd-121">Error Identifier</span></span>

<span data-ttu-id="03ccd-122">當您建立錯誤記錄時，指定識別項，指定您 cmdlet 中的錯誤狀況。</span><span class="sxs-lookup"><span data-stu-id="03ccd-122">When you create an error record, specify an identifier that designates the error condition within your cmdlet.</span></span> <span data-ttu-id="03ccd-123">Windows PowerShell 會將目標的識別碼結合您 cmdlet 來建立完整的錯誤識別項的名稱。</span><span class="sxs-lookup"><span data-stu-id="03ccd-123">Windows PowerShell combines the targeted identifier with the name of your cmdlet to create a fully qualified error identifier.</span></span> <span data-ttu-id="03ccd-124">您可以透過完整的錯誤識別碼[System.Management.Automation.ErrorRecord.FullyQualifiedErrorId](/dotnet/api/System.Management.Automation.ErrorRecord.FullyQualifiedErrorId)屬性[System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)物件。</span><span class="sxs-lookup"><span data-stu-id="03ccd-124">The fully qualified error identifier can be accessed through the [System.Management.Automation.ErrorRecord.FullyQualifiedErrorId](/dotnet/api/System.Management.Automation.ErrorRecord.FullyQualifiedErrorId) property of the [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="03ccd-125">錯誤識別碼不是使用本身中。</span><span class="sxs-lookup"><span data-stu-id="03ccd-125">The error identifier is not available by itself.</span></span> <span data-ttu-id="03ccd-126">它位於只為一部分的完整格式的錯誤識別碼。</span><span class="sxs-lookup"><span data-stu-id="03ccd-126">It is available only as part of the fully qualified error identifier.</span></span>

<span data-ttu-id="03ccd-127">使用下列指導方針，當您建立錯誤記錄時產生錯誤識別碼：</span><span class="sxs-lookup"><span data-stu-id="03ccd-127">Use the following guidelines to generate error identifiers when you create error records:</span></span>

- <span data-ttu-id="03ccd-128">對錯誤狀況特定錯誤的識別碼。</span><span class="sxs-lookup"><span data-stu-id="03ccd-128">Make error identifiers specific to an error condition.</span></span> <span data-ttu-id="03ccd-129">進行診斷，並處理以特定的錯誤處理常式的特定錯誤狀況的指令碼為目標的錯誤識別碼。</span><span class="sxs-lookup"><span data-stu-id="03ccd-129">Target the error identifiers for diagnostic purposes and for scripts that handle specific error conditions with specific error handlers.</span></span> <span data-ttu-id="03ccd-130">使用者應該能夠使用錯誤識別碼，以找出錯誤和其來源。</span><span class="sxs-lookup"><span data-stu-id="03ccd-130">A user should be able to use the error identifier to identify the error and its source.</span></span> <span data-ttu-id="03ccd-131">錯誤識別碼也會啟用，因此不需要新的例外狀況子類別，從現有的例外狀況的特定錯誤狀況的報告。</span><span class="sxs-lookup"><span data-stu-id="03ccd-131">Error identifiers also enable reporting for specific error conditions from existing exceptions so that new exception subclasses are not required.</span></span>

- <span data-ttu-id="03ccd-132">一般情況下，將不同的錯誤識別碼指派給不同的程式碼路徑中。</span><span class="sxs-lookup"><span data-stu-id="03ccd-132">In general, assign different error identifiers to different code paths.</span></span> <span data-ttu-id="03ccd-133">而使用者也會從特定的識別項。</span><span class="sxs-lookup"><span data-stu-id="03ccd-133">The end-user benefits from specific identifiers.</span></span> <span data-ttu-id="03ccd-134">通常，每個呼叫的程式碼路徑[System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)或是[System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)有它自己的識別碼。</span><span class="sxs-lookup"><span data-stu-id="03ccd-134">Often, each code path that calls [System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) or [System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) has its own identifier.</span></span> <span data-ttu-id="03ccd-135">因此，請定義新的識別碼，當您定義新的範本字串，如錯誤訊息，反之亦然。</span><span class="sxs-lookup"><span data-stu-id="03ccd-135">As a rule, define a new identifier when you define a new template string for the error message, and vice-versa.</span></span> <span data-ttu-id="03ccd-136">請勿使用做為識別項的錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="03ccd-136">Do not use the error message as an identifier.</span></span>

- <span data-ttu-id="03ccd-137">當您發行程式碼使用特定的錯誤識別碼時，您建立的語意錯誤與該識別項，為您完成的產品支援生命週期。</span><span class="sxs-lookup"><span data-stu-id="03ccd-137">When you publish code using a particular error identifier, you establish the semantics of errors with that identifier for your complete product support lifecycle.</span></span> <span data-ttu-id="03ccd-138">不重複使用它在語意不同於原始內容的內容中。</span><span class="sxs-lookup"><span data-stu-id="03ccd-138">Do not reuse it in a context that is semantically different from the original context.</span></span> <span data-ttu-id="03ccd-139">如果此錯誤的語意變更，請建立，然後使用 新的識別碼。</span><span class="sxs-lookup"><span data-stu-id="03ccd-139">If the semantics of this error change, create and then use a new identifier.</span></span>

- <span data-ttu-id="03ccd-140">您通常應該使用特定的錯誤識別碼，只針對特定的 CLR 類型的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="03ccd-140">You should generally use a particular error identifier only for exceptions of a particular CLR type.</span></span> <span data-ttu-id="03ccd-141">如果例外狀況類型或目標物件的類型變更時，建立，然後使用 新的識別碼。</span><span class="sxs-lookup"><span data-stu-id="03ccd-141">If the type of the exception or the type of the target object changes, create and then use a new identifier.</span></span>

- <span data-ttu-id="03ccd-142">選擇您的錯誤識別碼精確對應至您所回報的錯誤文字。</span><span class="sxs-lookup"><span data-stu-id="03ccd-142">Choose text for your error identifier that concisely corresponds to the error that you are reporting.</span></span> <span data-ttu-id="03ccd-143">使用標準的.NET Framework 名稱和大小寫慣例。</span><span class="sxs-lookup"><span data-stu-id="03ccd-143">Use standard .NET Framework naming and capitalization conventions.</span></span> <span data-ttu-id="03ccd-144">請勿使用空格或標點符號。</span><span class="sxs-lookup"><span data-stu-id="03ccd-144">Do not use white space or punctuation.</span></span> <span data-ttu-id="03ccd-145">未當地語系化識別碼時發生錯誤。</span><span class="sxs-lookup"><span data-stu-id="03ccd-145">Do not localize error identifiers.</span></span>

- <span data-ttu-id="03ccd-146">不要以動態方式產生錯誤識別碼無法重現的方式。</span><span class="sxs-lookup"><span data-stu-id="03ccd-146">Do not dynamically generate error identifiers in a non-reproducible way.</span></span> <span data-ttu-id="03ccd-147">比方說，不會包含錯誤的資訊，例如處理序識別碼。</span><span class="sxs-lookup"><span data-stu-id="03ccd-147">For example, do not incorporate error information such as a process ID.</span></span> <span data-ttu-id="03ccd-148">錯誤識別碼是由遇到相同的錯誤狀況的其他使用者看到的錯誤識別碼與對應時，才適用。</span><span class="sxs-lookup"><span data-stu-id="03ccd-148">Error identifiers are useful only if they correspond to the error identifiers seen by other users who are experiencing the same error condition.</span></span>

## <a name="error-category"></a><span data-ttu-id="03ccd-149">錯誤類別目錄</span><span class="sxs-lookup"><span data-stu-id="03ccd-149">Error Category</span></span>

<span data-ttu-id="03ccd-150">當您建立錯誤記錄時，指定使用其中一個常數所定義的錯誤類別目錄[System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0)列舉型別。</span><span class="sxs-lookup"><span data-stu-id="03ccd-150">When you create an error record, specify the category of the error using one of the constants defined by the [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0) enumeration.</span></span> <span data-ttu-id="03ccd-151">Windows PowerShell 使用的錯誤類別來顯示資訊時發生錯誤，當使用者設定`$ErrorView`變數設為`"CategoryView"`。</span><span class="sxs-lookup"><span data-stu-id="03ccd-151">Windows PowerShell uses the error category to display error information when users set the `$ErrorView` variable to `"CategoryView"`.</span></span>

<span data-ttu-id="03ccd-152">請避免使用[System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0) **NotSpecified**常數。</span><span class="sxs-lookup"><span data-stu-id="03ccd-152">Avoid using the [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0) **NotSpecified** constant.</span></span> <span data-ttu-id="03ccd-153">如果您有任何資訊或造成錯誤的作業相關的錯誤，選擇最能描述錯誤或作業類別目錄，即使此分類不是個完美組合。</span><span class="sxs-lookup"><span data-stu-id="03ccd-153">If you have any information about the error or about the operation that caused the error, choose the category that best describes the error or the operation, even if the category is not a perfect match.</span></span>

<span data-ttu-id="03ccd-154">Windows PowerShell 所顯示的資訊稱為 「 類別目錄檢視的字串，並建置屬性的[System.Management.Automation.Errorcategoryinfo](/dotnet/api/System.Management.Automation.ErrorCategoryInfo)類別。</span><span class="sxs-lookup"><span data-stu-id="03ccd-154">The information displayed by Windows PowerShell is referred to as the category-view string and is built from the properties of the [System.Management.Automation.Errorcategoryinfo](/dotnet/api/System.Management.Automation.ErrorCategoryInfo) class.</span></span> <span data-ttu-id="03ccd-155">(這個類別經由錯誤[System.Management.Automation.ErrorRecord.CategoryInfo](/dotnet/api/System.Management.Automation.ErrorRecord.CategoryInfo)屬性。)</span><span class="sxs-lookup"><span data-stu-id="03ccd-155">(This class is accessed through the error [System.Management.Automation.ErrorRecord.CategoryInfo](/dotnet/api/System.Management.Automation.ErrorRecord.CategoryInfo) property.)</span></span>

```
{Category}: ({TargetName}:{TargetType}):[{Activity}], {Reason}
```

<span data-ttu-id="03ccd-156">下列清單描述所顯示的資訊：</span><span class="sxs-lookup"><span data-stu-id="03ccd-156">The following list describes the information displayed:</span></span>

- <span data-ttu-id="03ccd-157">類別：Windows PowerShell 定義[System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0)常數。</span><span class="sxs-lookup"><span data-stu-id="03ccd-157">Category: A Windows PowerShell-defined [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0) constant.</span></span>

- <span data-ttu-id="03ccd-158">TargetName:依預設，物件的名稱 cmdlet 已處理時，發生錯誤。</span><span class="sxs-lookup"><span data-stu-id="03ccd-158">TargetName: By default, the name of the object the cmdlet was processing when the error occurred.</span></span> <span data-ttu-id="03ccd-159">或者，另一個 cmdlet 定義的字串。</span><span class="sxs-lookup"><span data-stu-id="03ccd-159">Or, another cmdlet-defined string.</span></span>

- <span data-ttu-id="03ccd-160">TargetType:根據預設，目標物件的型別。</span><span class="sxs-lookup"><span data-stu-id="03ccd-160">TargetType: By default, the type of the target object.</span></span> <span data-ttu-id="03ccd-161">或者，另一個 cmdlet 定義的字串。</span><span class="sxs-lookup"><span data-stu-id="03ccd-161">Or, another cmdlet-defined string.</span></span>

- <span data-ttu-id="03ccd-162">活動：根據預設，建立錯誤記錄 cmdlet 的名稱。</span><span class="sxs-lookup"><span data-stu-id="03ccd-162">Activity: By default, the name of the cmdlet that created the error record.</span></span> <span data-ttu-id="03ccd-163">或某些其他 cmdlet 定義的字串。</span><span class="sxs-lookup"><span data-stu-id="03ccd-163">Or, some other cmdlet-defined string.</span></span>

- <span data-ttu-id="03ccd-164">原因：根據預設，例外狀況類型。</span><span class="sxs-lookup"><span data-stu-id="03ccd-164">Reason: By default, the exception type.</span></span> <span data-ttu-id="03ccd-165">或者，另一個 cmdlet 定義的字串。</span><span class="sxs-lookup"><span data-stu-id="03ccd-165">Or, another cmdlet-defined string.</span></span>

## <a name="replacement-error-message"></a><span data-ttu-id="03ccd-166">取代錯誤訊息</span><span class="sxs-lookup"><span data-stu-id="03ccd-166">Replacement Error Message</span></span>

<span data-ttu-id="03ccd-167">當您開發 cmdlet 的錯誤記錄時，預設的錯誤訊息的錯誤是來自中的預設訊息文字[System.Exception.Message](/dotnet/api/System.Exception.Message)屬性。</span><span class="sxs-lookup"><span data-stu-id="03ccd-167">When you develop an error record for a cmdlet, the default error message for the error comes from the default message text in the [System.Exception.Message](/dotnet/api/System.Exception.Message) property.</span></span> <span data-ttu-id="03ccd-168">這是唯讀屬性，其訊息文字僅供偵錯之用 （根據.NET Framework 的指導方針）。</span><span class="sxs-lookup"><span data-stu-id="03ccd-168">This is a read-only property whose message text is intended only for debugging purposes (according to the .NET Framework guidelines).</span></span> <span data-ttu-id="03ccd-169">我們建議您建立錯誤訊息來取代或增強了預設訊息文字。</span><span class="sxs-lookup"><span data-stu-id="03ccd-169">We recommend that you create an error message that replaces or augments the default message text.</span></span> <span data-ttu-id="03ccd-170">讓使用者更容易使用且更特定訊息給 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="03ccd-170">Make the message more user-friendly and more specific to the cmdlet.</span></span>

<span data-ttu-id="03ccd-171">取代訊息由提供[System.Management.Automation.ErrorDetails](/dotnet/api/System.Management.Automation.ErrorDetails)物件。</span><span class="sxs-lookup"><span data-stu-id="03ccd-171">The replacement message is provided by an [System.Management.Automation.ErrorDetails](/dotnet/api/System.Management.Automation.ErrorDetails) object.</span></span> <span data-ttu-id="03ccd-172">因為它們提供可供 Windows PowerShell 的其他當地語系化資訊，請使用此物件的下列建構函式的其中一個選項。</span><span class="sxs-lookup"><span data-stu-id="03ccd-172">Use one of the following constructors of this object because they provide additional localization information that can be used by Windows PowerShell.</span></span>

- <span data-ttu-id="03ccd-173">[ErrorDetails(Cmdlet, String, String, Object[])](/dotnet/api/system.management.automation.errordetails.-ctor?view=pscore-6.2.0#System_Management_Automation_ErrorDetails__ctor_System_Management_Automation_Cmdlet_System_String_System_String_System_Object___):使用這個建構函式，如果您範本字串的 cmdlet 採用相同的組件中的資源字串，或如果您想要載入的覆寫透過範本字串[System.Management.Automation.Cmdlet.GetResourceString](/dotnet/api/System.Management.Automation.Cmdlet.GetResourceString)方法。</span><span class="sxs-lookup"><span data-stu-id="03ccd-173">[ErrorDetails(Cmdlet, String, String, Object[])](/dotnet/api/system.management.automation.errordetails.-ctor?view=pscore-6.2.0#System_Management_Automation_ErrorDetails__ctor_System_Management_Automation_Cmdlet_System_String_System_String_System_Object___): Use this constructor if your template string is a resource string in the same assembly in which the cmdlet is implemented or if you want to load the template string through an override of the  [System.Management.Automation.Cmdlet.GetResourceString](/dotnet/api/System.Management.Automation.Cmdlet.GetResourceString) method.</span></span>

- <span data-ttu-id="03ccd-174">[ErrorDetails (組件、 字串、 字串、 Object[])](/dotnet/api/system.management.automation.errordetails.-ctor?view=pscore-6.2.0#System_Management_Automation_ErrorDetails__ctor_System_Reflection_Assembly_System_String_System_String_System_Object___):如果範本字串在另一個組件中，且您不會載入它的覆寫透過使用這個建構函式[System.Management.Automation.Cmdlet.GetResourceString](/dotnet/api/System.Management.Automation.Cmdlet.GetResourceString)。</span><span class="sxs-lookup"><span data-stu-id="03ccd-174">[ErrorDetails(Assembly, String, String, Object[])](/dotnet/api/system.management.automation.errordetails.-ctor?view=pscore-6.2.0#System_Management_Automation_ErrorDetails__ctor_System_Reflection_Assembly_System_String_System_String_System_Object___): Use this constructor if the template string is in another assembly and you do not load it through an override of [System.Management.Automation.Cmdlet.GetResourceString](/dotnet/api/System.Management.Automation.Cmdlet.GetResourceString).</span></span>

<span data-ttu-id="03ccd-175">取代訊息應該符合.NET Framework 設計方針，以寫入有些許不同的例外狀況訊息。</span><span class="sxs-lookup"><span data-stu-id="03ccd-175">The replacement message should conform to the .NET Framework design guidelines for writing exception messages with a small difference.</span></span> <span data-ttu-id="03ccd-176">應該將例外狀況訊息寫入為開發人員指導方針狀態。</span><span class="sxs-lookup"><span data-stu-id="03ccd-176">The guidelines state that exception messages should be written for developers.</span></span> <span data-ttu-id="03ccd-177">這些取代應該將訊息寫入指令程式使用者。</span><span class="sxs-lookup"><span data-stu-id="03ccd-177">These replacement messages should be written for the cmdlet user.</span></span>

<span data-ttu-id="03ccd-178">必須新增取代錯誤訊息，才能[System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)或是[System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)方法受到呼叫。</span><span class="sxs-lookup"><span data-stu-id="03ccd-178">The replacement error message must be added before the [System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) or [System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) methods are called.</span></span> <span data-ttu-id="03ccd-179">若要新增的取代訊息，請設定[System.Management.Automation.ErrorRecord.ErrorDetails](/dotnet/api/System.Management.Automation.ErrorRecord.ErrorDetails)錯誤記錄的屬性。</span><span class="sxs-lookup"><span data-stu-id="03ccd-179">To add a replacement message, set the [System.Management.Automation.ErrorRecord.ErrorDetails](/dotnet/api/System.Management.Automation.ErrorRecord.ErrorDetails) property of the error record.</span></span> <span data-ttu-id="03ccd-180">當設定這個屬性時，Windows PowerShell 會顯示[System.Management.Automation.ErrorDetails.Message\*](/dotnet/api/System.Management.Automation.ErrorDetails.Message)屬性而不是預設訊息文字。</span><span class="sxs-lookup"><span data-stu-id="03ccd-180">When this property is set, Windows PowerShell displays the [System.Management.Automation.ErrorDetails.Message\*](/dotnet/api/System.Management.Automation.ErrorDetails.Message) property instead of the default message text.</span></span>

## <a name="recommended-action-information"></a><span data-ttu-id="03ccd-181">建議的動作資訊</span><span class="sxs-lookup"><span data-stu-id="03ccd-181">Recommended Action Information</span></span>

<span data-ttu-id="03ccd-182">[System.Management.Automation.ErrorDetails](/dotnet/api/System.Management.Automation.ErrorDetails)物件也可以提供資訊就會發生錯誤時，建議的動作。</span><span class="sxs-lookup"><span data-stu-id="03ccd-182">The [System.Management.Automation.ErrorDetails](/dotnet/api/System.Management.Automation.ErrorDetails) object can also provide information about what actions are recommended when the error occurs.</span></span>

## <a name="invocation-information"></a><span data-ttu-id="03ccd-183">引動過程的資訊</span><span class="sxs-lookup"><span data-stu-id="03ccd-183">Invocation information</span></span>

<span data-ttu-id="03ccd-184">當 cmdlet 時，使用[System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)或是[System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)回報的錯誤記錄，Windows PowerShell會自動加入描述發生錯誤時叫用命令的資訊。</span><span class="sxs-lookup"><span data-stu-id="03ccd-184">When a cmdlet uses [System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) or [System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) to report an error record, Windows PowerShell automatically adds information that describes the command that was invoked when the error occurred.</span></span> <span data-ttu-id="03ccd-185">這項資訊由[System.Management.Automation.Invocationinfo](/dotnet/api/System.Management.Automation.InvocationInfo)物件，其中包含已叫用命令，命令本身，此 cmdlet 的名稱以及管線或指令碼的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="03ccd-185">This information is provided by a [System.Management.Automation.Invocationinfo](/dotnet/api/System.Management.Automation.InvocationInfo) object that contains the name of the cmdlet that was invoked by the command, the command itself, and information about the pipeline or script.</span></span> <span data-ttu-id="03ccd-186">這個屬性是唯讀的。</span><span class="sxs-lookup"><span data-stu-id="03ccd-186">This property is read-only.</span></span>

## <a name="see-also"></a><span data-ttu-id="03ccd-187">另請參閱</span><span class="sxs-lookup"><span data-stu-id="03ccd-187">See Also</span></span>

[<span data-ttu-id="03ccd-188">System.Management.Automation.Cmdlet.WriteError</span><span class="sxs-lookup"><span data-stu-id="03ccd-188">System.Management.Automation.Cmdlet.WriteError</span></span>](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)

[<span data-ttu-id="03ccd-189">System.Management.Automation.Cmdlet.Throwterminatingerror\*</span><span class="sxs-lookup"><span data-stu-id="03ccd-189">System.Management.Automation.Cmdlet.Throwterminatingerror\*</span></span>](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)

[<span data-ttu-id="03ccd-190">System.Management.Automation.ErrorCategory</span><span class="sxs-lookup"><span data-stu-id="03ccd-190">System.Management.Automation.ErrorCategory</span></span>](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0)

[<span data-ttu-id="03ccd-191">System.Management.Automation.Errorcategoryinfo</span><span class="sxs-lookup"><span data-stu-id="03ccd-191">System.Management.Automation.Errorcategoryinfo</span></span>](/dotnet/api/System.Management.Automation.ErrorCategoryInfo)

[<span data-ttu-id="03ccd-192">System.Management.Automation.ErrorRecord</span><span class="sxs-lookup"><span data-stu-id="03ccd-192">System.Management.Automation.ErrorRecord</span></span>](/dotnet/api/System.Management.Automation.ErrorRecord)

[<span data-ttu-id="03ccd-193">System.Management.Automation.ErrorDetails</span><span class="sxs-lookup"><span data-stu-id="03ccd-193">System.Management.Automation.ErrorDetails</span></span>](/dotnet/api/System.Management.Automation.ErrorDetails)

[<span data-ttu-id="03ccd-194">System.Management.Automation.Invocationinfo</span><span class="sxs-lookup"><span data-stu-id="03ccd-194">System.Management.Automation.Invocationinfo</span></span>](/dotnet/api/System.Management.Automation.InvocationInfo)

[<span data-ttu-id="03ccd-195">Windows PowerShell 的錯誤報告</span><span class="sxs-lookup"><span data-stu-id="03ccd-195">Windows PowerShell Error Reporting</span></span>](./error-reporting-concepts.md)

[<span data-ttu-id="03ccd-196">撰寫 Windows PowerShell Cmdlet</span><span class="sxs-lookup"><span data-stu-id="03ccd-196">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)
