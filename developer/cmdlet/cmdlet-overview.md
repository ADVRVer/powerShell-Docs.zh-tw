---
title: 指令程式概觀 |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- cmdlets [PowerShell SDK]
- cmdlets [PowerShell SDK], described
ms.assetid: 0aa32589-4447-4ead-a5dd-a3be99113140
caps.latest.revision: 21
ms.openlocfilehash: 14200aed2fb94c37c8b8af29650f602945e7ac1c
ms.sourcegitcommit: 58fb23c854f5a8b40ad1f952d3323aeeccac7a24
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/07/2019
ms.locfileid: "65229356"
---
# <a name="cmdlet-overview"></a><span data-ttu-id="2fdbd-102">Cmdlet 概觀</span><span class="sxs-lookup"><span data-stu-id="2fdbd-102">Cmdlet Overview</span></span>

<span data-ttu-id="2fdbd-103">Cmdlet 是 Windows PowerShell 環境中使用的輕量型命令。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-103">A cmdlet is a lightweight command that is used in the Windows PowerShell environment.</span></span> <span data-ttu-id="2fdbd-104">Windows PowerShell 執行階段會叫用這些 cmdlet，在命令列提供的自動化指令碼的內容中。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-104">The Windows PowerShell runtime invokes these cmdlets within the context of automation scripts that are provided at the command line.</span></span> <span data-ttu-id="2fdbd-105">Windows PowerShell 執行階段也會叫用它們以程式設計方式透過 Windows PowerShell Api。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-105">The Windows PowerShell runtime also invokes them programmatically through Windows PowerShell APIs.</span></span>

## <a name="cmdlets"></a><span data-ttu-id="2fdbd-106">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="2fdbd-106">Cmdlets</span></span>

<span data-ttu-id="2fdbd-107">Cmdlet 會執行動作，以及通常在管線中下一個命令會傳回 Microsoft.NET Framework 物件。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-107">Cmdlets perform an action and typically return a Microsoft .NET Framework object to the next command in the pipeline.</span></span> <span data-ttu-id="2fdbd-108">若要撰寫的 cmdlet，您必須實作 cmdlet 類別衍生自兩個特製化的指令程式的基底類別的其中一個。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-108">To write a cmdlet, you must implement a cmdlet class that derives from one of two specialized cmdlet base classes.</span></span> <span data-ttu-id="2fdbd-109">在衍生的類別必須是：</span><span class="sxs-lookup"><span data-stu-id="2fdbd-109">The derived class must:</span></span>

- <span data-ttu-id="2fdbd-110">宣告屬性，可識別為 cmdlet 的衍生的類別。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-110">Declare an attribute that identifies the derived class as a cmdlet.</span></span>

- <span data-ttu-id="2fdbd-111">定義以識別做為指令程式參數的公用屬性的屬性裝飾的公用屬性。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-111">Define public properties that are decorated with attributes that identify the public properties as cmdlet parameters.</span></span>

- <span data-ttu-id="2fdbd-112">覆寫一個或多個的輸入處理方法來處理記錄。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-112">Override one or more of the input processing methods to process records.</span></span>

<span data-ttu-id="2fdbd-113">您可以載入該組件包含的類別是直接使用[Import-module](/powershell/module/microsoft.powershell.core/import-module) cmdlet，或您可以建立使用載入的組件的主應用程式[System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) API。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-113">You can load the assembly that contains the class directly by using the [Import-Module](/powershell/module/microsoft.powershell.core/import-module) cmdlet, or you can create a host application that loads the assembly by using the [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) API.</span></span> <span data-ttu-id="2fdbd-114">這兩種方法提供程式設計的方式和命令列功能存取權的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-114">Both methods provide programmatic and command-line access to the functionality of the cmdlet.</span></span>

## <a name="cmdlet-terms"></a><span data-ttu-id="2fdbd-115">Cmdlet 名詞</span><span class="sxs-lookup"><span data-stu-id="2fdbd-115">Cmdlet Terms</span></span>

<span data-ttu-id="2fdbd-116">下列詞彙常用於 Windows PowerShell cmdlet 文件：</span><span class="sxs-lookup"><span data-stu-id="2fdbd-116">The following terms are used frequently in the Windows PowerShell cmdlet documentation:</span></span>

### <a name="cmdlet-attribute"></a><span data-ttu-id="2fdbd-117">Cmdlet 屬性</span><span class="sxs-lookup"><span data-stu-id="2fdbd-117">Cmdlet attribute</span></span>

<span data-ttu-id="2fdbd-118">用來宣告為 cmdlet 的 cmdlet 類別將.NET Framework 屬性。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-118">A .NET Framework attribute that is used to declare a cmdlet class as a cmdlet.</span></span>
<span data-ttu-id="2fdbd-119">雖然 PowerShell 使用是選擇性的數個其他屬性，Cmdlet 屬性是必要的。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-119">Although PowerShell uses several other attributes that are optional, the Cmdlet attribute is required.</span></span>
<span data-ttu-id="2fdbd-120">如需有關這個屬性的詳細資訊，請參閱 < [Cmdlet 屬性宣告](cmdlet-attribute-declaration.md)。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-120">For more information about this attribute, see [Cmdlet Attribute Declaration](cmdlet-attribute-declaration.md).</span></span>

### <a name="cmdlet-parameter"></a><span data-ttu-id="2fdbd-121">指令程式參數</span><span class="sxs-lookup"><span data-stu-id="2fdbd-121">Cmdlet parameter</span></span>

<span data-ttu-id="2fdbd-122">定義提供給使用者或應用程式執行此 cmdlet 的參數的公用屬性。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-122">The public properties that define the parameters that are available to the user or to the application that is running the cmdlet.</span></span>
<span data-ttu-id="2fdbd-123">Cmdlet 可以具有必要的具名、 位置，並*切換*參數。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-123">Cmdlets can have required, named, positional, and *switch* parameters.</span></span>
<span data-ttu-id="2fdbd-124">切換參數可讓您定義的參數指定在呼叫時，才會進行評估的參數。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-124">Switch parameters allow you to define parameters that are evaluated only if the parameters are specified in the call.</span></span>
<span data-ttu-id="2fdbd-125">如需不同類型的參數的詳細資訊，請參閱[Cmdlet 參數](cmdlet-parameters.md)。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-125">For more information about the different types of parameters, see [Cmdlet Parameters](cmdlet-parameters.md).</span></span>

### <a name="parameter-set"></a><span data-ttu-id="2fdbd-126">參數集</span><span class="sxs-lookup"><span data-stu-id="2fdbd-126">Parameter set</span></span>

<span data-ttu-id="2fdbd-127">可在相同命令中用來執行特定動作的一組參數。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-127">A group of parameters that can be used in the same command to perform a specific action.</span></span>
<span data-ttu-id="2fdbd-128">Cmdlet 可以有多個參數集，但每個參數集必須是唯一的至少一個參數。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-128">A cmdlet can have multiple parameter sets, but each parameter set must have at least one parameter that is unique.</span></span>
<span data-ttu-id="2fdbd-129">良好的 cmdlet 設計強烈建議唯一的參數也是必要的參數。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-129">Good cmdlet design strongly suggests that the unique parameter also be a required parameter.</span></span>
<span data-ttu-id="2fdbd-130">如需參數集的詳細資訊，請參閱[指令程式參數設定](cmdlet-parameter-sets.md)。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-130">For more information about parameter sets, see [Cmdlet Parameter Sets](cmdlet-parameter-sets.md).</span></span>

### <a name="dynamic-parameter"></a><span data-ttu-id="2fdbd-131">動態參數</span><span class="sxs-lookup"><span data-stu-id="2fdbd-131">Dynamic parameter</span></span>

<span data-ttu-id="2fdbd-132">新增至 cmdlet，在執行階段參數。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-132">A parameter that is added to the cmdlet at runtime.</span></span>
<span data-ttu-id="2fdbd-133">一般而言，動態參數會加入至 cmdlet 的另一個參數設定為特定值時。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-133">Typically, the dynamic parameters are added to the cmdlet when another parameter is set to a specific value.</span></span>
<span data-ttu-id="2fdbd-134">如需有關動態參數的詳細資訊，請參閱[Cmdlet 的動態參數](cmdlet-dynamic-parameters.md)。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-134">For more information about dynamic parameters, see [Cmdlet Dynamic Parameters](cmdlet-dynamic-parameters.md).</span></span>

### <a name="input-processing-method"></a><span data-ttu-id="2fdbd-135">輸入處理方法</span><span class="sxs-lookup"><span data-stu-id="2fdbd-135">Input processing method</span></span>

<span data-ttu-id="2fdbd-136">Cmdlet 可用來處理接收為輸入之記錄的方法。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-136">A method that a cmdlet can use to process the records it receives as input.</span></span>
<span data-ttu-id="2fdbd-137">輸入的處理方法包括[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing)方法， [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord)方法， [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing)方法，而[System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing)方法。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-137">The input processing methods include the [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) method, the [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method, the [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) method, and the [System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing) method.</span></span> <span data-ttu-id="2fdbd-138">當您實作的 cmdlet 時，您必須覆寫至少其中一個[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing)， [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord)，並[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing)方法。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-138">When you implement a cmdlet, you must override at least one of the [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing), [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord), and [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) methods.</span></span>
<span data-ttu-id="2fdbd-139">通常[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord)方法是您覆寫，因為它會呼叫指令程式會處理每一筆記錄的方法。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-139">Typically, the [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method is the method that you override because it is called for every record that the cmdlet processes.</span></span>
<span data-ttu-id="2fdbd-140">相反地， [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing)方法並[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing)方法會呼叫一次執行前置處理或後置處理的記錄。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-140">In contrast, the [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) method and the [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) method are called one time to perform pre-processing or post-processing of the records.</span></span>
<span data-ttu-id="2fdbd-141">如需這些方法的詳細資訊，請參閱[輸入處理方法](cmdlet-input-processing-methods.md)。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-141">For more information about these methods, see [Input Processing Methods](cmdlet-input-processing-methods.md).</span></span>

### <a name="shouldprocess-feature"></a><span data-ttu-id="2fdbd-142">ShouldProcess 功能</span><span class="sxs-lookup"><span data-stu-id="2fdbd-142">ShouldProcess feature</span></span>

<span data-ttu-id="2fdbd-143">PowerShell 可讓您建立 cmdlet，此 cmdlet 會在系統中進行變更之前，提示使用者提供意見反應。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-143">PowerShell allows you to create cmdlets that prompt the user for feedback before the cmdlet makes a change to the system.</span></span>
<span data-ttu-id="2fdbd-144">若要使用這項功能，此 cmdlet 必須宣告它支援 ShouldProcess 功能，當您宣告 Cmdlet 屬性，而且 cmdlet 必須呼叫[System.Management.Automation.Cmdlet.ShouldProcess](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)和[System.Management.Automation.Cmdlet.ShouldContinue](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)內輸入處理方法的方法。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-144">To use this feature, the cmdlet must declare that it supports the ShouldProcess feature when you declare the Cmdlet attribute, and the cmdlet must call the [System.Management.Automation.Cmdlet.ShouldProcess](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) and [System.Management.Automation.Cmdlet.ShouldContinue](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) methods from within an input processing method.</span></span>
<span data-ttu-id="2fdbd-145">如需如何支援 ShouldProcess 功能的詳細資訊，請參閱[要求確認](requesting-confirmation-from-cmdlets.md)。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-145">For more information about how to support the ShouldProcess functionality, see [Requesting Confirmation](requesting-confirmation-from-cmdlets.md).</span></span>

### <a name="transaction"></a><span data-ttu-id="2fdbd-146">Transaction</span><span class="sxs-lookup"><span data-stu-id="2fdbd-146">Transaction</span></span>

<span data-ttu-id="2fdbd-147">會被視為單一工作的命令邏輯群組。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-147">A logical group of commands that are treated as a single task.</span></span>
<span data-ttu-id="2fdbd-148">如果群組中的任何命令失敗，而且使用者可以選擇接受或拒絕在交易內執行的動作，自動就會失敗的工作。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-148">The task automatically fails if any command in the group fails, and the user has the choice to accept or reject the actions performed within the transaction.</span></span>
<span data-ttu-id="2fdbd-149">若要參與交易，此 cmdlet 必須宣告 Cmdlet 屬性宣告時支援交易。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-149">To participate in a transaction, the cmdlet must declare that it supports transactions when the Cmdlet attribute is declared.</span></span>
<span data-ttu-id="2fdbd-150">在 Windows PowerShell 2.0 中引進了交易的支援。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-150">Support for transactions was introduced in Windows PowerShell 2.0.</span></span>
<span data-ttu-id="2fdbd-151">如需有關交易的詳細資訊，請參閱[如何支援交易](how-to-support-transactions.md)。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-151">For more information about transactions, see [How to Support Transactions](how-to-support-transactions.md).</span></span>

## <a name="how-cmdlets-differ-from-commands"></a><span data-ttu-id="2fdbd-152">與命令的指令程式有何不同</span><span class="sxs-lookup"><span data-stu-id="2fdbd-152">How Cmdlets Differ from Commands</span></span>

<span data-ttu-id="2fdbd-153">利用下列方式，與其他命令殼層環境中的命令不同 Cmdlet:</span><span class="sxs-lookup"><span data-stu-id="2fdbd-153">Cmdlets differ from commands in other command-shell environments in the following ways:</span></span>

- <span data-ttu-id="2fdbd-154">Cmdlet 是.NET Framework 類別; 的執行個體它們不是獨立的可執行檔。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-154">Cmdlets are instances of .NET Framework classes; they are not stand-alone executables.</span></span>

- <span data-ttu-id="2fdbd-155">您可以從只需要十幾行程式碼建立 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-155">Cmdlets can be created from as few as a dozen lines of code.</span></span>

- <span data-ttu-id="2fdbd-156">Cmdlet 通常沒有自己的剖析時，錯誤簡報] 或 [輸出格式設定。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-156">Cmdlets do not generally do their own parsing, error presentation, or output formatting.</span></span> <span data-ttu-id="2fdbd-157">Windows PowerShell 執行階段會處理剖析、 錯誤簡報及輸出格式。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-157">Parsing, error presentation, and output formatting are handled by the Windows PowerShell runtime.</span></span>

- <span data-ttu-id="2fdbd-158">Cmdlet 處理輸入物件從管線中，而不是從資料流的文字，以及 cmdlet 通常會將物件傳遞到管線的輸出。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-158">Cmdlets process input objects from the pipeline rather than from streams of text, and cmdlets typically deliver objects as output to the pipeline.</span></span>

- <span data-ttu-id="2fdbd-159">Cmdlet 屬於記錄導向因為它們一次處理單一物件。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-159">Cmdlets are record-oriented because they process a single object at a time.</span></span>

## <a name="cmdlet-base-classes"></a><span data-ttu-id="2fdbd-160">指令程式的基底類別</span><span class="sxs-lookup"><span data-stu-id="2fdbd-160">Cmdlet Base Classes</span></span>

<span data-ttu-id="2fdbd-161">Windows PowerShell 支援從下列兩個基底類別衍生的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-161">Windows PowerShell supports cmdlets that are derived from the following two base classes.</span></span>

- <span data-ttu-id="2fdbd-162">大多數的 cmdlet 根據.NET Framework 類別衍生自[System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet)基底類別。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-162">Most cmdlets are based on .NET Framework classes that derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) base class.</span></span> <span data-ttu-id="2fdbd-163">衍生自這個類別可讓 cmdlet 在 Windows PowerShell 執行階段上使用相依性的最小集合。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-163">Deriving from this class allows a cmdlet to use the minimum set of dependencies on the Windows PowerShell runtime.</span></span> <span data-ttu-id="2fdbd-164">這有兩個優點。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-164">This has two benefits.</span></span> <span data-ttu-id="2fdbd-165">第一個好處是，cmdlet 物件比較小，而且您較不容易受到變更，Windows PowerShell 執行階段。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-165">The first benefit is that the cmdlet objects are smaller, and you are less likely to be affected by changes to the Windows PowerShell runtime.</span></span> <span data-ttu-id="2fdbd-166">第二個優點是，如果您需要可以直接建立 cmdlet 物件的執行個體，並叫用將它直接而不是透過 Windows PowerShell 執行階段叫用。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-166">The second benefit is that, if you have to, you can directly create an instance of the cmdlet object and then invoke it directly instead of invoking it through the Windows PowerShell runtime.</span></span>

- <span data-ttu-id="2fdbd-167">更複雜的指令程式根據.NET Framework 類別衍生自[System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet)基底類別。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-167">The more-complex cmdlets are based on .NET Framework classes that derive from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) base class.</span></span> <span data-ttu-id="2fdbd-168">衍生自這個類別可讓您更多存取 Windows PowerShell 執行階段。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-168">Deriving from this class gives you much more access to the Windows PowerShell runtime.</span></span> <span data-ttu-id="2fdbd-169">此存取權可讓您呼叫指令碼，來存取提供者，並存取目前工作階段狀態的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-169">This access allows your cmdlet to call scripts, to access providers, and to access the current session state.</span></span> <span data-ttu-id="2fdbd-170">（若要存取目前工作階段狀態，您取得和設定工作階段變數與喜好設定。）不過，衍生自這個類別會增加 cmdlet 物件的大小，這表示您的 cmdlet 會更緊密地結合至目前版本的 Windows PowerShell 執行階段。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-170">(To access the current session state, you get and set session variables and preferences.) However, deriving from this class increases the size of the cmdlet object, and it means that your cmdlet is more tightly coupled to the current version of the Windows PowerShell runtime.</span></span>

<span data-ttu-id="2fdbd-171">一般情況下，除非您需要擴充的存取的 Windows PowerShell 執行階段時，您應該衍生自[System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet)類別。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-171">In general, unless you need the extended access to the Windows PowerShell runtime, you should derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class.</span></span> <span data-ttu-id="2fdbd-172">不過，Windows PowerShell 執行階段有廣泛的記錄功能的 cmdlet 執行。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-172">However, the Windows PowerShell runtime has extensive logging capabilities for the execution of cmdlets.</span></span> <span data-ttu-id="2fdbd-173">如果您稽核的模型取決於這項記錄，您還可以防止您從另一個 cmdlet 中的 cmdlet 執行，藉由衍生自[System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet)類別。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-173">If your auditing model depends on this logging, you can prevent the execution of your cmdlet from within another cmdlet by deriving from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class.</span></span>

## <a name="input-processing-methods"></a><span data-ttu-id="2fdbd-174">輸入處理方法</span><span class="sxs-lookup"><span data-stu-id="2fdbd-174">Input Processing Methods</span></span>

<span data-ttu-id="2fdbd-175">[System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet)類別提供用來處理記錄的下列虛擬方法。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-175">The [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class provides the following virtual methods that are used to process records.</span></span> <span data-ttu-id="2fdbd-176">所有衍生的 cmdlet 類別必須覆寫一個或多個第三個方法：</span><span class="sxs-lookup"><span data-stu-id="2fdbd-176">All the derived cmdlet classes must override one or more of the first three methods:</span></span>

- <span data-ttu-id="2fdbd-177">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing):用來為 cmdlet 提供選用的一次性、 前置處理功能。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-177">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing): Used to provide optional one-time, pre-processing functionality for the cmdlet.</span></span>

- <span data-ttu-id="2fdbd-178">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord):用來提供 cmdlet 的-記錄處理功能。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-178">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord): Used to provide record-by-record processing functionality for the cmdlet.</span></span> <span data-ttu-id="2fdbd-179">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord)任意數目的次數，或完全沒有，根據指令程式的輸入可能會呼叫方法。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-179">The [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method might be called any number of times, or not at all, depending on the input of the cmdlet.</span></span>

- <span data-ttu-id="2fdbd-180">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing):用來為 cmdlet 提供選用的一次性、 後置處理功能。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-180">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing): Used to provide optional one-time, post-processing functionality for the cmdlet.</span></span>

- <span data-ttu-id="2fdbd-181">[System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing):用來停止處理當使用者停止 cmdlet 以非同步方式 （例如，藉由按下 CTRL + C）。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-181">[System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing): Used to stop processing when the user stops the cmdlet asynchronously (for example,  by pressing CTRL+C).</span></span>

<span data-ttu-id="2fdbd-182">如需這些方法的詳細資訊，請參閱[Cmdlet 的輸入處理方法](./cmdlet-input-processing-methods.md)。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-182">For more information about these methods, see [Cmdlet Input Processing Methods](./cmdlet-input-processing-methods.md).</span></span>

## <a name="cmdlet-attributes"></a><span data-ttu-id="2fdbd-183">Cmdlet 屬性</span><span class="sxs-lookup"><span data-stu-id="2fdbd-183">Cmdlet Attributes</span></span>

<span data-ttu-id="2fdbd-184">Windows PowerShell 會定義數個管理 cmdlet，並指定通用的功能，Windows PowerShell 所提供，且，可能會需要指令程式所使用的.NET Framework 屬性。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-184">Windows PowerShell defines several .NET Framework attributes that are used to manage cmdlets and to specify common functionality that is provided by Windows PowerShell and that might be required by the cmdlet.</span></span> <span data-ttu-id="2fdbd-185">例如，屬性用來指定某個類別，為 cmdlet，以指定之參數的 cmdlet，並要求輸入的驗證，如此 cmdlet 開發人員就不必在其 cmdlet 的程式碼中實作該功能。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-185">For example, attributes are used to designate a class as a cmdlet, to specify the parameters of the cmdlet, and to request the validation of input so that cmdlet developers do not have to implement that functionality in their cmdlet code.</span></span> <span data-ttu-id="2fdbd-186">如需有關屬性的詳細資訊，請參閱 < [Windows PowerShell 屬性](./cmdlet-attributes.md)。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-186">For more information about attributes, see [Windows PowerShell Attributes](./cmdlet-attributes.md).</span></span>

## <a name="cmdlet-names"></a><span data-ttu-id="2fdbd-187">Cmdlet 名稱</span><span class="sxs-lookup"><span data-stu-id="2fdbd-187">Cmdlet Names</span></span>

<span data-ttu-id="2fdbd-188">Windows PowerShell 會使用名稱 cmdlet 動詞和名詞名稱配對。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-188">Windows PowerShell uses a verb-and-noun name pair to name cmdlets.</span></span> <span data-ttu-id="2fdbd-189">比方說，`Get-Command`隨附於 Windows PowerShell 的 cmdlet 可用來取得所有 cmdlet，在命令殼層中註冊。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-189">For example, the `Get-Command` cmdlet included in Windows PowerShell is used to get all the cmdlets that are registered in the command shell.</span></span> <span data-ttu-id="2fdbd-190">動詞命令識別 cmdlet 所執行的動作和名詞識別此 cmdlet 會在其執行其動作的資源。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-190">The verb identifies the action that the cmdlet performs, and the noun identifies the resource on which the cmdlet performs its action.</span></span>

<span data-ttu-id="2fdbd-191">.NET Framework 類別宣告為 cmdlet 時，會指定這些名稱。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-191">These names are specified when the .NET Framework class is declared as a cmdlet.</span></span> <span data-ttu-id="2fdbd-192">如需如何將.NET Framework 類別宣告為 cmdlet 的詳細資訊，請參閱[Cmdlet 屬性宣告](./cmdlet-class-declaration.md)。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-192">For more information about how to declare a .NET Framework class as a cmdlet, see [Cmdlet Attribute Declaration](./cmdlet-class-declaration.md).</span></span>

## <a name="writing-cmdlet-code"></a><span data-ttu-id="2fdbd-193">撰寫 Cmdlet 程式碼</span><span class="sxs-lookup"><span data-stu-id="2fdbd-193">Writing Cmdlet Code</span></span>

<span data-ttu-id="2fdbd-194">本文件提供兩種方式可以探索 cmdlet 程式碼撰寫的方式。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-194">This document provides two ways to discover how cmdlet code is written.</span></span> <span data-ttu-id="2fdbd-195">如果您想要查看的程式碼，而不需要說明，請參閱[指令程式碼範例](./examples-of-cmdlet-code.md)。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-195">If you prefer to see the code without much explanation, see [Examples of Cmdlet Code](./examples-of-cmdlet-code.md).</span></span> <span data-ttu-id="2fdbd-196">如果您偏好的程式碼有關的詳細說明，請參閱[GetProc 教學課程](./getproc-tutorial.md)， [StopProc 教學課程](./stopproc-tutorial.md)，或[SelectStr 教學課程](./selectstr-tutorial.md)主題。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-196">If you prefer more explanation about the code, see the [GetProc Tutorial](./getproc-tutorial.md),  [StopProc Tutorial](./stopproc-tutorial.md), or [SelectStr Tutorial](./selectstr-tutorial.md) topics.</span></span>

<span data-ttu-id="2fdbd-197">如需詳細的指導方針撰寫 cmdlet 的詳細資訊，請參閱[指令程式的開發指導](./cmdlet-development-guidelines.md)。</span><span class="sxs-lookup"><span data-stu-id="2fdbd-197">For more information about the guidelines for writing cmdlets, see [Cmdlet Development Guidelines](./cmdlet-development-guidelines.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="2fdbd-198">另請參閱</span><span class="sxs-lookup"><span data-stu-id="2fdbd-198">See Also</span></span>

[<span data-ttu-id="2fdbd-199">Windows PowerShell 指令程式概念</span><span class="sxs-lookup"><span data-stu-id="2fdbd-199">Windows PowerShell Cmdlet Concepts</span></span>](./windows-powershell-cmdlet-concepts.md)

[<span data-ttu-id="2fdbd-200">撰寫 Windows PowerShell Cmdlet</span><span class="sxs-lookup"><span data-stu-id="2fdbd-200">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)

[<span data-ttu-id="2fdbd-201">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="2fdbd-201">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)
