---
title: 解譯 ErrorRecord 物件 |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 2a65b964-5bc6-4ade-a66b-b6afa7351ce7
caps.latest.revision: 9
ms.openlocfilehash: 32ebf2531237bfd1042310ccc4155193a58401fd
ms.sourcegitcommit: caac7d098a448232304c9d6728e7340ec7517a71
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/16/2019
ms.locfileid: "58058771"
---
# <a name="interpreting-errorrecord-objects"></a><span data-ttu-id="40b2b-102">解譯 ErrorRecord 物件</span><span class="sxs-lookup"><span data-stu-id="40b2b-102">Interpreting ErrorRecord Objects</span></span>

<span data-ttu-id="40b2b-103">在大部分情況下， [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)物件都代表所用的命令或指令碼產生非終止錯誤。</span><span class="sxs-lookup"><span data-stu-id="40b2b-103">In most cases, an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object represents a non-terminating error generated by a command or script.</span></span> <span data-ttu-id="40b2b-104">終止錯誤也可以指定的其他資訊中透過 ErrorRecord [System.Management.Automation.Icontainserrorrecord](/dotnet/api/System.Management.Automation.IContainsErrorRecord)介面。</span><span class="sxs-lookup"><span data-stu-id="40b2b-104">Terminating errors can also specify the additional information in an ErrorRecord via the [System.Management.Automation.Icontainserrorrecord](/dotnet/api/System.Management.Automation.IContainsErrorRecord) interface.</span></span>

<span data-ttu-id="40b2b-105">如果您想要撰寫的指令碼或主應用程式能夠處理特定的錯誤，您必須解譯命令或指令碼執行期間所發生的錯誤處理常式[System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)物件來判定是否它表示您想要處理的錯誤類別。</span><span class="sxs-lookup"><span data-stu-id="40b2b-105">If you want to write an error handler in your script or a host to handle specific errors that occur during command or script execution, you must interpret the [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object to determine whether it represents the class of error that you want to handle.</span></span>

<span data-ttu-id="40b2b-106">當 cmdlet 發生終止或非終止錯誤，它應該建立描述錯誤狀況的錯誤記錄。</span><span class="sxs-lookup"><span data-stu-id="40b2b-106">When a cmdlet encounters a terminating or non-terminating error, it should create an error record that describes the error condition.</span></span> <span data-ttu-id="40b2b-107">主應用程式必須調查這些錯誤記錄，並執行任何動作將會減少錯誤。</span><span class="sxs-lookup"><span data-stu-id="40b2b-107">The host application must investigate these error records and perform whatever action will mitigate the error.</span></span> <span data-ttu-id="40b2b-108">主應用程式也必須調查錯誤記錄的非終止錯誤，無法處理記錄，但能夠繼續，以及它必須調查錯誤造成管線，以停止的終止錯誤的記錄。</span><span class="sxs-lookup"><span data-stu-id="40b2b-108">The host application must also investigate error records for nonterminating errors that failed to process a record but were able to continue, and it must investigate error records for terminating errors that caused the pipeline to stop.</span></span>

> [!NOTE]
> <span data-ttu-id="40b2b-109">終止錯誤，此 cmdlet 會呼叫[System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)方法。</span><span class="sxs-lookup"><span data-stu-id="40b2b-109">For terminating errors, the cmdlet calls the [System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) method.</span></span> <span data-ttu-id="40b2b-110">對於非終止錯誤，此 cmdlet 會呼叫[System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)方法。</span><span class="sxs-lookup"><span data-stu-id="40b2b-110">For non-terminating errors, the cmdlet calls the [System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method.</span></span>

## <a name="error-record-design"></a><span data-ttu-id="40b2b-111">錯誤記錄設計</span><span class="sxs-lookup"><span data-stu-id="40b2b-111">Error Record Design</span></span>

<span data-ttu-id="40b2b-112">錯誤記錄被設計來提供額外的錯誤資訊，同時確保每個錯誤記錄中結合的資訊唯一不提供例外狀況。</span><span class="sxs-lookup"><span data-stu-id="40b2b-112">Error records are designed to provide additional error information that is not available in exceptions while ensuring that the combined information in each error record is unique.</span></span> <span data-ttu-id="40b2b-113">這個唯一性可讓主應用程式，讓它可以識別錯誤狀況，並必須採取動作的主機，請檢查錯誤記錄的不同部分。</span><span class="sxs-lookup"><span data-stu-id="40b2b-113">This uniqueness allows the host application to inspect the different parts of the error record so that it can identify the error condition and the action the host must take.</span></span>

## <a name="interpreting-error-records"></a><span data-ttu-id="40b2b-114">解譯錯誤記錄</span><span class="sxs-lookup"><span data-stu-id="40b2b-114">Interpreting Error Records</span></span>

<span data-ttu-id="40b2b-115">您可以檢閱錯誤記錄以識別錯誤的幾個部分。</span><span class="sxs-lookup"><span data-stu-id="40b2b-115">You can review several parts of the error record to identify the error.</span></span> <span data-ttu-id="40b2b-116">這些組件包括下列各項：</span><span class="sxs-lookup"><span data-stu-id="40b2b-116">These parts include the following:</span></span>

- <span data-ttu-id="40b2b-117">錯誤類別目錄</span><span class="sxs-lookup"><span data-stu-id="40b2b-117">The error category</span></span>

- <span data-ttu-id="40b2b-118">錯誤例外狀況</span><span class="sxs-lookup"><span data-stu-id="40b2b-118">The error exception</span></span>

- <span data-ttu-id="40b2b-119">完整的錯誤識別項 (FQID)</span><span class="sxs-lookup"><span data-stu-id="40b2b-119">The fully qualified error identifier (FQID)</span></span>

- <span data-ttu-id="40b2b-120">其他資訊</span><span class="sxs-lookup"><span data-stu-id="40b2b-120">Other information</span></span>

### <a name="the-error-category"></a><span data-ttu-id="40b2b-121">錯誤類別目錄</span><span class="sxs-lookup"><span data-stu-id="40b2b-121">The Error Category</span></span>

<span data-ttu-id="40b2b-122">Error 記錄的錯誤類別是其中一個所提供的預先定義常數[System.Management.Automation.Errorcategory](/dotnet/api/System.Management.Automation.ErrorCategory)列舉型別。</span><span class="sxs-lookup"><span data-stu-id="40b2b-122">The error category of the error record is one of the predefined constants provided by the [System.Management.Automation.Errorcategory](/dotnet/api/System.Management.Automation.ErrorCategory) enumeration.</span></span> <span data-ttu-id="40b2b-123">這項資訊是透過[System.Management.Automation.ErrorRecord.CategoryInfo](/dotnet/api/System.Management.Automation.ErrorRecord.CategoryInfo)屬性[System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)物件。</span><span class="sxs-lookup"><span data-stu-id="40b2b-123">This information  is available through the [System.Management.Automation.ErrorRecord.CategoryInfo](/dotnet/api/System.Management.Automation.ErrorRecord.CategoryInfo) property of the [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span>

<span data-ttu-id="40b2b-124">CloseError、 OpenError、 InvalidType、 ReadError 和 WriteError 類別目錄，以及其他錯誤類別目錄，可以指定此 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="40b2b-124">The cmdlet can specify the CloseError, OpenError, InvalidType, ReadError, and WriteError categories, and other error categories.</span></span> <span data-ttu-id="40b2b-125">主應用程式可以使用的錯誤類別，來擷取錯誤群組。</span><span class="sxs-lookup"><span data-stu-id="40b2b-125">The host application can use the error category to capture groups of errors.</span></span>

### <a name="the-exception"></a><span data-ttu-id="40b2b-126">例外狀況</span><span class="sxs-lookup"><span data-stu-id="40b2b-126">The Exception</span></span>

<span data-ttu-id="40b2b-127">包含錯誤記錄中的例外狀況由指令程式提供，並可以透過存取[System.Management.Automation.ErrorRecord.Exception\*](/dotnet/api/System.Management.Automation.ErrorRecord.Exception)屬性[System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)物件。</span><span class="sxs-lookup"><span data-stu-id="40b2b-127">The exception included in the error record is provided by the cmdlet and can be accessed through the [System.Management.Automation.ErrorRecord.Exception\*](/dotnet/api/System.Management.Automation.ErrorRecord.Exception) property of the [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span>

<span data-ttu-id="40b2b-128">主機應用程式可以使用`is`關鍵字來辨識例外狀況是特定類別或衍生的類別。</span><span class="sxs-lookup"><span data-stu-id="40b2b-128">Host applications can use the `is` keyword to identify that the exception is of a specific class or of a derived class.</span></span> <span data-ttu-id="40b2b-129">最好是到分支上的例外狀況類型，如下列範例所示。</span><span class="sxs-lookup"><span data-stu-id="40b2b-129">It is better to branch on the exception type, as shown in the following example.</span></span>

`if (MyNonTerminatingError.Exception is AccessDeniedException)`

<span data-ttu-id="40b2b-130">如此一來，您攔截衍生的類別。</span><span class="sxs-lookup"><span data-stu-id="40b2b-130">This way, you catch the derived classes.</span></span> <span data-ttu-id="40b2b-131">不過，有問題如果還原序列化例外狀況。</span><span class="sxs-lookup"><span data-stu-id="40b2b-131">However, there are problems if the exception is deserialized.</span></span>

### <a name="the-fqid"></a><span data-ttu-id="40b2b-132">FQID</span><span class="sxs-lookup"><span data-stu-id="40b2b-132">The FQID</span></span>

<span data-ttu-id="40b2b-133">FQID 是可用來識別錯誤的最特定資訊。</span><span class="sxs-lookup"><span data-stu-id="40b2b-133">The FQID is the most specific information you can use to identify the error.</span></span> <span data-ttu-id="40b2b-134">它是包含的 cmdlet 定義識別項、 在 cmdlet 類別中，並回報錯誤的來源名稱的字串。</span><span class="sxs-lookup"><span data-stu-id="40b2b-134">It is a string that includes a cmdlet-defined identifier, the name of the cmdlet class, and the source that reported the error.</span></span> <span data-ttu-id="40b2b-135">一般情況下，錯誤記錄相當於在 Windows 事件記錄檔的事件記錄。</span><span class="sxs-lookup"><span data-stu-id="40b2b-135">In general, an error record is analogous to an event record of a Windows Event log.</span></span> <span data-ttu-id="40b2b-136">FQID 相當於下列的元組，用來識別該事件記錄的類別: (*記錄檔名稱*，*來源*，*事件識別碼*)。</span><span class="sxs-lookup"><span data-stu-id="40b2b-136">The FQID is analogous to the following tuple, which identifies the class of the event record: (*log name*, *source*, *event ID*).</span></span>

<span data-ttu-id="40b2b-137">FQID 被設計來進行檢查以單一字串。</span><span class="sxs-lookup"><span data-stu-id="40b2b-137">The FQID is designed to be inspected as a single string.</span></span> <span data-ttu-id="40b2b-138">不過，情況下存在所在的錯誤識別碼是主應用程式來剖析。</span><span class="sxs-lookup"><span data-stu-id="40b2b-138">However, cases exist in which the error identifier is designed to be parsed by the host application.</span></span> <span data-ttu-id="40b2b-139">下列範例是語式正確的完整限定的錯誤識別碼。</span><span class="sxs-lookup"><span data-stu-id="40b2b-139">The following example is a well-formed fully qualified error identifier.</span></span>

`CommandNotFoundException,Microsoft.PowerShell.Commands.GetCommandCommand.`

<span data-ttu-id="40b2b-140">在上述範例中，第一個語彙基元會是錯誤識別碼，接著會在 cmdlet 類別的名稱。</span><span class="sxs-lookup"><span data-stu-id="40b2b-140">In the previous example, the first token is the error identifier, which is followed by the name of the cmdlet class.</span></span> <span data-ttu-id="40b2b-141">錯誤識別碼可以是單一語彙基元，或允許分支上的識別項的檢查點分隔的識別碼。</span><span class="sxs-lookup"><span data-stu-id="40b2b-141">The error identifier can be a single token, or it can be a dot-separated identifier that allows for branching on inspection of the identifier.</span></span> <span data-ttu-id="40b2b-142">請勿使用空格或標點符號錯誤識別項中。</span><span class="sxs-lookup"><span data-stu-id="40b2b-142">Do not use white space or punctuation in the error identifier.</span></span> <span data-ttu-id="40b2b-143">請務必特別是使用逗號;Windows PowerShell 使用逗號來分隔識別碼和 cmdlet 類別名稱。</span><span class="sxs-lookup"><span data-stu-id="40b2b-143">It is especially important not to use a comma; a comma is used by Windows PowerShell to separate the identifier and the cmdlet class name.</span></span>

### <a name="other-information"></a><span data-ttu-id="40b2b-144">其他資訊</span><span class="sxs-lookup"><span data-stu-id="40b2b-144">Other Information</span></span>

<span data-ttu-id="40b2b-145">[System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)物件可能也會提供描述發生錯誤的環境的資訊。</span><span class="sxs-lookup"><span data-stu-id="40b2b-145">The [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object might also provide information that describes the environment in which the error occurred.</span></span> <span data-ttu-id="40b2b-146">這項資訊包括錯誤詳細資料，引動過程的詳細資訊，並發生錯誤時正在處理的目標物件等項目。</span><span class="sxs-lookup"><span data-stu-id="40b2b-146">This information includes items such as error details, invocation information, and the target object that was being processed when the error occurred.</span></span> <span data-ttu-id="40b2b-147">雖然這項資訊可能很有用，主應用程式，它是不通常用來識別錯誤。</span><span class="sxs-lookup"><span data-stu-id="40b2b-147">Although this information might be useful to the host application, it is not typically used to identify the error.</span></span> <span data-ttu-id="40b2b-148">這項資訊是可透過下列屬性：</span><span class="sxs-lookup"><span data-stu-id="40b2b-148">This information is available through the following properties:</span></span>

[<span data-ttu-id="40b2b-149">System.Management.Automation.ErrorRecord.ErrorDetails</span><span class="sxs-lookup"><span data-stu-id="40b2b-149">System.Management.Automation.ErrorRecord.ErrorDetails</span></span>](/dotnet/api/System.Management.Automation.ErrorRecord.ErrorDetails)

[<span data-ttu-id="40b2b-150">System.Management.Automation.ErrorRecord.InvocationInfo</span><span class="sxs-lookup"><span data-stu-id="40b2b-150">System.Management.Automation.ErrorRecord.InvocationInfo</span></span>](/dotnet/api/System.Management.Automation.ErrorRecord.InvocationInfo)

[<span data-ttu-id="40b2b-151">System.Management.Automation.ErrorRecord.TargetObject</span><span class="sxs-lookup"><span data-stu-id="40b2b-151">System.Management.Automation.ErrorRecord.TargetObject</span></span>](/dotnet/api/System.Management.Automation.ErrorRecord.TargetObject)

## <a name="see-also"></a><span data-ttu-id="40b2b-152">另請參閱</span><span class="sxs-lookup"><span data-stu-id="40b2b-152">See Also</span></span>

[<span data-ttu-id="40b2b-153">System.Management.Automation.ErrorRecord</span><span class="sxs-lookup"><span data-stu-id="40b2b-153">System.Management.Automation.ErrorRecord</span></span>](/dotnet/api/System.Management.Automation.ErrorRecord)

[<span data-ttu-id="40b2b-154">System.Management.Automation.Errorcategory</span><span class="sxs-lookup"><span data-stu-id="40b2b-154">System.Management.Automation.Errorcategory</span></span>](/dotnet/api/System.Management.Automation.ErrorCategory)

[<span data-ttu-id="40b2b-155">System.Management.Automation.Errorcategoryinfo</span><span class="sxs-lookup"><span data-stu-id="40b2b-155">System.Management.Automation.Errorcategoryinfo</span></span>](/dotnet/api/System.Management.Automation.ErrorCategoryInfo)

[<span data-ttu-id="40b2b-156">System.Management.Automation.Cmdlet.WriteError</span><span class="sxs-lookup"><span data-stu-id="40b2b-156">System.Management.Automation.Cmdlet.WriteError</span></span>](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)

[<span data-ttu-id="40b2b-157">System.Management.Automation.Cmdlet.Throwterminatingerror\*</span><span class="sxs-lookup"><span data-stu-id="40b2b-157">System.Management.Automation.Cmdlet.Throwterminatingerror\*</span></span>](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)

[<span data-ttu-id="40b2b-158">新增非終止錯誤報告到您的 Cmdlet</span><span class="sxs-lookup"><span data-stu-id="40b2b-158">Adding Non-Terminating Error Reporting to Your Cmdlet</span></span>](./adding-non-terminating-error-reporting-to-your-cmdlet.md)

[<span data-ttu-id="40b2b-159">Windows PowerShell 的錯誤報告</span><span class="sxs-lookup"><span data-stu-id="40b2b-159">Windows PowerShell Error Reporting</span></span>](./error-reporting-concepts.md)

[<span data-ttu-id="40b2b-160">撰寫 Windows PowerShell Cmdlet</span><span class="sxs-lookup"><span data-stu-id="40b2b-160">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)
