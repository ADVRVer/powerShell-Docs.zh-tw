---
title: 設計您的 Windows PowerShell 提供者 |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- providers [PowerShell Programmer's Guide], designing
ms.assetid: 11d20319-cc40-4227-b810-4af33372b182
caps.latest.revision: 10
ms.openlocfilehash: 711a85e9b2eade7b9095d7560f53610e709e380a
ms.sourcegitcommit: 69abc5ad16e5dd29ddfb1853e266a4bfd1d59d59
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/05/2019
ms.locfileid: "57429936"
---
# <a name="designing-your-windows-powershell-provider"></a><span data-ttu-id="0bc45-102">設計 Windows PowerShell 提供者</span><span class="sxs-lookup"><span data-stu-id="0bc45-102">Designing Your Windows PowerShell Provider</span></span>

<span data-ttu-id="0bc45-103">如果您的產品或組態會公開一組預存的資料，例如，使用者會想要瀏覽，或瀏覽資料庫，您應該實作的 Windows PowerShell 提供者。</span><span class="sxs-lookup"><span data-stu-id="0bc45-103">You should implement a Windows PowerShell provider if your product or configuration exposes a set of stored data, such as a database that the user will want to navigate or browse.</span></span> <span data-ttu-id="0bc45-104">此外，如果您的產品會提供一種容器，即使它不是多層級的容器，合理來實作 Windows PowerShell 提供者。</span><span class="sxs-lookup"><span data-stu-id="0bc45-104">Additionally, if your product provides a container, even if it is not a multilevel container, it makes sense to implement a Windows PowerShell provider.</span></span> <span data-ttu-id="0bc45-105">比方說，您可能要實作的 Windows PowerShell 容器提供者 cmdlet 動詞命令複製、 移動、 新增、 重新命名或移除有意義的話會以對產品或組態資料作業。</span><span class="sxs-lookup"><span data-stu-id="0bc45-105">For example, you might want to implement a Windows PowerShell container provider if the cmdlet verb Copy, Move, Rename, New, or Remove makes sense as an operation on your product or configuration data.</span></span>

## <a name="windows-powershell-paths-identify-your-provider"></a><span data-ttu-id="0bc45-106">Windows PowerShell 路徑找出您的提供者</span><span class="sxs-lookup"><span data-stu-id="0bc45-106">Windows PowerShell Paths Identify Your Provider</span></span>

<span data-ttu-id="0bc45-107">Windows PowerShell 執行階段會使用 Windows PowerShell 路徑來存取適當的 Windows PowerShell 提供者。</span><span class="sxs-lookup"><span data-stu-id="0bc45-107">The Windows PowerShell runtime uses Windows PowerShell paths to access the appropriate Windows PowerShell provider.</span></span> <span data-ttu-id="0bc45-108">當指令程式指定其中一個路徑時，執行階段就會知道用來存取相關聯的資料存放區的提供者。</span><span class="sxs-lookup"><span data-stu-id="0bc45-108">When a cmdlet specifies one of these paths, the runtime knows which provider to use to access the associated data store.</span></span> <span data-ttu-id="0bc45-109">這些路徑包括磁碟機限定路徑、 提供者限定路徑、 提供者直接路徑，與內部提供者路徑。</span><span class="sxs-lookup"><span data-stu-id="0bc45-109">These paths include drive-qualified paths, provider-qualified paths, provider-direct paths, and provider-internal paths.</span></span> <span data-ttu-id="0bc45-110">每個 Windows PowerShell 提供者必須支援一或多個這些路徑。</span><span class="sxs-lookup"><span data-stu-id="0bc45-110">Each Windows PowerShell provider must support one or more of these paths.</span></span>

<span data-ttu-id="0bc45-111">如需有關 Windows PowerShell 路徑的詳細資訊，請參閱 < Windows PowerShell 的運作方式。</span><span class="sxs-lookup"><span data-stu-id="0bc45-111">For more information about Windows PowerShell paths, see How Windows PowerShell Works.</span></span>

### <a name="defining-a-drive-qualified-path"></a><span data-ttu-id="0bc45-112">定義磁碟機限定路徑</span><span class="sxs-lookup"><span data-stu-id="0bc45-112">Defining a Drive-Qualified Path</span></span>

<span data-ttu-id="0bc45-113">若要允許使用者存取位於實體磁碟機的資料，您的 Windows PowerShell 提供者必須支援的磁碟機限定的路徑。</span><span class="sxs-lookup"><span data-stu-id="0bc45-113">To allow the user to access data located at a physical drive, your Windows PowerShell provider must support a drive-qualified path.</span></span> <span data-ttu-id="0bc45-114">此路徑的開頭加上冒號 （:），例如 mydrive:\abc\bar 的磁碟機名稱。</span><span class="sxs-lookup"><span data-stu-id="0bc45-114">This path starts with the drive name followed by a colon (:), for example, mydrive:\abc\bar.</span></span>

### <a name="defining-a-provider-qualified-path"></a><span data-ttu-id="0bc45-115">定義提供者限定路徑</span><span class="sxs-lookup"><span data-stu-id="0bc45-115">Defining a Provider-Qualified Path</span></span>

<span data-ttu-id="0bc45-116">若要允許的 Windows PowerShell 執行階段，以初始化並取消初始化提供者，您的 Windows PowerShell 提供者必須支援的提供者限定的路徑。</span><span class="sxs-lookup"><span data-stu-id="0bc45-116">To allow the Windows PowerShell runtime to initialize and uninitialize the provider, your Windows PowerShell provider must support a provider-qualified path.</span></span> <span data-ttu-id="0bc45-117">例如，檔案系統::\\\uncshare\abc\bar 是彙編 Windows powershell filesystem 提供者的提供者限定路徑。</span><span class="sxs-lookup"><span data-stu-id="0bc45-117">For example, FileSystem::\\\uncshare\abc\bar is the provider-qualified path for the filesystem provider furnished by Windows PowerShell.</span></span>

### <a name="defining-a-provider-direct-path"></a><span data-ttu-id="0bc45-118">定義提供者直接路徑</span><span class="sxs-lookup"><span data-stu-id="0bc45-118">Defining a Provider-Direct Path</span></span>

<span data-ttu-id="0bc45-119">若要允許遠端存取您的 Windows PowerShell 提供者，它應該支援的提供者直接路徑，直接傳遞至 Windows PowerShell 提供者目前的位置。</span><span class="sxs-lookup"><span data-stu-id="0bc45-119">To allow remote access to your Windows PowerShell provider, it should support a provider-direct path to pass directly to the Windows PowerShell provider for the current location.</span></span> <span data-ttu-id="0bc45-120">比方說，可以使用登錄 Windows PowerShell 提供者\\\server\regkeypath 為提供者直接路徑。</span><span class="sxs-lookup"><span data-stu-id="0bc45-120">For example, the registry Windows PowerShell provider can use \\\server\regkeypath as a provider-direct path.</span></span>

### <a name="defining-a-provider-internal-path"></a><span data-ttu-id="0bc45-121">定義提供者內部的路徑</span><span class="sxs-lookup"><span data-stu-id="0bc45-121">Defining a Provider-Internal Path</span></span>

<span data-ttu-id="0bc45-122">若要允許使用非 Windows PowerShell 應用程式開發介面 (Api) 來存取資料提供者 cmdlet，您的 Windows PowerShell 提供者應該支援的提供者內部的路徑。</span><span class="sxs-lookup"><span data-stu-id="0bc45-122">To allow the provider cmdlet to access data using non-Windows PowerShell application programming interfaces (APIs), your Windows PowerShell provider should support a provider-internal path.</span></span> <span data-ttu-id="0bc45-123">此路徑會指出之後":: 「 提供者限定路徑中。</span><span class="sxs-lookup"><span data-stu-id="0bc45-123">This path is indicated after the "::" in the provider-qualified path.</span></span> <span data-ttu-id="0bc45-124">例如，filesystem Windows PowerShell 提供者的提供者內部路徑是\\\uncshare\abc\bar。</span><span class="sxs-lookup"><span data-stu-id="0bc45-124">For example, the provider-internal path for the filesystem Windows PowerShell provider is \\\uncshare\abc\bar.</span></span>

## <a name="changing-stored-data"></a><span data-ttu-id="0bc45-125">變更預存的資料</span><span class="sxs-lookup"><span data-stu-id="0bc45-125">Changing Stored Data</span></span>

<span data-ttu-id="0bc45-126">當覆寫修改基礎資料存放區的方法，務必呼叫[System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject)所變更之項目的最新版本的方法方法。</span><span class="sxs-lookup"><span data-stu-id="0bc45-126">When overriding methods that modify the underlying data store, always call the [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) method with the most up-to-date version of the item changed by that method.</span></span> <span data-ttu-id="0bc45-127">提供者基礎結構會判斷要傳遞到管線中，例如當使用者指定-PassThru 參數時是否需要的項目物件。</span><span class="sxs-lookup"><span data-stu-id="0bc45-127">The provider infrastructure determines if the item object needs to be passed to the pipeline, such as when the user specifies the -PassThru parameter.</span></span> <span data-ttu-id="0bc45-128">如果擷取的最新的項目 （此舉） 是昂貴的作業，您可以測試 Context.PassThru 屬性來判斷您是否真的需要將產生的項目寫入。</span><span class="sxs-lookup"><span data-stu-id="0bc45-128">If retrieving the most up-to-date item is a costly operation (performance-wise,) you can test the Context.PassThru property to determine if you actually need to write the resulting item.</span></span>

## <a name="choose-a-base-class-for-your-provider"></a><span data-ttu-id="0bc45-129">選擇您的提供者的基底類別</span><span class="sxs-lookup"><span data-stu-id="0bc45-129">Choose a Base Class for Your Provider</span></span>

<span data-ttu-id="0bc45-130">Windows PowerShell 提供幾個可用來實作您自己的 Windows PowerShell 提供者的基底類別。</span><span class="sxs-lookup"><span data-stu-id="0bc45-130">Windows PowerShell provides a number of base classes that you can use to implement your own Windows PowerShell provider.</span></span> <span data-ttu-id="0bc45-131">當設計提供者，請選擇 基底類別，此區段中，最適合您的需求中所述。</span><span class="sxs-lookup"><span data-stu-id="0bc45-131">When designing a provider, choose the base class, described in this section, that is most suited to your requirements.</span></span>

<span data-ttu-id="0bc45-132">每個 Windows PowerShell 提供者的基底類別提供一組指令程式。</span><span class="sxs-lookup"><span data-stu-id="0bc45-132">Each Windows PowerShell provider base class makes available a set of cmdlets.</span></span> <span data-ttu-id="0bc45-133">本章節描述 cmdlet，但它不會描述其參數。</span><span class="sxs-lookup"><span data-stu-id="0bc45-133">This section describes the cmdlets, but it does not describe their parameters.</span></span>

<span data-ttu-id="0bc45-134">使用工作階段狀態，Windows PowerShell 執行階段提供數個位置 cmdlet 到特定的 Windows PowerShell 提供者，例如`Get-Location`， `Set-Location`， `Pop-Location`，和`Push-Location`cmdlet。</span><span class="sxs-lookup"><span data-stu-id="0bc45-134">Using the session state, the Windows PowerShell runtime makes several location cmdlets available to certain Windows PowerShell providers, such as the `Get-Location`, `Set-Location`, `Pop-Location`, and `Push-Location` cmdlets.</span></span> <span data-ttu-id="0bc45-135">您可以使用`Get-Help`cmdlet 來取得這些 location cmdlet 的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="0bc45-135">You can use the `Get-Help` cmdlet to obtain information about these location cmdlets.</span></span>

### <a name="cmdletprovider-base-class"></a><span data-ttu-id="0bc45-136">CmdletProvider 基底類別</span><span class="sxs-lookup"><span data-stu-id="0bc45-136">CmdletProvider Base Class</span></span>

<span data-ttu-id="0bc45-137">[System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider)類別會定義基本的 Windows PowerShell 提供者。</span><span class="sxs-lookup"><span data-stu-id="0bc45-137">The [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) class defines a basic Windows PowerShell provider.</span></span> <span data-ttu-id="0bc45-138">這個類別支援的提供者宣告，而且提供了許多的屬性和方法可用於所有 Windows PowerShell 提供者。</span><span class="sxs-lookup"><span data-stu-id="0bc45-138">This class supports the provider declaration and supplies a number of properties and methods that are available to all Windows PowerShell providers.</span></span> <span data-ttu-id="0bc45-139">類別由`Get-PSProvider`cmdlet 來列出所有可用的提供者工作階段。</span><span class="sxs-lookup"><span data-stu-id="0bc45-139">The class is invoked by the `Get-PSProvider` cmdlet to list all available providers for a session.</span></span> <span data-ttu-id="0bc45-140">這個指令程式的實作是由工作階段狀態提供。</span><span class="sxs-lookup"><span data-stu-id="0bc45-140">The implementation of this cmdlet is furnished by the session state.</span></span>

> [!NOTE]
> <span data-ttu-id="0bc45-141">Windows PowerShell 提供者可供所有 Windows PowerShell 語言的領域。</span><span class="sxs-lookup"><span data-stu-id="0bc45-141">Windows PowerShell providers are available to all Windows PowerShell language scopes.</span></span>

### <a name="drivecmdletprovider-base-class"></a><span data-ttu-id="0bc45-142">DriveCmdletProvider 基底類別</span><span class="sxs-lookup"><span data-stu-id="0bc45-142">DriveCmdletProvider Base Class</span></span>

<span data-ttu-id="0bc45-143">[System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider)類別會定義 Windows PowerShell 磁碟機提供者支援為加入新的磁碟機、 移除現有的磁碟機，並初始化預設磁碟機的作業。</span><span class="sxs-lookup"><span data-stu-id="0bc45-143">The [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) class defines a Windows PowerShell drive provider that supports operations for adding new drives, removing existing drives, and initializing default drives.</span></span> <span data-ttu-id="0bc45-144">比方說，提供 Windows powershell FileSystem 提供者初始化所裝載，例如硬碟機和 CD/DVD 裝置磁碟機的所有磁碟區的磁碟機。</span><span class="sxs-lookup"><span data-stu-id="0bc45-144">For example, the FileSystem provider provided by Windows PowerShell initializes drives for all volumes that are mounted, such as hard drives and CD/DVD device drives.</span></span>

<span data-ttu-id="0bc45-145">這個類別衍生自[System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider)基底類別。</span><span class="sxs-lookup"><span data-stu-id="0bc45-145">This class derives from the [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) base class.</span></span> <span data-ttu-id="0bc45-146">下表列出這個類別所公開的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="0bc45-146">The following table lists the cmdlets exposed by this class.</span></span> <span data-ttu-id="0bc45-147">除了所列， `Get-PSDrive` （由工作階段狀態） 的 cmdlet 是用來擷取可用的磁碟機的相關的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="0bc45-147">In addition to those listed, the `Get-PSDrive` cmdlet (exposed by session state) is a related cmdlet that is used to retrieve available drives.</span></span>

|<span data-ttu-id="0bc45-148">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="0bc45-148">Cmdlet</span></span>|<span data-ttu-id="0bc45-149">定義</span><span class="sxs-lookup"><span data-stu-id="0bc45-149">Definition</span></span>|
|------------|----------------|
|`New-PSDrive`|<span data-ttu-id="0bc45-150">工作階段中，建立新的磁碟機，及資料流的磁碟機資訊。</span><span class="sxs-lookup"><span data-stu-id="0bc45-150">Creates a new drive for the session, and streams drive information.</span></span>|
|`Remove-PSDrive`|<span data-ttu-id="0bc45-151">從工作階段中移除的磁碟機。</span><span class="sxs-lookup"><span data-stu-id="0bc45-151">Removes a drive from the session.</span></span>|

### <a name="itemcmdletprovider-base-class"></a><span data-ttu-id="0bc45-152">ItemCmdletProvider 基底類別</span><span class="sxs-lookup"><span data-stu-id="0bc45-152">ItemCmdletProvider Base Class</span></span>

<span data-ttu-id="0bc45-153">[System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider)類別定義的資料存放區中，個別的項目執行作業的 Windows PowerShell 項目提供者並不會假設任何容器或瀏覽功能。</span><span class="sxs-lookup"><span data-stu-id="0bc45-153">The [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) class defines a Windows PowerShell item provider that performs operations on the individual items of the data store, and it does not assume any container or navigation capabilities.</span></span> <span data-ttu-id="0bc45-154">這個類別衍生自[System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider)基底類別。</span><span class="sxs-lookup"><span data-stu-id="0bc45-154">This class derives from the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class.</span></span> <span data-ttu-id="0bc45-155">下表列出這個類別所公開的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="0bc45-155">The following table lists the cmdlets exposed by this class.</span></span>

|<span data-ttu-id="0bc45-156">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="0bc45-156">Cmdlet</span></span>|<span data-ttu-id="0bc45-157">定義</span><span class="sxs-lookup"><span data-stu-id="0bc45-157">Definition</span></span>|
|------------|----------------|
|`Clear-Item`|<span data-ttu-id="0bc45-158">清除目前內容的指定位置的項目，並取代"clear"的值，指定提供者。</span><span class="sxs-lookup"><span data-stu-id="0bc45-158">Clears the current content of items at the specified location, and replaces it with the "clear" value specified by the provider.</span></span> <span data-ttu-id="0bc45-159">此 cmdlet 未通過管線的輸出物件，除非其`PassThru`指定參數。</span><span class="sxs-lookup"><span data-stu-id="0bc45-159">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|
|`Get-Item`|<span data-ttu-id="0bc45-160">從指定的位置，擷取項目及資料流結果物件。</span><span class="sxs-lookup"><span data-stu-id="0bc45-160">Retrieves items from the specified location, and streams the resultant objects.</span></span>|
|`Invoke-Item`|<span data-ttu-id="0bc45-161">叫用的項目位於指定路徑的預設動作。</span><span class="sxs-lookup"><span data-stu-id="0bc45-161">Invokes the default action for the item at the specified path.</span></span>|
|`Set-Item`|<span data-ttu-id="0bc45-162">在指定的值與指定的位置設定的項目。</span><span class="sxs-lookup"><span data-stu-id="0bc45-162">Sets an item at the specified location with the indicated value.</span></span> <span data-ttu-id="0bc45-163">此 cmdlet 未通過管線的輸出物件，除非其`PassThru`指定參數。</span><span class="sxs-lookup"><span data-stu-id="0bc45-163">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|
|`Resolve-Path`|<span data-ttu-id="0bc45-164">解析的 Windows PowerShell 路徑和資料流路徑資訊的萬用字元。</span><span class="sxs-lookup"><span data-stu-id="0bc45-164">Resolves the wildcards for a Windows PowerShell path, and streams path information.</span></span>|
|`Test-Path`|<span data-ttu-id="0bc45-165">測試指定的路徑，並傳回`true`若有的話，`false`否則。</span><span class="sxs-lookup"><span data-stu-id="0bc45-165">Tests for the specified path, and returns `true` if it exists and `false` otherwise.</span></span> <span data-ttu-id="0bc45-166">此 cmdlet 實作以支援`IsContainer`參數[System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject)方法。</span><span class="sxs-lookup"><span data-stu-id="0bc45-166">This cmdlet is implemented to support the `IsContainer` parameter for the [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) method.</span></span>|

### <a name="containercmdletprovider-base-class"></a><span data-ttu-id="0bc45-167">ContainerCmdletProvider 基底類別</span><span class="sxs-lookup"><span data-stu-id="0bc45-167">ContainerCmdletProvider Base Class</span></span>

<span data-ttu-id="0bc45-168">[System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider)類別定義，資料存放區項目的容器，向使用者公開 （expose） 的 Windows PowerShell 容器提供者。</span><span class="sxs-lookup"><span data-stu-id="0bc45-168">The [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) class defines a Windows PowerShell container provider that exposes a container, for data store items, to the user.</span></span> <span data-ttu-id="0bc45-169">請注意一個容器 （沒有巢狀容器），在它的項目時，可以使用 Windows PowerShell 容器提供者。</span><span class="sxs-lookup"><span data-stu-id="0bc45-169">Be aware that a Windows PowerShell container provider can be used only when there is one container (no nested containers) with items in it.</span></span> <span data-ttu-id="0bc45-170">如果沒有巢狀的容器，您必須實作的 Windows PowerShell 巡覽提供者。</span><span class="sxs-lookup"><span data-stu-id="0bc45-170">If there are nested containers, then you must implement a Windows PowerShell navigation provider .</span></span>

<span data-ttu-id="0bc45-171">這個類別衍生自[System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider)基底類別。</span><span class="sxs-lookup"><span data-stu-id="0bc45-171">This class derives from the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="0bc45-172">下表定義這個類別所實作的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="0bc45-172">The following table defines the cmdlets implemented by this class.</span></span>

|<span data-ttu-id="0bc45-173">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="0bc45-173">Cmdlet</span></span>|<span data-ttu-id="0bc45-174">定義</span><span class="sxs-lookup"><span data-stu-id="0bc45-174">Definition</span></span>|
|------------|----------------|
|`Copy-Item`|<span data-ttu-id="0bc45-175">將項目從一個位置到另一個。</span><span class="sxs-lookup"><span data-stu-id="0bc45-175">Copies items from one location to another.</span></span> <span data-ttu-id="0bc45-176">此 cmdlet 未通過管線的輸出物件，除非其`PassThru`指定參數。</span><span class="sxs-lookup"><span data-stu-id="0bc45-176">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|
|`Get-Childitem`|<span data-ttu-id="0bc45-177">擷取的子系項目，在指定的位置，並將它們串流做為物件。</span><span class="sxs-lookup"><span data-stu-id="0bc45-177">Retrieves the child items at the specified location, and streams them as objects.</span></span>|
|`New-Item`|<span data-ttu-id="0bc45-178">在指定的位置，建立新的項目及資料流結果物件。</span><span class="sxs-lookup"><span data-stu-id="0bc45-178">Creates new items at the specified location, and streams the resultant object.</span></span>|
|`Remove-Item`|<span data-ttu-id="0bc45-179">從指定的位置移除項目。</span><span class="sxs-lookup"><span data-stu-id="0bc45-179">Removes items from the specified location.</span></span>|
|`Rename-Item`|<span data-ttu-id="0bc45-180">重新命名指定的位置處的項目。</span><span class="sxs-lookup"><span data-stu-id="0bc45-180">Renames an item at the specified location.</span></span> <span data-ttu-id="0bc45-181">此 cmdlet 未通過管線的輸出物件，除非其`PassThru`指定參數。</span><span class="sxs-lookup"><span data-stu-id="0bc45-181">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|

### <a name="navigationcmdletprovider-base-class"></a><span data-ttu-id="0bc45-182">NavigationCmdletProvider 基底類別</span><span class="sxs-lookup"><span data-stu-id="0bc45-182">NavigationCmdletProvider Base Class</span></span>

<span data-ttu-id="0bc45-183">[System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider)類別會定義 Windows PowerShell 巡覽提供者，以執行作業使用多個容器的項目。</span><span class="sxs-lookup"><span data-stu-id="0bc45-183">The [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) class defines a Windows PowerShell navigation provider that performs operations for items that use more than one container.</span></span> <span data-ttu-id="0bc45-184">這個類別衍生自[System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider)基底類別。</span><span class="sxs-lookup"><span data-stu-id="0bc45-184">This class derives from the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) base class.</span></span> <span data-ttu-id="0bc45-185">下表列出這個類別所公開的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="0bc45-185">The following table list the cmdlets exposed by this class.</span></span>

|<span data-ttu-id="0bc45-186">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="0bc45-186">Cmdlet</span></span>|<span data-ttu-id="0bc45-187">定義</span><span class="sxs-lookup"><span data-stu-id="0bc45-187">Definition</span></span>|
|------------|----------------|
|<span data-ttu-id="0bc45-188">Combine-Path</span><span class="sxs-lookup"><span data-stu-id="0bc45-188">Combine-Path</span></span>|<span data-ttu-id="0bc45-189">合併成單一路徑，使用特定提供者路徑之間分隔符號的兩個路徑。</span><span class="sxs-lookup"><span data-stu-id="0bc45-189">Combines two paths into a single path, using a provider-specific delimiter between paths.</span></span> <span data-ttu-id="0bc45-190">這個指令程式串流處理字串。</span><span class="sxs-lookup"><span data-stu-id="0bc45-190">This cmdlet streams strings.</span></span>|
|`Move-Item`|<span data-ttu-id="0bc45-191">將項目移到指定的位置。</span><span class="sxs-lookup"><span data-stu-id="0bc45-191">Moves items to the specified location.</span></span> <span data-ttu-id="0bc45-192">此 cmdlet 未通過管線的輸出物件，除非其`PassThru`指定參數。</span><span class="sxs-lookup"><span data-stu-id="0bc45-192">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|

<span data-ttu-id="0bc45-193">相關的 cmdlet 是 Windows powershell 提供基本的剖析路徑 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="0bc45-193">A related cmdlet is the basic Parse-Path cmdlet furnished by Windows PowerShell.</span></span> <span data-ttu-id="0bc45-194">此 cmdlet 可用來剖析支援的 Windows PowerShell 路徑`Parent`參數。</span><span class="sxs-lookup"><span data-stu-id="0bc45-194">This cmdlet can be used to parse a Windows PowerShell path to support the `Parent` parameter.</span></span> <span data-ttu-id="0bc45-195">資料流處理的父路徑的字串。</span><span class="sxs-lookup"><span data-stu-id="0bc45-195">It streams the parent path string.</span></span>

## <a name="select-provider-interfaces-to-support"></a><span data-ttu-id="0bc45-196">選擇要支援的提供者介面</span><span class="sxs-lookup"><span data-stu-id="0bc45-196">Select Provider Interfaces to Support</span></span>

<span data-ttu-id="0bc45-197">除了衍生自其中一個 Windows PowerShell 的基底類別，您的 Windows PowerShell 提供者可以藉由衍生自一或多個下列的提供者介面支援其他功能。</span><span class="sxs-lookup"><span data-stu-id="0bc45-197">In addition to deriving from one of the Windows PowerShell base classes, your Windows PowerShell provider can support other functionality by deriving from one or more of the following provider interfaces.</span></span> <span data-ttu-id="0bc45-198">此區段會定義這些介面和支援的每個 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="0bc45-198">This section defines those interfaces and the cmdlets supported by each.</span></span> <span data-ttu-id="0bc45-199">它不會描述介面支援 cmdlet 的參數。</span><span class="sxs-lookup"><span data-stu-id="0bc45-199">It does not describe the parameters for the interface-supported cmdlets.</span></span> <span data-ttu-id="0bc45-200">Cmdlet 參數資訊，可使用線上`Get-Command`和`Get-Help`cmdlet。</span><span class="sxs-lookup"><span data-stu-id="0bc45-200">Cmdlet parameter information is available online using the `Get-Command` and `Get-Help` cmdlets.</span></span>

### <a name="icontentcmdletprovider"></a><span data-ttu-id="0bc45-201">IContentCmdletProvider</span><span class="sxs-lookup"><span data-stu-id="0bc45-201">IContentCmdletProvider</span></span>

<span data-ttu-id="0bc45-202">[System.Management.Automation.Provider.Icontentcmdletprovider](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider)介面會定義內容提供者上執行作業內容的資料項目。</span><span class="sxs-lookup"><span data-stu-id="0bc45-202">The [System.Management.Automation.Provider.Icontentcmdletprovider](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider) interface defines a content provider that performs operations on the content of a data item.</span></span> <span data-ttu-id="0bc45-203">下表列出此介面所公開的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="0bc45-203">The following table lists the cmdlets exposed by this interface.</span></span>

|<span data-ttu-id="0bc45-204">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="0bc45-204">Cmdlet</span></span>|<span data-ttu-id="0bc45-205">定義</span><span class="sxs-lookup"><span data-stu-id="0bc45-205">Definition</span></span>|
|------------|----------------|
|`Add-Content`|<span data-ttu-id="0bc45-206">將指定的值長度附加至指定的項目內容。</span><span class="sxs-lookup"><span data-stu-id="0bc45-206">Appends the indicated value lengths to the contents of the specified item.</span></span> <span data-ttu-id="0bc45-207">此 cmdlet 未通過管線的輸出物件，除非其`PassThru`指定參數。</span><span class="sxs-lookup"><span data-stu-id="0bc45-207">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|
|`Clear-Content`|<span data-ttu-id="0bc45-208">將指定項目的內容設定為"clear"的值。</span><span class="sxs-lookup"><span data-stu-id="0bc45-208">Sets the content of the specified item to the "clear" value.</span></span> <span data-ttu-id="0bc45-209">此 cmdlet 未通過管線的輸出物件，除非其`PassThru`指定參數。</span><span class="sxs-lookup"><span data-stu-id="0bc45-209">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|
|`Get-Content`|<span data-ttu-id="0bc45-210">擷取指定的項目內容及資料流結果物件。</span><span class="sxs-lookup"><span data-stu-id="0bc45-210">Retrieves the contents of the specified items and streams the resultant objects.</span></span>|
|`Set-Content`|<span data-ttu-id="0bc45-211">取代現有的內容，針對指定的項目。</span><span class="sxs-lookup"><span data-stu-id="0bc45-211">Replaces the existing content for the specified items.</span></span> <span data-ttu-id="0bc45-212">此 cmdlet 未通過管線的輸出物件，除非其`PassThru`指定參數。</span><span class="sxs-lookup"><span data-stu-id="0bc45-212">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|

### <a name="ipropertycmdletprovider"></a><span data-ttu-id="0bc45-213">IPropertyCmdletProvider</span><span class="sxs-lookup"><span data-stu-id="0bc45-213">IPropertyCmdletProvider</span></span>

<span data-ttu-id="0bc45-214">[System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider)介面會定義屬性的 Windows PowerShell 提供者執行的項目屬性的作業資料存放區中。</span><span class="sxs-lookup"><span data-stu-id="0bc45-214">The [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface defines a property Windows PowerShell provider that performs operations on the properties of items in the data store.</span></span> <span data-ttu-id="0bc45-215">下表列出此介面所公開的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="0bc45-215">The following table lists the cmdlets exposed by this interface.</span></span>

> [!NOTE]
> <span data-ttu-id="0bc45-216">`Path`需這些 cmdlet 的參數表示的項目，而不是識別屬性的路徑。</span><span class="sxs-lookup"><span data-stu-id="0bc45-216">The `Path` parameter on these cmdlets indicates a path to an item instead of identifying a property.</span></span>

|<span data-ttu-id="0bc45-217">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="0bc45-217">Cmdlet</span></span>|<span data-ttu-id="0bc45-218">定義</span><span class="sxs-lookup"><span data-stu-id="0bc45-218">Definition</span></span>|
|------------|----------------|
|`Clear-ItemProperty`|<span data-ttu-id="0bc45-219">將指定項目的屬性設定為"clear"的值。</span><span class="sxs-lookup"><span data-stu-id="0bc45-219">Sets properties of the specified items to the "clear" value.</span></span> <span data-ttu-id="0bc45-220">此 cmdlet 未通過管線的輸出物件，除非其`PassThru`指定參數。</span><span class="sxs-lookup"><span data-stu-id="0bc45-220">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|
|`Get-ItemProperty`|<span data-ttu-id="0bc45-221">從指定的項目擷取屬性及資料流結果物件。</span><span class="sxs-lookup"><span data-stu-id="0bc45-221">Retrieves properties from the specified items and streams the resultant objects.</span></span>|
|`Set-ItemProperty`|<span data-ttu-id="0bc45-222">設定指定的項目，以指示的值的屬性。</span><span class="sxs-lookup"><span data-stu-id="0bc45-222">Sets properties of the specified items with the indicated values.</span></span> <span data-ttu-id="0bc45-223">此 cmdlet 未通過管線的輸出物件，除非其`PassThru`指定參數。</span><span class="sxs-lookup"><span data-stu-id="0bc45-223">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|

### <a name="idynamicpropertycmdletprovider"></a><span data-ttu-id="0bc45-224">IDynamicPropertyCmdletProvider</span><span class="sxs-lookup"><span data-stu-id="0bc45-224">IDynamicPropertyCmdletProvider</span></span>

<span data-ttu-id="0bc45-225">[System.Management.Automation.Provider.Idynamicpropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IDynamicPropertyCmdletProvider)介面，衍生自[System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider)，定義提供者來指定其支援的 cmdlet 的動態參數。</span><span class="sxs-lookup"><span data-stu-id="0bc45-225">The [System.Management.Automation.Provider.Idynamicpropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IDynamicPropertyCmdletProvider) interface, derived from [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider), defines a provider that specifies dynamic parameters for its supported cmdlets.</span></span> <span data-ttu-id="0bc45-226">這種類型的提供者處理為其屬性可以定義在執行階段，比方說，新的屬性作業的作業。</span><span class="sxs-lookup"><span data-stu-id="0bc45-226">This type of provider handles operations for which properties can be defined at run time, for example, a new property operation.</span></span> <span data-ttu-id="0bc45-227">無法以靜態方式定義屬性的項目上，可能發生這類作業。</span><span class="sxs-lookup"><span data-stu-id="0bc45-227">Such operations are not possible on items having statically defined properties.</span></span> <span data-ttu-id="0bc45-228">下表列出此介面所公開的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="0bc45-228">The following table lists the cmdlets exposed by this interface.</span></span>

|<span data-ttu-id="0bc45-229">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="0bc45-229">Cmdlet</span></span>|<span data-ttu-id="0bc45-230">定義</span><span class="sxs-lookup"><span data-stu-id="0bc45-230">Definition</span></span>|
|------------|----------------|
|`Copy-ItemProperty`|<span data-ttu-id="0bc45-231">將屬性從指定的項目複製到另一個項目。</span><span class="sxs-lookup"><span data-stu-id="0bc45-231">Copies a property from the specified item to another item.</span></span> <span data-ttu-id="0bc45-232">此 cmdlet 未通過管線的輸出物件，除非其`PassThru`指定參數。</span><span class="sxs-lookup"><span data-stu-id="0bc45-232">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|
|`Move-ItemProperty`|<span data-ttu-id="0bc45-233">將屬性從指定的項目移至另一個項目。</span><span class="sxs-lookup"><span data-stu-id="0bc45-233">Moves a property from the specified item to another item.</span></span> <span data-ttu-id="0bc45-234">此 cmdlet 未通過管線的輸出物件，除非其`PassThru`指定參數。</span><span class="sxs-lookup"><span data-stu-id="0bc45-234">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|
|`New-ItemProperty`|<span data-ttu-id="0bc45-235">建立屬性上指定的項目，並串流處理結果的物件。</span><span class="sxs-lookup"><span data-stu-id="0bc45-235">Creates a property on the specified items and streams the resultant objects.</span></span>|
|`Remove-ItemProperty`|<span data-ttu-id="0bc45-236">移除指定的項目屬性。</span><span class="sxs-lookup"><span data-stu-id="0bc45-236">Removes a property for the specified items.</span></span>|
|`Rename-ItemProperty`|<span data-ttu-id="0bc45-237">重新命名屬性，以指定的項目。</span><span class="sxs-lookup"><span data-stu-id="0bc45-237">Renames a property of the specified items.</span></span> <span data-ttu-id="0bc45-238">此 cmdlet 未通過管線的輸出物件，除非其`PassThru`指定參數。</span><span class="sxs-lookup"><span data-stu-id="0bc45-238">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|

### <a name="isecuritydescriptorcmdletprovider"></a><span data-ttu-id="0bc45-239">ISecurityDescriptorCmdletProvider</span><span class="sxs-lookup"><span data-stu-id="0bc45-239">ISecurityDescriptorCmdletProvider</span></span>

<span data-ttu-id="0bc45-240">[System.Management.Automation.Provider.Isecuritydescriptorcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ISecurityDescriptorCmdletProvider)介面新增至提供者的安全性描述元的功能。</span><span class="sxs-lookup"><span data-stu-id="0bc45-240">The [System.Management.Automation.Provider.Isecuritydescriptorcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ISecurityDescriptorCmdletProvider) interface adds security descriptor functionality to a provider.</span></span> <span data-ttu-id="0bc45-241">此介面可讓使用者取得和設定資料存放區中的項目之安全性描述元資訊。</span><span class="sxs-lookup"><span data-stu-id="0bc45-241">This interface allows the user to get and set security descriptor information for an item in the data store.</span></span> <span data-ttu-id="0bc45-242">下表列出此介面所公開的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="0bc45-242">The following table lists the cmdlets exposed by this interface.</span></span>

|<span data-ttu-id="0bc45-243">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="0bc45-243">Cmdlet</span></span>|<span data-ttu-id="0bc45-244">定義</span><span class="sxs-lookup"><span data-stu-id="0bc45-244">Definition</span></span>|
|------------|----------------|
|`Get-Acl`|<span data-ttu-id="0bc45-245">擷取存取控制清單 (ACL)，也就是用來保護作業系統資源，例如安全性描述元、 檔案或物件的組件中所包含的資訊。</span><span class="sxs-lookup"><span data-stu-id="0bc45-245">Retrieves the information contained in an access control list (ACL), which is part of a security descriptor used to guard operating system resources, for example, a file or an object.</span></span>|
|`Set-Acl`|<span data-ttu-id="0bc45-246">設定 ACL 的資訊。</span><span class="sxs-lookup"><span data-stu-id="0bc45-246">Sets the information for an ACL.</span></span> <span data-ttu-id="0bc45-247">它的執行個體的格式[System.Security.Accesscontrol.Objectsecurity](/dotnet/api/System.Security.AccessControl.ObjectSecurity)上指定路徑所指定的項目。</span><span class="sxs-lookup"><span data-stu-id="0bc45-247">It is in the form of an instance of [System.Security.Accesscontrol.Objectsecurity](/dotnet/api/System.Security.AccessControl.ObjectSecurity) on the item(s) designated for the specified path.</span></span> <span data-ttu-id="0bc45-248">這個指令程式可以在登錄或任何其他提供者項目設定檔、 金鑰和子機碼的相關資訊，如果 Windows PowerShell 提供者支援的安全性資訊的設定。</span><span class="sxs-lookup"><span data-stu-id="0bc45-248">This cmdlet can set information about files, keys, and subkeys in the registry, or any other provider item, if the Windows PowerShell provider supports the setting of security information.</span></span>|

## <a name="see-also"></a><span data-ttu-id="0bc45-249">另請參閱</span><span class="sxs-lookup"><span data-stu-id="0bc45-249">See Also</span></span>

[<span data-ttu-id="0bc45-250">建立 Windows PowerShell 提供者</span><span class="sxs-lookup"><span data-stu-id="0bc45-250">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="0bc45-251">Windows PowerShell 的運作方式</span><span class="sxs-lookup"><span data-stu-id="0bc45-251">How Windows PowerShell Works</span></span>](http://msdn.microsoft.com/en-us/ced30e23-10af-4700-8933-49873bd84d58)

[<span data-ttu-id="0bc45-252">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="0bc45-252">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)