---
title: 建立 Windows PowerShell 屬性提供者 |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- property providers [PowerShell Programmer's Guide]
- providers [PowerShell Programmer's Guide], property provider
ms.assetid: a6adca44-b94b-4103-9970-a9b414355e60
caps.latest.revision: 5
ms.openlocfilehash: ade8fbd38e4f4a675e825b0d8850af0379c9d211
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/03/2019
ms.locfileid: "56858894"
---
# <a name="creating-a-windows-powershell-property-provider"></a><span data-ttu-id="95fbc-102">建立 Windows PowerShell 屬性提供者</span><span class="sxs-lookup"><span data-stu-id="95fbc-102">Creating a Windows PowerShell Property Provider</span></span>

<span data-ttu-id="95fbc-103">本主題描述如何建立提供者，可讓使用者管理的資料存放區中的項目屬性。</span><span class="sxs-lookup"><span data-stu-id="95fbc-103">This topic describes how to create a provider that enables the user to manipulate the properties of items in a data store.</span></span> <span data-ttu-id="95fbc-104">如此一來，這種類型的提供者被指 Windows PowerShell 屬性提供者。</span><span class="sxs-lookup"><span data-stu-id="95fbc-104">As a consequence, this type of provider is referred to as a Windows PowerShell property provider.</span></span> <span data-ttu-id="95fbc-105">例如，登錄提供者的登錄機碼項屬性提供 Windows PowerShell 會處理登錄機碼值。</span><span class="sxs-lookup"><span data-stu-id="95fbc-105">For example, the Registry provider provided by Windows PowerShell handles registry key values as properties of the registry key item.</span></span> <span data-ttu-id="95fbc-106">這種類型的提供者必須加入[System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) .NET 類別的實作的介面。</span><span class="sxs-lookup"><span data-stu-id="95fbc-106">This type of provider must add the [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface to the implementation of the .NET class.</span></span>

> [!NOTE]
> <span data-ttu-id="95fbc-107">Windows PowerShell 提供可用來開發 Windows PowerShell 提供者的範本檔案。</span><span class="sxs-lookup"><span data-stu-id="95fbc-107">Windows PowerShell provides a template file that you can use to develop a Windows PowerShell provider.</span></span> <span data-ttu-id="95fbc-108">適用於 Microsoft Windows 軟體開發套件的 Windows Vista 和.NET Framework 3.0 執行階段元件 TemplateProvider.cs 檔案。</span><span class="sxs-lookup"><span data-stu-id="95fbc-108">The TemplateProvider.cs file is available on the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="95fbc-109">如需下載指示，請參閱[如何安裝 Windows PowerShell 並下載 Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk)。</span><span class="sxs-lookup"><span data-stu-id="95fbc-109">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
> <span data-ttu-id="95fbc-110">Windows PowerShell 提供可用來開發 Windows PowerShell 提供者的範本檔案。</span><span class="sxs-lookup"><span data-stu-id="95fbc-110">Windows PowerShell provides a template file that you can use to develop a Windows PowerShell provider.</span></span> <span data-ttu-id="95fbc-111">適用於 Microsoft Windows 軟體開發套件的 Windows Vista 和.NET Framework 3.0 執行階段元件 TemplateProvider.cs 檔案。</span><span class="sxs-lookup"><span data-stu-id="95fbc-111">The TemplateProvider.cs file is available on the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="95fbc-112">如需下載指示，請參閱[如何安裝 Windows PowerShell 並下載 Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk)。</span><span class="sxs-lookup"><span data-stu-id="95fbc-112">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="95fbc-113">下載的範本位於 **\<PowerShell 範例 >** 目錄。</span><span class="sxs-lookup"><span data-stu-id="95fbc-113">The downloaded template is available in the **\<PowerShell Samples>** directory.</span></span> <span data-ttu-id="95fbc-114">您應該建立一份此檔案，並使用複本，用於建立新的 Windows PowerShell 提供者，移除任何您不需要的功能。</span><span class="sxs-lookup"><span data-stu-id="95fbc-114">You should make a copy of this file and use the copy for creating a new Windows PowerShell provider, removing any functionality that you do not need.</span></span>
>
> <span data-ttu-id="95fbc-115">如需有關其他 Windows PowerShell 提供者實作的詳細資訊，請參閱 <<c0> [ 設計您的 Windows PowerShell 提供者](./designing-your-windows-powershell-provider.md)。</span><span class="sxs-lookup"><span data-stu-id="95fbc-115">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

> [!CAUTION]
> <span data-ttu-id="95fbc-116">屬性提供者的方法應該寫入任何物件，使用[System.Management.Automation.Provider.Cmdletprovider.Writepropertyobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WritePropertyObject)方法。</span><span class="sxs-lookup"><span data-stu-id="95fbc-116">The methods of your property provider should write any objects using the [System.Management.Automation.Provider.Cmdletprovider.Writepropertyobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WritePropertyObject) method.</span></span>

<span data-ttu-id="95fbc-117">下列清單包含本主題的章節。</span><span class="sxs-lookup"><span data-stu-id="95fbc-117">The following list contains the sections in this topic.</span></span> <span data-ttu-id="95fbc-118">如果您不熟悉如何撰寫 Windows PowerShell 屬性提供者，請閱讀這項資訊，它會出現的順序。</span><span class="sxs-lookup"><span data-stu-id="95fbc-118">If you are unfamiliar with writing a Windows PowerShell property provider, read this information in the order that it appears.</span></span> <span data-ttu-id="95fbc-119">不過，如果您已熟悉撰寫 Windows PowerShell 屬性提供者，請直接前往您所需要的資訊。</span><span class="sxs-lookup"><span data-stu-id="95fbc-119">However, if you are familiar with writing a Windows PowerShell property provider, please go directly to the information that you need.</span></span>

- [<span data-ttu-id="95fbc-120">定義 Windows PowerShell 提供者</span><span class="sxs-lookup"><span data-stu-id="95fbc-120">Defining the Windows PowerShell Provider</span></span>](#Defining-the-Windows-PowerShell-provider)

- [<span data-ttu-id="95fbc-121">定義基底的功能</span><span class="sxs-lookup"><span data-stu-id="95fbc-121">Defining Base Functionality</span></span>](#Defining-Base-Functionality)

- [<span data-ttu-id="95fbc-122">擷取屬性</span><span class="sxs-lookup"><span data-stu-id="95fbc-122">Retrieving Properties</span></span>](#Retrieving-Properties)

- [<span data-ttu-id="95fbc-123">附加到的動態參數`Get-ItemProperty`Cmdlet</span><span class="sxs-lookup"><span data-stu-id="95fbc-123">Attaching Dynamic Parameters to the `Get-ItemProperty` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Get-ItemProperty-Cmdlet)

- [<span data-ttu-id="95fbc-124">設定屬性</span><span class="sxs-lookup"><span data-stu-id="95fbc-124">Setting Properties</span></span>](#Setting-Properties)

- [<span data-ttu-id="95fbc-125">附加到的動態參數`Set-ItemProperty`Cmdlet</span><span class="sxs-lookup"><span data-stu-id="95fbc-125">Attaching Dynamic Parameters to the `Set-ItemProperty` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-for-the-Set-ItemProperty-Cmdlet)

- [<span data-ttu-id="95fbc-126">清除屬性</span><span class="sxs-lookup"><span data-stu-id="95fbc-126">Clearing a Property</span></span>](#Clearing-Properties)

- [<span data-ttu-id="95fbc-127">附加到的動態參數`Clear-ItemProperty`Cmdlet</span><span class="sxs-lookup"><span data-stu-id="95fbc-127">Attaching Dynamic Parameters to the `Clear-ItemProperty` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Clear-ItemProperty-Cmdlet)

- [<span data-ttu-id="95fbc-128">建置 Windows PowerShell 提供者</span><span class="sxs-lookup"><span data-stu-id="95fbc-128">Building the Windows PowerShell Provider</span></span>](#Building-the-Windows-PowerShell-provider)

## <a name="defining-the-windows-powershell-provider"></a><span data-ttu-id="95fbc-129">定義 Windows PowerShell 提供者</span><span class="sxs-lookup"><span data-stu-id="95fbc-129">Defining the Windows PowerShell provider</span></span>

<span data-ttu-id="95fbc-130">屬性提供者必須建立一個支援的.NET 類別[System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider)介面。</span><span class="sxs-lookup"><span data-stu-id="95fbc-130">A property provider must create a .NET class that supports the [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface.</span></span> <span data-ttu-id="95fbc-131">以下是從 Windows PowerShell 所提供的 TemplateProvider.cs 檔案的預設類別宣告。</span><span class="sxs-lookup"><span data-stu-id="95fbc-131">Here is the default class declaration from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyproviderclassdeclaration](Msh_samplestestcmdlets#testcmdletspropertyproviderclassdeclaration)]  -->

## <a name="defining-base-functionality"></a><span data-ttu-id="95fbc-132">定義基底的功能</span><span class="sxs-lookup"><span data-stu-id="95fbc-132">Defining Base Functionality</span></span>

<span data-ttu-id="95fbc-133">[System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider)介面可以連結至任何提供者的基底類別，但不包括[System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider)類別。</span><span class="sxs-lookup"><span data-stu-id="95fbc-133">The [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface can be attached to any of the provider base classes, with the exception of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) class.</span></span> <span data-ttu-id="95fbc-134">新增需要您使用的基底類別的基底功能。</span><span class="sxs-lookup"><span data-stu-id="95fbc-134">Add the base functionality that is required by the base class you are using.</span></span> <span data-ttu-id="95fbc-135">如需基底類別的詳細資訊，請參閱[設計您的 Windows PowerShell 提供者](./designing-your-windows-powershell-provider.md)。</span><span class="sxs-lookup"><span data-stu-id="95fbc-135">For more information about base classes, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

## <a name="retrieving-properties"></a><span data-ttu-id="95fbc-136">擷取屬性</span><span class="sxs-lookup"><span data-stu-id="95fbc-136">Retrieving Properties</span></span>

<span data-ttu-id="95fbc-137">若要擷取屬性，提供者必須實作[System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty)方法，以支援來自呼叫`Get-ItemProperty`cmdlet。</span><span class="sxs-lookup"><span data-stu-id="95fbc-137">To retrieve properties, the provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) method to support calls from the `Get-ItemProperty` cmdlet.</span></span> <span data-ttu-id="95fbc-138">這個方法會擷取位於指定的提供者內部路徑 （完整） 項目的屬性。</span><span class="sxs-lookup"><span data-stu-id="95fbc-138">This method retrieves the properties of the item located at the specified provider-internal path (fully-qualified).</span></span>

<span data-ttu-id="95fbc-139">`providerSpecificPickList`參數指出要擷取的屬性。</span><span class="sxs-lookup"><span data-stu-id="95fbc-139">The `providerSpecificPickList` parameter indicates which properties to retrieve.</span></span> <span data-ttu-id="95fbc-140">如果這個參數是`null`或空的方法應該擷取所有屬性。</span><span class="sxs-lookup"><span data-stu-id="95fbc-140">If this parameter is `null` or empty, the method should retrieve all properties.</span></span> <span data-ttu-id="95fbc-141">颾魤 ㄛ [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty)寫入的執行個體[System.Management.Automation.Psobject](/dotnet/api/System.Management.Automation.PSObject)物件，表示擷取屬性的屬性包。</span><span class="sxs-lookup"><span data-stu-id="95fbc-141">In addition, [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) writes an instance of a [System.Management.Automation.Psobject](/dotnet/api/System.Management.Automation.PSObject) object that represents a property bag of the retrieved properties.</span></span> <span data-ttu-id="95fbc-142">此方法應傳回任何項目。</span><span class="sxs-lookup"><span data-stu-id="95fbc-142">The method should return nothing.</span></span>

<span data-ttu-id="95fbc-143">建議的實作[System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty)挑選清單中支援的每個元素的屬性名稱的萬用字元展開。</span><span class="sxs-lookup"><span data-stu-id="95fbc-143">It is recommended that the implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) supports the wildcard expansion of property names for each element in the pick list.</span></span> <span data-ttu-id="95fbc-144">若要這樣做，請使用[System.Management.Automation.Wildcardpattern](/dotnet/api/System.Management.Automation.WildcardPattern)類別來執行萬用字元模式比對。</span><span class="sxs-lookup"><span data-stu-id="95fbc-144">To do this, use the [System.Management.Automation.Wildcardpattern](/dotnet/api/System.Management.Automation.WildcardPattern) class to perform the wildcard pattern matching.</span></span>

<span data-ttu-id="95fbc-145">以下是預設實作[System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty)從 Windows PowerShell 所提供的 TemplateProvider.cs 檔案。</span><span class="sxs-lookup"><span data-stu-id="95fbc-145">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidergetproperty](Msh_samplestestcmdlets#testcmdletspropertyprovidergetproperty)]  -->

#### <a name="things-to-remember-about-implementing-getproperty"></a><span data-ttu-id="95fbc-146">有關實作 GetProperty 的注意事項</span><span class="sxs-lookup"><span data-stu-id="95fbc-146">Things to Remember About Implementing GetProperty</span></span>

<span data-ttu-id="95fbc-147">在下列情況可能適用於您實作[System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty):</span><span class="sxs-lookup"><span data-stu-id="95fbc-147">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty):</span></span>

- <span data-ttu-id="95fbc-148">Windows PowerShell 屬性提供者時定義的提供者類別，可能會從宣告提供者的功能 ExpandWildcards、 篩選、 Include 或排除， [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)列舉型別。</span><span class="sxs-lookup"><span data-stu-id="95fbc-148">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="95fbc-149">在這些情況下，實作[System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty)方法需要確定傳遞給方法的路徑符合指定需求功能。</span><span class="sxs-lookup"><span data-stu-id="95fbc-149">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="95fbc-150">若要這樣做，方法應該存取適當的屬性，例如， [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude)和[System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include)屬性。</span><span class="sxs-lookup"><span data-stu-id="95fbc-150">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="95fbc-151">根據預設，會覆寫這個方法不應該擷取除非隱藏使用者物件的讀取器[System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)屬性設定為`true`。</span><span class="sxs-lookup"><span data-stu-id="95fbc-151">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="95fbc-152">應該寫入錯誤，若路徑代表會對使用者隱藏的項目和[System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)設定為`false`。</span><span class="sxs-lookup"><span data-stu-id="95fbc-152">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-itemproperty-cmdlet"></a><span data-ttu-id="95fbc-153">將動態參數附加至 Get-itemproperty Cmdlet</span><span class="sxs-lookup"><span data-stu-id="95fbc-153">Attaching Dynamic Parameters to the Get-ItemProperty Cmdlet</span></span>

<span data-ttu-id="95fbc-154">`Get-ItemProperty` Cmdlet 可能需要在執行階段動態指定的其他參數。</span><span class="sxs-lookup"><span data-stu-id="95fbc-154">The `Get-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="95fbc-155">若要提供這些動態參數，Windows PowerShell 屬性提供者必須實作[System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters)方法。</span><span class="sxs-lookup"><span data-stu-id="95fbc-155">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) method.</span></span> <span data-ttu-id="95fbc-156">`path`參數表示完整的提供者內部路徑，而`providerSpecificPickList`參數會指定輸入命令列上的提供者特定屬性。</span><span class="sxs-lookup"><span data-stu-id="95fbc-156">The `path` parameter indicates a fully-qualified provider-internal path, while the `providerSpecificPickList` parameter specifies the provider-specific properties entered on the command line.</span></span> <span data-ttu-id="95fbc-157">這個參數可能是`null`或空白，如果屬性會使用管線傳送至 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="95fbc-157">This parameter might be `null` or empty if the properties are piped to the cmdlet.</span></span> <span data-ttu-id="95fbc-158">在此情況下，這個方法會傳回具有屬性和欄位的剖析屬性類似於 cmdlet 類別的物件或[System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)物件。</span><span class="sxs-lookup"><span data-stu-id="95fbc-158">In this case, this method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="95fbc-159">Windows PowerShell 執行階段會使用傳回的物件，將參數新增至 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="95fbc-159">The Windows PowerShell runtime uses the returned object to add the parameters to the cmdlet.</span></span>

<span data-ttu-id="95fbc-160">以下是預設實作[System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters)從 Windows PowerShell 所提供的 TemplateProvider.cs 檔案。</span><span class="sxs-lookup"><span data-stu-id="95fbc-160">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidergetpropertydynamicparameters](Msh_samplestestcmdlets#testcmdletspropertyprovidergetpropertydynamicparameters)]  -->

## <a name="setting-properties"></a><span data-ttu-id="95fbc-161">設定屬性</span><span class="sxs-lookup"><span data-stu-id="95fbc-161">Setting Properties</span></span>

<span data-ttu-id="95fbc-162">若要設定的屬性，Windows PowerShell 屬性提供者必須實作[System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty)方法，以支援來自呼叫`Set-ItemProperty`cmdlet。</span><span class="sxs-lookup"><span data-stu-id="95fbc-162">To set properties, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method to support calls from the `Set-ItemProperty` cmdlet.</span></span> <span data-ttu-id="95fbc-163">這個方法會在指定的路徑，設定一或多個項目的屬性，並視需要提供的屬性會覆寫。</span><span class="sxs-lookup"><span data-stu-id="95fbc-163">This method sets one or more properties of the item at the specified path, and overwrites the supplied properties as required.</span></span> <span data-ttu-id="95fbc-164">[System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty)也會寫入的執行個體[System.Management.Automation.Psobject](/dotnet/api/System.Management.Automation.PSObject)物件，表示更新後的屬性包屬性。</span><span class="sxs-lookup"><span data-stu-id="95fbc-164">[System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) also writes an instance of a [System.Management.Automation.Psobject](/dotnet/api/System.Management.Automation.PSObject) object that represents a property bag of the updated properties.</span></span>

<span data-ttu-id="95fbc-165">以下是預設實作[System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty)從 Windows PowerShell 所提供的 TemplateProvider.cs 檔案。</span><span class="sxs-lookup"><span data-stu-id="95fbc-165">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidersetproperty](Msh_samplestestcmdlets#testcmdletspropertyprovidersetproperty)]  -->

#### <a name="things-to-remember-about-implementing-set-itemproperty"></a><span data-ttu-id="95fbc-166">有關實作 Set-itemproperty 的注意事項</span><span class="sxs-lookup"><span data-stu-id="95fbc-166">Things to Remember About Implementing Set-ItemProperty</span></span>

<span data-ttu-id="95fbc-167">在下列情況可能適用於實作[System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty):</span><span class="sxs-lookup"><span data-stu-id="95fbc-167">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty):</span></span>

- <span data-ttu-id="95fbc-168">Windows PowerShell 屬性提供者時定義的提供者類別，可能會從宣告提供者的功能 ExpandWildcards、 篩選、 Include 或排除， [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)列舉型別。</span><span class="sxs-lookup"><span data-stu-id="95fbc-168">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="95fbc-169">在這些情況下，實作[System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty)方法必須確定傳遞給方法的路徑符合指定需求功能。</span><span class="sxs-lookup"><span data-stu-id="95fbc-169">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method must ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="95fbc-170">若要這樣做，方法應該存取適當的屬性，例如， [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude)和[System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include)屬性。</span><span class="sxs-lookup"><span data-stu-id="95fbc-170">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="95fbc-171">根據預設，會覆寫這個方法不應該擷取除非隱藏使用者物件的讀取器[System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)屬性設定為`true`。</span><span class="sxs-lookup"><span data-stu-id="95fbc-171">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="95fbc-172">應該寫入錯誤，若路徑代表會對使用者隱藏的項目和[System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)設定為`false`。</span><span class="sxs-lookup"><span data-stu-id="95fbc-172">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="95fbc-173">您實作[System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty)方法應該呼叫[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)並確認它的傳回值之前對資料存放區中的任何變更。</span><span class="sxs-lookup"><span data-stu-id="95fbc-173">Your implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="95fbc-174">這個方法用來變更系統狀態，例如，重新命名檔案時，請確認執行作業。</span><span class="sxs-lookup"><span data-stu-id="95fbc-174">This method is used to confirm execution of an operation when a change is made to system state, for example, renaming files.</span></span> <span data-ttu-id="95fbc-175">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)會變更為對使用者而言，Windows PowerShell 執行階段和處理的任何命令列設定或喜好設定變數中的之資源的名稱決定應該要顯示的內容。</span><span class="sxs-lookup"><span data-stu-id="95fbc-175">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime and handling any command-line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="95fbc-176">若要在呼叫之後[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)會傳回`true`，如果有潛在危險的系統會遭到修改， [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty)方法應該呼叫[System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue)方法。</span><span class="sxs-lookup"><span data-stu-id="95fbc-176">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, if potentially dangerous system modifications can be made, the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="95fbc-177">這個方法會將確認訊息傳送給使用者，以允許其他意見反應，來表示作業應該繼續執行。</span><span class="sxs-lookup"><span data-stu-id="95fbc-177">This method sends a confirmation message to the user to allow additional feedback to indicate that the operation should be continued.</span></span>

## <a name="attaching-dynamic-parameters-for-the-set-itemproperty-cmdlet"></a><span data-ttu-id="95fbc-178">附加 Set-itemproperty cmdlet 的動態參數</span><span class="sxs-lookup"><span data-stu-id="95fbc-178">Attaching Dynamic Parameters for the Set-ItemProperty Cmdlet</span></span>

<span data-ttu-id="95fbc-179">`Set-ItemProperty` Cmdlet 可能需要在執行階段動態指定的其他參數。</span><span class="sxs-lookup"><span data-stu-id="95fbc-179">The `Set-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="95fbc-180">若要提供這些動態參數，Windows PowerShell 屬性提供者必須實作[System.Management.Automation.Provider.Ipropertycmdletprovider.Setpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetPropertyDynamicParameters)方法。</span><span class="sxs-lookup"><span data-stu-id="95fbc-180">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetPropertyDynamicParameters) method.</span></span> <span data-ttu-id="95fbc-181">這個方法會傳回具有屬性和欄位的剖析屬性類似於 cmdlet 類別的物件或[System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)物件。</span><span class="sxs-lookup"><span data-stu-id="95fbc-181">This method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="95fbc-182">`null`可以傳回值，如果沒有任何動態參數新增。</span><span class="sxs-lookup"><span data-stu-id="95fbc-182">The `null` value can be returned if no dynamic parameters are to be added.</span></span>

<span data-ttu-id="95fbc-183">以下是預設實作[System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters)從 Windows PowerShell 所提供的 TemplateProvider.cs 檔案。</span><span class="sxs-lookup"><span data-stu-id="95fbc-183">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidersetpropertydynamicparameters](Msh_samplestestcmdlets#testcmdletspropertyprovidersetpropertydynamicparameters)]  -->

## <a name="clearing-properties"></a><span data-ttu-id="95fbc-184">清除屬性</span><span class="sxs-lookup"><span data-stu-id="95fbc-184">Clearing Properties</span></span>

<span data-ttu-id="95fbc-185">若要清除的屬性，Windows PowerShell 屬性提供者必須實作[System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty)方法，以支援來自呼叫`Clear-ItemProperty`cmdlet。</span><span class="sxs-lookup"><span data-stu-id="95fbc-185">To clear properties, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method to support calls from the `Clear-ItemProperty` cmdlet.</span></span> <span data-ttu-id="95fbc-186">這個方法會設定一或多個屬性位於指定路徑的項目。</span><span class="sxs-lookup"><span data-stu-id="95fbc-186">This method sets one or more properties for the item located at the specified path.</span></span>

<span data-ttu-id="95fbc-187">以下是預設實作[System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty)從 Windows PowerShell 所提供的 TemplateProvider.cs 檔案。</span><span class="sxs-lookup"><span data-stu-id="95fbc-187">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyproviderclearproperty](Msh_samplestestcmdlets#testcmdletspropertyproviderclearproperty)]  -->

#### <a name="thing-to-remember-about-implementing-clearproperty"></a><span data-ttu-id="95fbc-188">要記住實作 ClearProperty</span><span class="sxs-lookup"><span data-stu-id="95fbc-188">Thing to Remember About Implementing ClearProperty</span></span>

<span data-ttu-id="95fbc-189">在下列情況可能適用於您實作[System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty):</span><span class="sxs-lookup"><span data-stu-id="95fbc-189">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty):</span></span>

- <span data-ttu-id="95fbc-190">Windows PowerShell 屬性提供者時定義的提供者類別，可能會從宣告提供者的功能 ExpandWildcards、 篩選、 Include 或排除， [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)列舉型別。</span><span class="sxs-lookup"><span data-stu-id="95fbc-190">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="95fbc-191">在這些情況下，實作[System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty)方法需要確定傳遞給方法的路徑符合指定需求功能。</span><span class="sxs-lookup"><span data-stu-id="95fbc-191">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="95fbc-192">若要這樣做，方法應該存取適當的屬性，例如， [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude)和[System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include)屬性。</span><span class="sxs-lookup"><span data-stu-id="95fbc-192">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="95fbc-193">根據預設，會覆寫這個方法不應該擷取除非隱藏使用者物件的讀取器[System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)屬性設定為`true`。</span><span class="sxs-lookup"><span data-stu-id="95fbc-193">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="95fbc-194">應該寫入錯誤，若路徑代表會對使用者隱藏的項目和[System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)設定為`false`。</span><span class="sxs-lookup"><span data-stu-id="95fbc-194">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="95fbc-195">您實作[System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty)方法應該呼叫[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)並確認它的傳回值之前對資料存放區中的任何變更。</span><span class="sxs-lookup"><span data-stu-id="95fbc-195">Your implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="95fbc-196">這個方法用來確認執行作業，才能變更系統狀態，例如清除內容。</span><span class="sxs-lookup"><span data-stu-id="95fbc-196">This method is used to confirm execution of an operation before a change is made to system state, such as clearing content.</span></span> <span data-ttu-id="95fbc-197">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)傳送給使用者，變更納入考量，任何命令列設定或喜好設定變數中的 Windows PowerShell 執行階段資源的名稱決定應該要顯示的內容。</span><span class="sxs-lookup"><span data-stu-id="95fbc-197">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="95fbc-198">若要在呼叫之後[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)會傳回`true`，如果有潛在危險的系統會遭到修改， [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty)方法應該呼叫[System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue)方法。</span><span class="sxs-lookup"><span data-stu-id="95fbc-198">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, if potentially dangerous system modifications can be made, the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="95fbc-199">這個方法會將確認訊息傳送給使用者，以允許其他意見反應，以指出有潛在危險的作業應該繼續執行。</span><span class="sxs-lookup"><span data-stu-id="95fbc-199">This method sends a confirmation message to the user to allow additional feedback to indicate that the potentially dangerous operation should be continued.</span></span>

## <a name="attaching-dynamic-parameters-to-the-clear-itemproperty-cmdlet"></a><span data-ttu-id="95fbc-200">將動態參數附加至 Clear-itemproperty Cmdlet</span><span class="sxs-lookup"><span data-stu-id="95fbc-200">Attaching Dynamic Parameters to the Clear-ItemProperty Cmdlet</span></span>

<span data-ttu-id="95fbc-201">`Clear-ItemProperty` Cmdlet 可能需要在執行階段動態指定的其他參數。</span><span class="sxs-lookup"><span data-stu-id="95fbc-201">The `Clear-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="95fbc-202">若要提供這些動態參數，Windows PowerShell 屬性提供者必須實作[System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters)方法。</span><span class="sxs-lookup"><span data-stu-id="95fbc-202">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) method.</span></span> <span data-ttu-id="95fbc-203">這個方法會傳回具有屬性和欄位的剖析屬性類似於 cmdlet 類別的物件或[System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)物件。</span><span class="sxs-lookup"><span data-stu-id="95fbc-203">This method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="95fbc-204">`null`可以傳回值，如果沒有任何動態參數新增。</span><span class="sxs-lookup"><span data-stu-id="95fbc-204">The `null` value can be returned if no dynamic parameters are to be added.</span></span>

<span data-ttu-id="95fbc-205">以下是預設實作[System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters)從 Windows PowerShell 所提供的 TemplateProvider.cs 檔案。</span><span class="sxs-lookup"><span data-stu-id="95fbc-205">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyproviderclearpropertydynamicparameters](Msh_samplestestcmdlets#testcmdletspropertyproviderclearpropertydynamicparameters)]  -->

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="95fbc-206">建置的 Windows PowerShell 提供者</span><span class="sxs-lookup"><span data-stu-id="95fbc-206">Building the Windows PowerShell provider</span></span>

<span data-ttu-id="95fbc-207">請參閱[如何註冊 Cmdlet、 提供者，以及裝載應用程式](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)。</span><span class="sxs-lookup"><span data-stu-id="95fbc-207">See [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>
<span data-ttu-id="95fbc-208">請參閱[如何註冊 Cmdlet、 提供者，以及裝載應用程式](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)。</span><span class="sxs-lookup"><span data-stu-id="95fbc-208">See [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="see-also"></a><span data-ttu-id="95fbc-209">另請參閱</span><span class="sxs-lookup"><span data-stu-id="95fbc-209">See Also</span></span>

[<span data-ttu-id="95fbc-210">Windows PowerShell 提供者</span><span class="sxs-lookup"><span data-stu-id="95fbc-210">Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="95fbc-211">設計您的 Windows PowerShell 提供者</span><span class="sxs-lookup"><span data-stu-id="95fbc-211">Design Your Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="95fbc-212">擴充物件類型和格式</span><span class="sxs-lookup"><span data-stu-id="95fbc-212">Extending Object Types and Formatting</span></span>](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351)

[<span data-ttu-id="95fbc-213">擴充物件類型和格式</span><span class="sxs-lookup"><span data-stu-id="95fbc-213">Extending Object Types and Formatting</span></span>](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351)

[<span data-ttu-id="95fbc-214">如何註冊 Cmdlet、 提供者，以及裝載應用程式</span><span class="sxs-lookup"><span data-stu-id="95fbc-214">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="95fbc-215">如何註冊 Cmdlet、 提供者，以及裝載應用程式</span><span class="sxs-lookup"><span data-stu-id="95fbc-215">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)