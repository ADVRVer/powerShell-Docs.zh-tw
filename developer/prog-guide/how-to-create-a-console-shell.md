---
title: 如何建立主控台 Shell |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- Make-Shell [PowerShell Programmer's Guide]
ms.assetid: 6c24dd44-a8ec-421d-ac86-90912e1a8cc6
caps.latest.revision: 5
ms.openlocfilehash: 7166881bd1403ea8c81ec2928321f6b93e3ac58d
ms.sourcegitcommit: e7445ba8203da304286c591ff513900ad1c244a4
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/23/2019
ms.locfileid: "62081566"
---
# <a name="how-to-create-a-console-shell"></a><span data-ttu-id="346a4-102">如何建立主控台殼層</span><span class="sxs-lookup"><span data-stu-id="346a4-102">How to Create a Console Shell</span></span>

<span data-ttu-id="346a4-103">Windows PowerShell 提供讓殼層的工具，也稱為 「 請-套件 」，用來建立不是可延伸的主控台介面。</span><span class="sxs-lookup"><span data-stu-id="346a4-103">Windows PowerShell provides a Make-Shell tool, also referred to as the "make-kit", that is used to create a console shell that is not extensible.</span></span> <span data-ttu-id="346a4-104">使用這項新工具建立的殼層無法稍後再擴充，透過 Windows PowerShell 嵌入式管理單元。</span><span class="sxs-lookup"><span data-stu-id="346a4-104">Shells created with this new tool cannot be extended later through a Windows PowerShell snap-in.</span></span>

## <a name="syntax"></a><span data-ttu-id="346a4-105">語法</span><span class="sxs-lookup"><span data-stu-id="346a4-105">Syntax</span></span>

<span data-ttu-id="346a4-106">以下是用來執行從讓殼層內讓檔案的語法。</span><span class="sxs-lookup"><span data-stu-id="346a4-106">Here is the syntax used to run Make-Shell from within a make-file.</span></span>

```
make-shell
  -out n.exe
  -namespace ns
  [ -lib libdirectory1[,libdirectory2,..] ]
  [ -reference ca1.dll[,ca2.dll,...] ]
  [ -formatdata fd1.format.ps1xml[,fd2.format.ps1xml,...] ]
  [ -typedata td1.type.ps1xml[,td2.type.ps1xml,...] ]
  [ -source c1.cs [,c2.cs,...] ]
  [ -authorizationmanager authorizationManagerType ]
  [ -win32icon i.ico ]
  [ -initscript p.ps1 ]
  [ -builtinscript s1.ps1[,s2.ps1,...] ]
  [ -resource resourcefile.txt ]
  [ -cscflags cscFlags ]
  [ -? | -help ]
```

## <a name="parameters"></a><span data-ttu-id="346a4-107">參數</span><span class="sxs-lookup"><span data-stu-id="346a4-107">Parameters</span></span>

<span data-ttu-id="346a4-108">以下是讓殼層參數的簡短描述。</span><span class="sxs-lookup"><span data-stu-id="346a4-108">Here is a brief description of the parameters of Make-Shell.</span></span>

> [!CAUTION]
> <span data-ttu-id="346a4-109">請 Shell 不支援 UNC 路徑，組件。</span><span class="sxs-lookup"><span data-stu-id="346a4-109">UNC paths to assemblies are not supported by Make-Shell.</span></span>

|<span data-ttu-id="346a4-110">參數</span><span class="sxs-lookup"><span data-stu-id="346a4-110">Parameter</span></span>|<span data-ttu-id="346a4-111">描述</span><span class="sxs-lookup"><span data-stu-id="346a4-111">Description</span></span>|
|---------------|-----------------|
|<span data-ttu-id="346a4-112">-out n.exe</span><span class="sxs-lookup"><span data-stu-id="346a4-112">-out n.exe</span></span>|<span data-ttu-id="346a4-113">必要。</span><span class="sxs-lookup"><span data-stu-id="346a4-113">Required.</span></span> <span data-ttu-id="346a4-114">產生介面名稱。</span><span class="sxs-lookup"><span data-stu-id="346a4-114">The name of the shell to produce.</span></span> <span data-ttu-id="346a4-115">指定的路徑，此參數的一部分。</span><span class="sxs-lookup"><span data-stu-id="346a4-115">The path is specified as part of this parameter.</span></span><br /><br /> <span data-ttu-id="346a4-116">讓殼層將會附加".exe"，此值，如果未指定。</span><span class="sxs-lookup"><span data-stu-id="346a4-116">Make-shell will append ".exe" to this value if it is not specified.</span></span> <span data-ttu-id="346a4-117">**注意：** 具有相同名稱與參考的.dll 檔建立的輸出檔。</span><span class="sxs-lookup"><span data-stu-id="346a4-117">**Caution:**  Do not create an output file with the same name as the referenced .dll file.</span></span> <span data-ttu-id="346a4-118">如果您嘗試這麼做，請殼層工具會建立.cs 檔案具有相同名稱，將會覆寫的.cs 檔案中包含您指令程式的原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="346a4-118">If you attempt this, the Make-Shell tool creates a .cs file with the same name, which will overwrite the .cs file that has your cmdlet source code.</span></span>|
|<span data-ttu-id="346a4-119">命名空間 ns</span><span class="sxs-lookup"><span data-stu-id="346a4-119">-namespace ns</span></span>|<span data-ttu-id="346a4-120">必要。</span><span class="sxs-lookup"><span data-stu-id="346a4-120">Required.</span></span> <span data-ttu-id="346a4-121">要用於 衍生的命名空間[System.Management.Automation.Runspaces.Runspaceconfiguration](/dotnet/api/System.Management.Automation.Runspaces.RunspaceConfiguration)讓套件產生和編譯的類別。</span><span class="sxs-lookup"><span data-stu-id="346a4-121">The namespace to use for the derived [System.Management.Automation.Runspaces.Runspaceconfiguration](/dotnet/api/System.Management.Automation.Runspaces.RunspaceConfiguration) class that the make-kit generates and compiles.</span></span>|
|<span data-ttu-id="346a4-122">-lib libdirectory1[,libdirectory2,..]</span><span class="sxs-lookup"><span data-stu-id="346a4-122">-lib libdirectory1[,libdirectory2,..]</span></span>|<span data-ttu-id="346a4-123">.NET 組件，包括 Windows PowerShell 組件，這是所指定的組件中搜尋的目錄`reference`參數、 組件的間接參考的另一個組件和.NET system 組件。</span><span class="sxs-lookup"><span data-stu-id="346a4-123">The directories that are searched for .NET assemblies, including the Windows PowerShell assemblies, assemblies specified by the `reference` parameter, assemblies indirectly referenced by another assembly, and the .NET system assemblies.</span></span>|
|<span data-ttu-id="346a4-124">-reference ca1.dll[,ca2.dll,...]</span><span class="sxs-lookup"><span data-stu-id="346a4-124">-reference ca1.dll[,ca2.dll,...]</span></span>|<span data-ttu-id="346a4-125">要包含在殼層中的組件以逗號分隔清單。</span><span class="sxs-lookup"><span data-stu-id="346a4-125">A comma-separated list of the assemblies to include in the shell.</span></span> <span data-ttu-id="346a4-126">這些組件包含所有 cmdlet 和提供者組件，以及應該載入的資源組件。</span><span class="sxs-lookup"><span data-stu-id="346a4-126">These assemblies  includes all cmdlet and provider assemblies, as well as resource assemblies that should be loaded.</span></span> <span data-ttu-id="346a4-127">如果未指定此參數，然後在殼層會產生包含只有核心 cmdlet 與 Windows PowerShell 所提供的提供者。</span><span class="sxs-lookup"><span data-stu-id="346a4-127">If this parameter is not specified, then a shell is produced that contains only the core cmdlets and providers provided by Windows PowerShell.</span></span><br /><br /> <span data-ttu-id="346a4-128">您可以使用其完整路徑指定的組件，否則搜尋使用指定的路徑`lib`參數。</span><span class="sxs-lookup"><span data-stu-id="346a4-128">The assemblies can be specified using their full path, otherwise they will be searched for using the path specified by the `lib` parameter.</span></span>|
|<span data-ttu-id="346a4-129">-formatdata fd1.format.ps1xml[,fd2.format.ps1xml,...]</span><span class="sxs-lookup"><span data-stu-id="346a4-129">-formatdata fd1.format.ps1xml[,fd2.format.ps1xml,...]</span></span>|<span data-ttu-id="346a4-130">要包含在殼層中的格式化資料的逗號分隔清單。</span><span class="sxs-lookup"><span data-stu-id="346a4-130">A comma-separated list of format data to include in the shell.</span></span> <span data-ttu-id="346a4-131">如果未指定此參數，然後在殼層會產生包含只有 Windows PowerShell 所提供的格式資料。</span><span class="sxs-lookup"><span data-stu-id="346a4-131">If this parameter is not specified, then a shell is produced that contains only the format data provided by Windows PowerShell.</span></span>|
|<span data-ttu-id="346a4-132">-typedata td1.type.ps1xml[,td2.type.ps1xml,...]</span><span class="sxs-lookup"><span data-stu-id="346a4-132">-typedata td1.type.ps1xml[,td2.type.ps1xml,...]</span></span>|<span data-ttu-id="346a4-133">在殼層中包含的資料類型以逗號分隔清單。</span><span class="sxs-lookup"><span data-stu-id="346a4-133">A comma-separated list of type data to include in the shell.</span></span> <span data-ttu-id="346a4-134">如果未指定此參數，然後在殼層會產生包含只有 Windows PowerShell 所提供的型別資料。</span><span class="sxs-lookup"><span data-stu-id="346a4-134">If this parameter is not specified, then a shell is produced that contains only the type data provided by Windows PowerShell.</span></span>|
|<span data-ttu-id="346a4-135">-source c1.cs [,c2.cs,...]</span><span class="sxs-lookup"><span data-stu-id="346a4-135">-source c1.cs [,c2.cs,...]</span></span>|<span data-ttu-id="346a4-136">提供 shell 開發人員，包含所有建置命令介面所需的原始程式碼的檔案名稱。</span><span class="sxs-lookup"><span data-stu-id="346a4-136">The name of a file, provided by the shell developer, that contains any source code needed to build the shell.</span></span><br /><br /> <span data-ttu-id="346a4-137">原始程式碼檔可以包含任何下列原始程式碼：</span><span class="sxs-lookup"><span data-stu-id="346a4-137">The source code file can contain any of the following source code:</span></span><br /><br /> <span data-ttu-id="346a4-138">-覆寫預設授權管理員的授權管理員實作。</span><span class="sxs-lookup"><span data-stu-id="346a4-138">-   The Authorization manager implementation that overrides the default authorization manager.</span></span> <span data-ttu-id="346a4-139">（這可能也會提供編譯的組件。）</span><span class="sxs-lookup"><span data-stu-id="346a4-139">(This could also be supplied compiled into an assembly.)</span></span><br /><span data-ttu-id="346a4-140">組件參考的屬性宣告： 例如 AssemblyCompanyAttribute、 AssemblyCopyrightAttribute、 AssemblyFileVersionAttribute、 AssemblyInformationalVersionAttribute、 AssemblyProductAttribute，及AssemblyTrademarkAttribute。</span><span class="sxs-lookup"><span data-stu-id="346a4-140">-   Assembly informational attribute declarations: such as the AssemblyCompanyAttribute, AssemblyCopyrightAttribute, AssemblyFileVersionAttribute, AssemblyInformationalVersionAttribute, AssemblyProductAttribute, and AssemblyTrademarkAttribute.</span></span>|
|<span data-ttu-id="346a4-141">-authorizationmanager authorizationManagerType</span><span class="sxs-lookup"><span data-stu-id="346a4-141">-authorizationmanager authorizationManagerType</span></span>|<span data-ttu-id="346a4-142">包含授權管理員實作的型別。</span><span class="sxs-lookup"><span data-stu-id="346a4-142">The type that contains the authorization manager implementation.</span></span> <span data-ttu-id="346a4-143">這可以是定義在原始程式碼中，或編譯的組件 (藉由指定`reference`參數)。</span><span class="sxs-lookup"><span data-stu-id="346a4-143">This can be defined in source code, or compiled into an assembly (specified by the `reference` parameter).</span></span> <span data-ttu-id="346a4-144">如果未指定此參數，則會使用預設安全性管理員。</span><span class="sxs-lookup"><span data-stu-id="346a4-144">If this parameter is not specified, the default security manager is used.</span></span> <span data-ttu-id="346a4-145">值應該是完整類型名稱，包括命名空間。</span><span class="sxs-lookup"><span data-stu-id="346a4-145">The value should be the full type name, including namespaces.</span></span>|
|<span data-ttu-id="346a4-146">-win32icon i.ico</span><span class="sxs-lookup"><span data-stu-id="346a4-146">-win32icon i.ico</span></span>|<span data-ttu-id="346a4-147">.Exe 檔案，shell 圖示。</span><span class="sxs-lookup"><span data-stu-id="346a4-147">The icon for the .exe file for the shell.</span></span> <span data-ttu-id="346a4-148">如果未指定，殼層將會有 c# 編譯器包含 （如果有的話） 圖示。</span><span class="sxs-lookup"><span data-stu-id="346a4-148">If not specified, then the shell will have the icon that the c# compiler includes (if any).</span></span>|
|<span data-ttu-id="346a4-149">-initscript p.ps1</span><span class="sxs-lookup"><span data-stu-id="346a4-149">-initscript p.ps1</span></span>|<span data-ttu-id="346a4-150">殼層啟動設定檔。</span><span class="sxs-lookup"><span data-stu-id="346a4-150">The startup profile for the shell.</span></span> <span data-ttu-id="346a4-151">檔案會包含"作為-是";沒有驗證檢查，即可讓殼層。</span><span class="sxs-lookup"><span data-stu-id="346a4-151">The file is included "as-is"; no validity checking is done by Make-Shell.</span></span>|
|<span data-ttu-id="346a4-152">-builtinscript s1.ps1[,s2.ps1,...]</span><span class="sxs-lookup"><span data-stu-id="346a4-152">-builtinscript s1.ps1[,s2.ps1,...]</span></span>|<span data-ttu-id="346a4-153">殼層的內建指令碼的清單。</span><span class="sxs-lookup"><span data-stu-id="346a4-153">A list of built-in scripts for the shell.</span></span> <span data-ttu-id="346a4-154">這些指令碼會探索之前，路徑中的指令碼，並建置殼層後，就無法變更其內容。</span><span class="sxs-lookup"><span data-stu-id="346a4-154">These scripts are discovered before scripts in the path, and their contents cannot be changed once the shell is built.</span></span><br /><br /> <span data-ttu-id="346a4-155">檔案會包含在 「 為-是";沒有驗證檢查，即可讓殼層。</span><span class="sxs-lookup"><span data-stu-id="346a4-155">The files are included "as-is"; no validity checking is done by Make-Shell.</span></span>|
|<span data-ttu-id="346a4-156">-資源 resourcefile.txt</span><span class="sxs-lookup"><span data-stu-id="346a4-156">-resource resourcefile.txt</span></span>|<span data-ttu-id="346a4-157">在.txt 檔案，其中包含說明及橫幅 shell 的資源。</span><span class="sxs-lookup"><span data-stu-id="346a4-157">The .txt file containing help and banner resources for the shell.</span></span> <span data-ttu-id="346a4-158">第一個資源名為 ShellHelp，並包含與叫用殼層時所顯示的文字`help`參數。</span><span class="sxs-lookup"><span data-stu-id="346a4-158">The first resource is named ShellHelp, and contains the text displayed if the shell is invoked with the `help` parameter.</span></span> <span data-ttu-id="346a4-159">第二個資源為 ShellBanner，，其中包含文字和在互動模式中啟動殼層時顯示的著作權資訊。</span><span class="sxs-lookup"><span data-stu-id="346a4-159">The second resource is named ShellBanner, and it contains the text and copyright information displayed when the shell is launched in interactive mode.</span></span><br /><br /> <span data-ttu-id="346a4-160">如果未提供這個參數，或這些資源不存在，則一般的說明和橫幅會使用。</span><span class="sxs-lookup"><span data-stu-id="346a4-160">If this parameter is not provided, or these resources are not present, then a generic help and banner are used.</span></span>|
|<span data-ttu-id="346a4-161">-cscflags cscFlags</span><span class="sxs-lookup"><span data-stu-id="346a4-161">-cscflags cscFlags</span></span>|<span data-ttu-id="346a4-162">旗標，應傳遞至C#編譯器 (csc.exe)。</span><span class="sxs-lookup"><span data-stu-id="346a4-162">Flags that should be passed to the C# compiler (csc.exe).</span></span> <span data-ttu-id="346a4-163">這些都會通過不變。</span><span class="sxs-lookup"><span data-stu-id="346a4-163">These are passed through unchanged.</span></span> <span data-ttu-id="346a4-164">如果此參數包含空格，則它應該用雙引號括住。</span><span class="sxs-lookup"><span data-stu-id="346a4-164">If this parameter includes spaces, it should be surrounded in double-quotes.</span></span>|
|<span data-ttu-id="346a4-165">-?</span><span class="sxs-lookup"><span data-stu-id="346a4-165">-?</span></span><br /><br /> <span data-ttu-id="346a4-166">-help</span><span class="sxs-lookup"><span data-stu-id="346a4-166">-help</span></span>|<span data-ttu-id="346a4-167">顯示著作權訊息和讓殼層命令列選項。</span><span class="sxs-lookup"><span data-stu-id="346a4-167">Displays the copyright message and Make-Shell command line options.</span></span>|
|<span data-ttu-id="346a4-168">-verbose</span><span class="sxs-lookup"><span data-stu-id="346a4-168">-verbose</span></span>|<span data-ttu-id="346a4-169">建立殼層時，顯示詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="346a4-169">Displays detailed information while the shell is being created.</span></span>|

## <a name="see-also"></a><span data-ttu-id="346a4-170">另請參閱</span><span class="sxs-lookup"><span data-stu-id="346a4-170">See Also</span></span>

[<span data-ttu-id="346a4-171">Windows PowerShell 程式設計人員指南</span><span class="sxs-lookup"><span data-stu-id="346a4-171">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)

[<span data-ttu-id="346a4-172">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="346a4-172">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)