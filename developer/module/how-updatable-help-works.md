---
title: 如何可更新說明運作方式 |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 7674636e-a0f2-4587-bfc5-dd3e6ce5489e
caps.latest.revision: 6
ms.openlocfilehash: 5b6ae54ee6c843996c875189b6ee553be5e4f614
ms.sourcegitcommit: e7445ba8203da304286c591ff513900ad1c244a4
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/23/2019
ms.locfileid: "62082252"
---
# <a name="how-updatable-help-works"></a><span data-ttu-id="4f72a-102">可更新的說明如何運作</span><span class="sxs-lookup"><span data-stu-id="4f72a-102">How Updatable Help Works</span></span>

<span data-ttu-id="4f72a-103">本主題說明可更新的說明處理序 HelpInfo XML 檔案，並在封包檔的每個模組，並安裝更新的使用者說明的方式。</span><span class="sxs-lookup"><span data-stu-id="4f72a-103">This topic explains how Updatable Help processes the HelpInfo XML file and CAB files for each module, and installs updated help for users.</span></span>

## <a name="the-update-help-process"></a><span data-ttu-id="4f72a-104">Update-help 程序</span><span class="sxs-lookup"><span data-stu-id="4f72a-104">The Update-Help Process</span></span>

<span data-ttu-id="4f72a-105">下列清單描述的動作[Update-help](/powershell/module/Microsoft.PowerShell.Core/Update-Help) cmdlet，當使用者執行更新特定的 UI 文化特性中的模組的說明檔案的命令。</span><span class="sxs-lookup"><span data-stu-id="4f72a-105">The following list describes the actions of the [Update-Help](/powershell/module/Microsoft.PowerShell.Core/Update-Help) cmdlet when a user runs a command to update the help files for a module in a particular UI culture.</span></span>

1. <span data-ttu-id="4f72a-106">`Update-Help` 取得遠端 HelpInfo XML 檔案中的值所指定的位置**HelpInfoURI**模組資訊清單中索引鍵，並驗證針對結構描述檔案。</span><span class="sxs-lookup"><span data-stu-id="4f72a-106">`Update-Help` gets the remote HelpInfo XML file from the location specified by the value of the **HelpInfoURI** key in the module manifest and validates the file against the schema.</span></span> <span data-ttu-id="4f72a-107">(若要檢視結構描述，請參閱[HelpInfo XML 結構描述](./helpinfo-xml-schema.md)。)然後`Update-Help`會尋找在模組目錄中模組的本機 HelpInfo XML 檔案在使用者電腦上。</span><span class="sxs-lookup"><span data-stu-id="4f72a-107">(To view the schema, see [HelpInfo XML Schema](./helpinfo-xml-schema.md).) Then `Update-Help` looks for a local HelpInfo XML file for the module in the module directory on the user's computer.</span></span>

2. <span data-ttu-id="4f72a-108">`Update-Help` 比較指定模組的遠端和本機 HelpInfo XML 檔案中的 UI 文化特性的說明檔案的版本號碼。</span><span class="sxs-lookup"><span data-stu-id="4f72a-108">`Update-Help` compares the version number of the help files for the specified UI culture in the remote and local HelpInfo XML files for the module.</span></span> <span data-ttu-id="4f72a-109">如果對遠端檔案的版本號碼大於版本號碼，在本機檔案，或如果有任何本機的 HelpInfo XML 檔案，對於模組，`Update-Help`準備要下載新的說明檔。</span><span class="sxs-lookup"><span data-stu-id="4f72a-109">If the version number on the remote file is greater than version number on the local file, or if the there is no local HelpInfo XML file for the module, `Update-Help` prepares to download new help files.</span></span>

3. <span data-ttu-id="4f72a-110">`Update-Help` 選取模組的 CAB 檔案從所指定的位置**HelpContentUri**遠端 HelpInfo XML 檔案中的項目。</span><span class="sxs-lookup"><span data-stu-id="4f72a-110">`Update-Help` selects the CAB file for the module from the location specified by the **HelpContentUri** element in the remote HelpInfo XML file.</span></span> <span data-ttu-id="4f72a-111">它會使用模組名稱、 GUID、 模組和 UI 文化特性，來識別封包檔。</span><span class="sxs-lookup"><span data-stu-id="4f72a-111">It uses the module name, module GUID, and UI culture to identify the CAB file.</span></span>

4. <span data-ttu-id="4f72a-112">`Update-Help` 下載的 CAB 檔案、 將它解壓縮、 驗證的說明內容檔案，並說明內容會將檔案儲存在模組目錄的特定語言子目錄中使用者的電腦上。</span><span class="sxs-lookup"><span data-stu-id="4f72a-112">`Update-Help` downloads the CAB file, unpacks it, validates the help content files, and saves the help content files in the language-specific subdirectory of the module directory on the user's computer.</span></span>

5. <span data-ttu-id="4f72a-113">`Update-Help` 建立本機 HelpInfo XML 檔案，複製 遠端 HelpInfo XML 檔案。</span><span class="sxs-lookup"><span data-stu-id="4f72a-113">`Update-Help` creates a local HelpInfo XML file by copying the remote HelpInfo XML file.</span></span> <span data-ttu-id="4f72a-114">它會編輯本機 HelpInfo XML 檔案，使其包含所安裝的 CAB 檔案的元素。</span><span class="sxs-lookup"><span data-stu-id="4f72a-114">It edits the local HelpInfo XML file so that it includes elements only for the CAB file that it installed.</span></span> <span data-ttu-id="4f72a-115">然後它會將本機 HelpInfo XML 檔案儲存在模組目錄，並結束更新。</span><span class="sxs-lookup"><span data-stu-id="4f72a-115">Then it saves the local HelpInfo XML file in the module directory and concludes the update.</span></span>

## <a name="the-save-help-process"></a><span data-ttu-id="4f72a-116">Save-help 程序</span><span class="sxs-lookup"><span data-stu-id="4f72a-116">The Save-Help Process</span></span>

<span data-ttu-id="4f72a-117">下列清單描述的動作[Save-help](/powershell/module/Microsoft.PowerShell.Core/Save-Help)並[Update-help](/powershell/module/Microsoft.PowerShell.Core/Update-Help) cmdlet，當使用者執行命令來更新說明檔中的檔案共用，然後使用這些檔案上更新說明檔使用者的電腦。</span><span class="sxs-lookup"><span data-stu-id="4f72a-117">The following list describes the actions of the [Save-Help](/powershell/module/Microsoft.PowerShell.Core/Save-Help) and [Update-Help](/powershell/module/Microsoft.PowerShell.Core/Update-Help) cmdlets when a user runs commands to update the help files in a file share, and then use those files to update the help files on the user's computer.</span></span>

<span data-ttu-id="4f72a-118">`Save-Help` Cmdlet 會執行下列動作以回應至命令，以將模組的說明檔案儲存在所指定的檔案共用**DestinationPath**參數。</span><span class="sxs-lookup"><span data-stu-id="4f72a-118">The `Save-Help` cmdlet performs the following actions in response to a command to save the help files for a module in a file share that is specified by the **DestinationPath** parameter.</span></span>

1. <span data-ttu-id="4f72a-119">`Save-Help` 取得遠端 HelpInfo XML 檔案中的值所指定的位置**HelpInfoURI**模組資訊清單中索引鍵，並驗證針對結構描述檔案。</span><span class="sxs-lookup"><span data-stu-id="4f72a-119">`Save-Help` gets  the remote HelpInfo XML file from the location specified by the value of the **HelpInfoURI** key in the module manifest and validates the file against the schema.</span></span> <span data-ttu-id="4f72a-120">(若要檢視結構描述，請參閱[HelpInfo XML 結構描述](./helpinfo-xml-schema.md)。)然後`Save-Help`本機 HelpInfo XML 檔案所指定的目錄中尋找**DestinationPath**中的參數`Save-Help`命令。</span><span class="sxs-lookup"><span data-stu-id="4f72a-120">(To view the schema, see [HelpInfo XML Schema](./helpinfo-xml-schema.md).) Then `Save-Help` looks for a local HelpInfo XML file in the directory that is specified by the **DestinationPath** parameter in the `Save-Help` command.</span></span>

2. <span data-ttu-id="4f72a-121">`Save-Help` 比較指定模組的遠端和本機 HelpInfo XML 檔案中的 UI 文化特性的說明檔案的版本號碼。</span><span class="sxs-lookup"><span data-stu-id="4f72a-121">`Save-Help` compares the version number of the help files for the specified UI culture in the remote and local HelpInfo XML files for the module.</span></span> <span data-ttu-id="4f72a-122">如果對遠端檔案的版本號碼大於版本號碼，在本機檔案，或如果已在模組沒有本機 HelpInfo XML 檔案**DestinationPath**目錄中，`Save-Help`準備要下載新的說明檔。</span><span class="sxs-lookup"><span data-stu-id="4f72a-122">If the version number on the remote file is greater than version number on the local file, or if the there is no local HelpInfo XML file for the module in the **DestinationPath** directory, `Save-Help` prepares to download new help files.</span></span>

3. <span data-ttu-id="4f72a-123">`Save-Help` 選取模組的 CAB 檔案從所指定的位置**HelpContentUri**遠端 HelpInfo XML 檔案中的項目。</span><span class="sxs-lookup"><span data-stu-id="4f72a-123">`Save-Help` selects the CAB file for the module from the location specified by the **HelpContentUri** element in the remote HelpInfo XML file.</span></span> <span data-ttu-id="4f72a-124">它會使用模組名稱、 GUID、 模組和 UI 文化特性，來識別封包檔。</span><span class="sxs-lookup"><span data-stu-id="4f72a-124">It uses the module name, module GUID, and UI culture to identify the CAB file.</span></span>

4. <span data-ttu-id="4f72a-125">`Save-Help` 下載封包檔，並儲存在**DestinationPath**目錄。</span><span class="sxs-lookup"><span data-stu-id="4f72a-125">`Save-Help` downloads the CAB file and saves it in the **DestinationPath** directory.</span></span> <span data-ttu-id="4f72a-126">（它不會建立任何語言特定子目錄。）</span><span class="sxs-lookup"><span data-stu-id="4f72a-126">(It does not create any language-specific subdirectories.)</span></span>

5. <span data-ttu-id="4f72a-127">`Save-Help` 建立本機 HelpInfo XML 檔案，複製 遠端 HelpInfo XML 檔案。</span><span class="sxs-lookup"><span data-stu-id="4f72a-127">`Save-Help` creates a local HelpInfo XML file by copying the remote HelpInfo XML file.</span></span> <span data-ttu-id="4f72a-128">它會編輯本機 HelpInfo XML 檔案，使其包含它所儲存的 CAB 檔案的元素。</span><span class="sxs-lookup"><span data-stu-id="4f72a-128">It edits the local HelpInfo XML file so that it includes elements only for the CAB file that it saved.</span></span> <span data-ttu-id="4f72a-129">然後它會將儲存在本機的 HelpInfo XML 檔案**DestinationPath**目錄，並於結尾的更新。</span><span class="sxs-lookup"><span data-stu-id="4f72a-129">Then it saves the local HelpInfo XML file in the  **DestinationPath** directory and concludes the update.</span></span>

   <span data-ttu-id="4f72a-130">`Update-Help` Cmdlet 會執行下列動作以回應更新說明檔中所指定的檔案共用的檔案從使用者的電腦上的命令**SourcePath**參數。</span><span class="sxs-lookup"><span data-stu-id="4f72a-130">The `Update-Help` cmdlet performs the following actions in response to a command to update the help files on a user's computer from the files in a file share that is specified by the **SourcePath** parameter.</span></span>

1. <span data-ttu-id="4f72a-131">`Update-Help` 取得遠端 HelpInfo XML 檔案從**SourcePath**目錄。</span><span class="sxs-lookup"><span data-stu-id="4f72a-131">`Update-Help` gets the remote HelpInfo XML file from the **SourcePath** directory.</span></span> <span data-ttu-id="4f72a-132">然後它會尋找本機 HelpInfo XML 檔案，在模組目錄中使用者的電腦上。</span><span class="sxs-lookup"><span data-stu-id="4f72a-132">Then it looks for a local HelpInfo XML file in the module directory on the user's computer.</span></span>

2. <span data-ttu-id="4f72a-133">`Update-Help` 比較指定模組的遠端和本機 HelpInfo XML 檔案中的 UI 文化特性的說明檔案的版本號碼。</span><span class="sxs-lookup"><span data-stu-id="4f72a-133">`Update-Help` compares the version number of the help files for the specified UI culture in the remote and local HelpInfo XML files for the module.</span></span> <span data-ttu-id="4f72a-134">如果對遠端檔案的版本號碼大於版本號碼，在本機檔案，或如果有任何本機 HelpInfo XML 檔案，`Update-Help`準備要安裝新的說明檔。</span><span class="sxs-lookup"><span data-stu-id="4f72a-134">If the version number on the remote file is greater than version number on the local file, or if the there is no local HelpInfo XML file, `Update-Help` prepares to install new help files.</span></span>

3. <span data-ttu-id="4f72a-135">`Update-Help` 選取 從模組的 CAB 檔案**SourcePath**目錄。</span><span class="sxs-lookup"><span data-stu-id="4f72a-135">`Update-Help` selects the CAB file for the module from **SourcePath** directory.</span></span> <span data-ttu-id="4f72a-136">它會使用模組名稱、 GUID、 模組和 UI 文化特性，來識別封包檔。</span><span class="sxs-lookup"><span data-stu-id="4f72a-136">It uses the module name, module GUID, and UI culture to identify the CAB file.</span></span>

4. <span data-ttu-id="4f72a-137">`Update-Help` 解壓縮 CAB 檔案、 驗證的說明內容檔案，並說明內容會將檔案儲存在模組目錄的特定語言子目錄中使用者的電腦上。</span><span class="sxs-lookup"><span data-stu-id="4f72a-137">`Update-Help` unpacks the CAB file, validates the help content files, and saves the help content files in the language-specific subdirectory of the module directory on the user's computer.</span></span>

5. <span data-ttu-id="4f72a-138">`Update-Help` 建立本機 HelpInfo XML 檔案，複製 遠端 HelpInfo XML 檔案。</span><span class="sxs-lookup"><span data-stu-id="4f72a-138">`Update-Help` creates a local HelpInfo XML file by copying the remote HelpInfo XML file.</span></span> <span data-ttu-id="4f72a-139">它會編輯本機 HelpInfo XML 檔案，使其包含所安裝的 CAB 檔案的元素。</span><span class="sxs-lookup"><span data-stu-id="4f72a-139">It edits the local HelpInfo XML file so that it includes elements only for the CAB file that it installed.</span></span> <span data-ttu-id="4f72a-140">然後它會將本機 HelpInfo XML 檔案儲存在模組目錄，並結束更新。</span><span class="sxs-lookup"><span data-stu-id="4f72a-140">Then it saves the local HelpInfo XML file in the module directory and concludes the update.</span></span>