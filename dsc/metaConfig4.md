---
ms.date: 2017-06-12
author: eslesar
ms.topic: conceptual
keywords: "dsc,powershell,設定,安裝"
title: "Windows PowerShell 4.0 預期狀態設定本機設定管理員 (LCM)"
ms.openlocfilehash: 2e6e4731bdf6d7de6d13fc7f9b81698a192247e4
ms.sourcegitcommit: 75f70c7df01eea5e7a2c16f9a3ab1dd437a1f8fd
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/12/2017
---
# <a name="windows-powershell-40-desired-state-configuration-local-configuration-manager-lcm"></a><span data-ttu-id="bb88a-103">Windows PowerShell 4.0 預期狀態設定本機設定管理員 (LCM)</span><span class="sxs-lookup"><span data-stu-id="bb88a-103">Windows PowerShell 4.0 Desired State Configuration Local Configuration Manager (LCM)</span></span>

><span data-ttu-id="bb88a-104">適用於：Windows PowerShell 4.0、Windows PowerShell 5.0</span><span class="sxs-lookup"><span data-stu-id="bb88a-104">Applies To: Windows PowerShell 4.0, Windows PowerShell 5.0</span></span>

<span data-ttu-id="bb88a-105">本機設定管理員是 Windows PowerShell 預期狀態設定 (DSC) 引擎，</span><span class="sxs-lookup"><span data-stu-id="bb88a-105">Local Configuration Manager is the Windows PowerShell Desired State Configuration (DSC) engine.</span></span> <span data-ttu-id="bb88a-106">會在所有目標節點上執行，負責呼叫包含在 DSC 設定指令碼中的設定資源。</span><span class="sxs-lookup"><span data-stu-id="bb88a-106">It runs on all target nodes, and it is responsible for calling the configuration resources that are included in a DSC configuration script.</span></span> <span data-ttu-id="bb88a-107">本主題列出本機設定管理員屬性，並說明如何修改目標節點上的本機設定管理員設定。</span><span class="sxs-lookup"><span data-stu-id="bb88a-107">This topic lists the properties of Local Configuration Manager and describes how you can modify the Local Configuration Manager settings on a target node.</span></span>

## <a name="local-configuration-manager-properties"></a><span data-ttu-id="bb88a-108">本機設定管理員屬性</span><span class="sxs-lookup"><span data-stu-id="bb88a-108">Local Configuration Manager properties</span></span>
<span data-ttu-id="bb88a-109">以下列出您可以設定或擷取的本機設定管理員屬性。</span><span class="sxs-lookup"><span data-stu-id="bb88a-109">The following lists the Local Configuration Manager properties that you can set or retrieve.</span></span>
 
* <span data-ttu-id="bb88a-110">**AllowModuleOverwrite**：控制是否允許從設定伺服器下載新設定，以覆寫目標節點上舊的設定。</span><span class="sxs-lookup"><span data-stu-id="bb88a-110">**AllowModuleOverwrite**: Controls whether new configurations downloaded from the configuration server are allowed to overwrite the old ones on the target node.</span></span> <span data-ttu-id="bb88a-111">可能的值為 True 和 False。</span><span class="sxs-lookup"><span data-stu-id="bb88a-111">Possible values are True and False.</span></span>
* <span data-ttu-id="bb88a-112">**CertificateID**：憑證指紋，用來保護在設定中傳遞的認證。</span><span class="sxs-lookup"><span data-stu-id="bb88a-112">**CertificateID**: The thumbprint of a certificate used to secure credentials passed in a configuration.</span></span> <span data-ttu-id="bb88a-113">如需詳細資訊，請參閱 [Want to secure credentials in Windows PowerShell Desired State Configuration (需要保護 Windows PowerShell 預期狀態設定的憑證嗎？)](http://blogs.msdn.com/b/powershell/archive/2014/01/31/want-to-secure-credentials-in-windows-powershell-desired-state-configuration.aspx)。</span><span class="sxs-lookup"><span data-stu-id="bb88a-113">For more information see [Want to secure credentials in Windows PowerShell Desired State Configuration?](http://blogs.msdn.com/b/powershell/archive/2014/01/31/want-to-secure-credentials-in-windows-powershell-desired-state-configuration.aspx).</span></span>
* <span data-ttu-id="bb88a-114">**ConfigurationID**：指出用來從設定為「提取」伺服器取得特定設定檔的 GUID。</span><span class="sxs-lookup"><span data-stu-id="bb88a-114">**ConfigurationID**: Indicates a GUID which is used to get a particular configuration file from a server set up as a “pull” server.</span></span> <span data-ttu-id="bb88a-115">此 GUID 可確保存取正確的設定檔。</span><span class="sxs-lookup"><span data-stu-id="bb88a-115">The GUID ensures that the correct configuration file is accessed.</span></span>
* <span data-ttu-id="bb88a-116">**ConfigurationMode**：指定本機設定管理員實際上如何將設定套用至目標節點。</span><span class="sxs-lookup"><span data-stu-id="bb88a-116">**ConfigurationMode**: Specifies how the Local Configuration Manager actually applies the configuration to the target nodes.</span></span> <span data-ttu-id="bb88a-117">它可以接受下列值：</span><span class="sxs-lookup"><span data-stu-id="bb88a-117">It can take the following values:</span></span>
    - <span data-ttu-id="bb88a-118">**ApplyOnly**：若設定此選項，藉由直接將新設定傳送到目標節點 (“push”)，或如果已設定「提取」伺服器，而且當 DSC 檢查「提取」伺服器時探索到新的設定時，DSC 會套用此設定，除非偵測的新設定，否則不執行進一步動作。</span><span class="sxs-lookup"><span data-stu-id="bb88a-118">**ApplyOnly**: With this option, DSC applies the configuration and does nothing further unless a new configuration is detected, either by you sending a new configuration directly to the target node (“push”) or if you have configured a “pull” server and DSC discovers a new configuration when it checks with the “pull” server.</span></span> <span data-ttu-id="bb88a-119">如果目標節點的設定偏離，就不採取任何動作。</span><span class="sxs-lookup"><span data-stu-id="bb88a-119">If the target node’s configuration drifts, no action is taken.</span></span>
    - <span data-ttu-id="bb88a-120">**ApplyAndMonitor**：若設定此選項 (此為預設值)，藉由直接將新設定傳送到目標節點，或在「提取」伺服器探索，DSC 會套用任何新的設定。</span><span class="sxs-lookup"><span data-stu-id="bb88a-120">**ApplyAndMonitor**: With this option (which is the default), DSC applies any new configurations, whether sent by you directly to the target node or discovered on a “pull” server.</span></span> <span data-ttu-id="bb88a-121">之後，如果目標節點的設定偏離設定檔，DSC 就會報告記錄檔中的差異。</span><span class="sxs-lookup"><span data-stu-id="bb88a-121">Thereafter, if the configuration of the target node drifts from the configuration file, DSC reports the discrepancy in logs.</span></span> <span data-ttu-id="bb88a-122">如需 DSC 記錄的資訊，請參閱 [Using Event Logs to Diagnose Errors in Desired State Configuration (在預期狀態設定中使用事件記錄檔診斷錯誤)](http://blogs.msdn.com/b/powershell/archive/2014/01/03/using-event-logs-to-diagnose-errors-in-desired-state-configuration.aspx)。</span><span class="sxs-lookup"><span data-stu-id="bb88a-122">For more about DSC logging, see [Using Event Logs to Diagnose Errors in Desired State Configuration](http://blogs.msdn.com/b/powershell/archive/2014/01/03/using-event-logs-to-diagnose-errors-in-desired-state-configuration.aspx).</span></span>
    - <span data-ttu-id="bb88a-123">**ApplyAndAutoCorrect**：若設定此選項，藉由直接將新設定傳送到目標節點，或在「提取」伺服器探索，DSC 會套用任何新的設定。</span><span class="sxs-lookup"><span data-stu-id="bb88a-123">**ApplyAndAutoCorrect**: With this option, DSC applies any new configurations, whether sent by you directly to the target node or discovered on a “pull” server.</span></span> <span data-ttu-id="bb88a-124">之後，如果目標節點的設定偏離設定檔，DSC 就會報告記錄檔中的差異，然後嘗試調整目標節點設定，以符合設定檔。</span><span class="sxs-lookup"><span data-stu-id="bb88a-124">Thereafter, if the configuration of the target node drifts from the configuration file, DSC reports the discrepancy in logs, and then attempts to adjust the target node configuration to bring in compliance with the configuration file.</span></span>
* <span data-ttu-id="bb88a-125">**ConfigurationModeFrequencyMins**代表 DSC 的背景應用程式嘗試實作目標節點上目前設定的頻率 (以分鐘為單位)。</span><span class="sxs-lookup"><span data-stu-id="bb88a-125">**ConfigurationModeFrequencyMins**: Represents the frequency (in minutes) at which the background application of DSC attempts to implement the current configuration on the target node.</span></span> <span data-ttu-id="bb88a-126">預設值為 15。</span><span class="sxs-lookup"><span data-stu-id="bb88a-126">The default value is 15.</span></span> <span data-ttu-id="bb88a-127">這個值可以搭配 RefreshMode 設定。</span><span class="sxs-lookup"><span data-stu-id="bb88a-127">This value can be set in conjunction with RefreshMode.</span></span> <span data-ttu-id="bb88a-128">當 RefreshMode 設定為 PULL 時，目標節點會連絡設定伺服器，頻率為 RefreshFrequencyMins 所設定的間隔，並下載目前的設定。</span><span class="sxs-lookup"><span data-stu-id="bb88a-128">When RefreshMode is set to PULL, the target node contacts the configuration server at an interval set by RefreshFrequencyMins and downloads the current configuration.</span></span> <span data-ttu-id="bb88a-129">不論 RefreshMode 值為何，在 ConfigurationModeFrequencyMins 所設定的間隔中，一致性引擎會套用已下載至目標節點的最新設定。</span><span class="sxs-lookup"><span data-stu-id="bb88a-129">Regardless of the RefreshMode value, at the interval set by ConfigurationModeFrequencyMins, the consistency engine applies the latest configuration that was downloaded to the target node.</span></span> <span data-ttu-id="bb88a-130">RefreshFrequencyMins 應為 ConfigurationModeFrequencyMins 的整數倍數。</span><span class="sxs-lookup"><span data-stu-id="bb88a-130">RefreshFrequencyMins should be set to an integer multiple of ConfigurationModeFrequencyMins.</span></span>
* <span data-ttu-id="bb88a-131">**Credential**：表示存取遠端資源所需的認證 (如同 Get-Credential)，例如連絡設定伺服器。</span><span class="sxs-lookup"><span data-stu-id="bb88a-131">**Credential**: Indicates credentials (as with Get-Credential) required to access remote resources, such as to contact the configuration server.</span></span>
* <span data-ttu-id="bb88a-132">**DownloadManagerCustomData**：代表陣列，其中包含下載管理員特有的自訂資料。</span><span class="sxs-lookup"><span data-stu-id="bb88a-132">**DownloadManagerCustomData**: Represents an array that contains custom data specific to the download manager.</span></span>
* <span data-ttu-id="bb88a-133">**DownloadManagerName**：指出設定和模組下載管理員的名稱。</span><span class="sxs-lookup"><span data-stu-id="bb88a-133">**DownloadManagerName**: Indicates the name of the configuration and module download manager.</span></span>
* <span data-ttu-id="bb88a-134">**RebootNodeIfNeeded**：目標節點上的某些設定變更可能需要重新啟動才能套用變更。</span><span class="sxs-lookup"><span data-stu-id="bb88a-134">**RebootNodeIfNeeded**: Certain configuration changes on a target node might require it to be restarted for the changes to be applied.</span></span> <span data-ttu-id="bb88a-135">如果該值為 **True**，這個屬性將會在設定已完全套用時立即重新啟動節點，而無進一步警告。</span><span class="sxs-lookup"><span data-stu-id="bb88a-135">With the value **True**, this property will restart the node as soon as the configuration has been completely applies, without further warning.</span></span> <span data-ttu-id="bb88a-136">如果為 **False** (預設值)，將會完成設定，但節點必須手動重新啟動，變更才會生效。</span><span class="sxs-lookup"><span data-stu-id="bb88a-136">If **False** (the default value), the configuration will be completed, but the node must be restarted manually for the changes to take effect.</span></span>
* <span data-ttu-id="bb88a-137">**RefreshFrequencyMins**：當您設定「提取」伺服器時使用。</span><span class="sxs-lookup"><span data-stu-id="bb88a-137">**RefreshFrequencyMins**: Used when you have set up a “pull” server.</span></span> <span data-ttu-id="bb88a-138">代表的本機設定管理員連絡「提取」伺服器來下載目前設定的頻率 (以分鐘為單位)。</span><span class="sxs-lookup"><span data-stu-id="bb88a-138">Represents the frequency (in minutes) at which the Local Configuration Manager contacts a “pull” server to download the current configuration.</span></span> <span data-ttu-id="bb88a-139">這個值可以搭配 ConfigurationModeFrequencyMins 設定。</span><span class="sxs-lookup"><span data-stu-id="bb88a-139">This value can be set in conjunction with ConfigurationModeFrequencyMins.</span></span> <span data-ttu-id="bb88a-140">當 RefreshMode 設定為 PULL 時，目標節點會連絡「提取」伺服器，頻率為 RefreshFrequencyMins 所設定的間隔，並下載目前的設定。</span><span class="sxs-lookup"><span data-stu-id="bb88a-140">When RefreshMode is set to PULL, the target node contacts the “pull” server at an interval set by RefreshFrequencyMins and downloads the current configuration.</span></span> <span data-ttu-id="bb88a-141">在 ConfigurationModeFrequencyMins 所設定的間隔中，一致性引擎接著會套用已下載至目標節點的最新設定。</span><span class="sxs-lookup"><span data-stu-id="bb88a-141">At the interval set by ConfigurationModeFrequencyMins, the consistency engine then applies the latest configuration that was downloaded to the target node.</span></span> <span data-ttu-id="bb88a-142">如果 RefreshFrequencyMins 未設定為 ConfigurationModeFrequencyMins 的整數倍數，則系統會無條件進位。</span><span class="sxs-lookup"><span data-stu-id="bb88a-142">If RefreshFrequencyMins is not set to an integer multiple of ConfigurationModeFrequencyMins, the system will round it up.</span></span> <span data-ttu-id="bb88a-143">預設值為 30。</span><span class="sxs-lookup"><span data-stu-id="bb88a-143">The default value is 30.</span></span>
* <span data-ttu-id="bb88a-144">**RefreshMode**：可能的值為 **Push** (預設值) 和 **Pull**。</span><span class="sxs-lookup"><span data-stu-id="bb88a-144">**RefreshMode**: Possible values are **Push** (the default) and **Pull**.</span></span> <span data-ttu-id="bb88a-145">在 “push” 設定中，您必須使用任何用戶端電腦，在每個目標節點上放置設定檔。</span><span class="sxs-lookup"><span data-stu-id="bb88a-145">In the “push” configuration, you must place a configuration file on each target node, using any client computer.</span></span> <span data-ttu-id="bb88a-146">在 “pull” 模式中，您必須設定 「提取」伺服器，供本機設定管理員來連絡及存取設定檔。</span><span class="sxs-lookup"><span data-stu-id="bb88a-146">In the “pull” mode, you must set up a “pull” server for Local Configuration Manager to contact and access the configuration files.</span></span>

### <a name="example-of-updating-local-configuration-manager-settings"></a><span data-ttu-id="bb88a-147">更新本機設定管理員設定的範例</span><span class="sxs-lookup"><span data-stu-id="bb88a-147">Example of updating Local Configuration Manager settings</span></span>

<span data-ttu-id="bb88a-148">您可以更新目標節點的本機設定管理員設定，方法是在設定指令碼中節點區塊內加入 **LocalConfigurationManager** 區塊，如下列範例所示。</span><span class="sxs-lookup"><span data-stu-id="bb88a-148">You can update the Local Configuration Manager settings of a target node by including a **LocalConfigurationManager** block inside the node block in a configuration script, as shown in the following example.</span></span>

```powershell
Configuration ExampleConfig
{
    Node “Server001”
    {
        LocalConfigurationManager
        {
            ConfigurationID = "646e48cb-3082-4a12-9fd9-f71b9a562d4e"
            ConfigurationModeFrequencyMins = 45
            ConfigurationMode = "ApplyAndAutocorrect"
            RefreshMode = "Pull"
            RefreshFrequencyMins = 90
            DownloadManagerName = "WebDownloadManager"
            DownloadManagerCustomData = (@{ServerUrl="https://$PullServer/psdscpullserver.svc"})
            CertificateID = "71AA68562316FE3F73536F1096B85D66289ED60E"
            Credential = $cred
            RebootNodeIfNeeded = $true
            AllowModuleOverwrite = $false
        }
# One or more resource blocks can be added here
    }
}

# The following line invokes the configuration and creates a file called Server001.meta.mof at the specified path
ExampleConfig -OutputPath "c:\users\public\dsc"  
```

<span data-ttu-id="bb88a-149">執行上述範例中的指令碼會產生 MOF 檔案，該檔案指定並儲存所需的設定。</span><span class="sxs-lookup"><span data-stu-id="bb88a-149">Running the script in the previous example generates a MOF file that specifies and stores the desired settings.</span></span> <span data-ttu-id="bb88a-150">若要套用設定，您可以使用 **Set-DscLocalConfigurationManager** Cmdlet，如下列範例所示。</span><span class="sxs-lookup"><span data-stu-id="bb88a-150">To apply the settings, you can use the **Set-DscLocalConfigurationManager** cmdlet, as shown in the following example.</span></span>

```powershell
Set-DscLocalConfigurationManager -Path "c:\users\public\dsc"
```

> <span data-ttu-id="bb88a-151">**注意**：針對 **Path** 參數，當您叫用前一個範例中的設定時，您指定的路徑必須與您為 **OutputPath** 參數所指定的路徑相同。</span><span class="sxs-lookup"><span data-stu-id="bb88a-151">**Note**: For the **Path** parameter, you must specify the same path that you specified for the **OutputPath** parameter when you invoked the configuration in the previous example.</span></span>

<span data-ttu-id="bb88a-152">若要查看目前本機設定管理員設定，您可以使用 **Get-DscLocalConfigurationManager** Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="bb88a-152">To see the current Local Configuration Manager settings, you can use the **Get-DscLocalConfigurationManager** cmdlet.</span></span> <span data-ttu-id="bb88a-153">如果您叫用的這個 Cmdlet 不含任何參數，依預設會取得您用來執行此 Cmdlet 之節點的本機設定管理員設定。</span><span class="sxs-lookup"><span data-stu-id="bb88a-153">If you invoke this cmdlet with no parameters, by default it will get the Local Configuration Manager settings for the node on which you run it.</span></span> <span data-ttu-id="bb88a-154">若要指定另一個節點，請使用這項 Cmdlet 的 **CimSession** 參數。</span><span class="sxs-lookup"><span data-stu-id="bb88a-154">To specify another node, use the **CimSession** parameter with this cmdlet.</span></span>

